{"docstore/metadata":{"40ed0b67-25fe-4163-ab0c-05b41290e466":{"docHash":"gQY0SecKhqgvDXY87Tk67Ir4KuaAuT8aZ8IbelNnCyY="},"48c11a2a-3cd6-4024-b2a4-253c85154968":{"docHash":"bl7SXErAHIz5+G2VSXZ96rf8en0FHJs5BIk5opA2W9Q="},"4a091ebe-148b-498e-985f-24d2e6d73bc0":{"docHash":"jp7xeijZzPfXoGzJVpVBurtMuHXToTbfq8wytgJG7O4="},"4d4e3213-6009-4095-9499-73a7f6facb89":{"docHash":"y5tg+dG6667MeRXLOQYj2H3orlev7xSuBo0Gh8oE7Wg="},"3ad4a0a9-3855-43ee-af96-f79391cde4fd":{"docHash":"fSqOVNEUlUdQvxRxR5yeNUOVbqCn352yColonOCUTx8="},"80eb6b53-ab37-429f-9d85-1d8aacc97c93":{"docHash":"D5iV49e7y5u0qiKSfL4M+uW2Zcmcu7Y5niz27Zs5su8="},"fce81d81-f077-4305-a010-1ef0a84d98d7":{"docHash":"NhAW7oUwEfEkSpOhsYO38LOqTZ6AKFfWR61mI99qB64="},"45457b95-6135-4f8e-8ba9-e617f4125488":{"docHash":"8oHPgeFasWGMe/DNdqVS38ySvhYK4P4Gf9rh7GB29RY="},"8220089e-1607-443c-b6b0-269527161c38":{"docHash":"xkiIwA1pY/YXEl5gjmaL380uv0LjKFgSPfYH2cb45Xo="},"58163131-12e6-44ea-bc97-e67a6315c8b2":{"docHash":"2QoPvMe2JoZQYlb9vuex6e5ihlC8uajQjHF0N3OPZp0="},"8c95bfcb-1805-4a7b-96dc-a4cb018444af":{"docHash":"xfIEbeJnOmBZecGQRrH7/imINrHHbENpADrPyY5iWjk="},"eaaba3a1-137a-4b33-a1ed-1c41e982caaa":{"docHash":"lGl839RNqskX6bbxzMlMj29jnJv2S2MKDj6rJYcYxJ4="},"f9ef9a39-81ab-4227-9cc4-1c6c3020bfa8":{"docHash":"C25d0gEE0NC05NqqJJWCO/LM58ZAs7XqkObewv9w5g4="},"00546dc8-1249-499f-b566-89d8623c2656":{"docHash":"tX9M2Lqs2rGbs9KuMi4uf8ztr9weJak1LFWKlR3VujU="},"78b834e4-5028-442d-ad2d-cf943ea5b03e":{"docHash":"LMcsNALcznjFBtEv7Cgh8KXENlUfxn3DVK1Aq3ysmW0="},"fc6da928-c2ee-4804-877e-7d2318aabe6e":{"docHash":"xlstDpb6SC8G+AgTmbCMN1fojir0C36K1V+Fo/FmPhE="},"88878f1c-c20d-45ad-9616-fd477154020d":{"docHash":"A4mXRfT05bFYDjstR1t/TRpIP/b8BYsSiHFU6c/iecc="},"11517fea-0ea1-488a-930c-07cb26d2d9f3":{"docHash":"G965XY/zyZD9yS9BkggiYlqFseknWQWG+LlKkmHhnWs="},"6456cac7-d020-4530-8668-55199c1f3302":{"docHash":"AdWb7hI9ATZRUAaYeTihaDh+pIPcX07dorCuJjXwJ7o="},"9150c11d-0d60-4b76-8984-34a4cc87c677":{"docHash":"7OZgTtfYP8i/7f8O7kzrNJ6HC71rCjmLILal67rxPkw="},"a0c3661f-9ce5-4b9f-a512-2b961bd865eb":{"docHash":"WLsyv6eY1c5WzQ338A/Cz6bonzeAmdj8ULj3eCZ+YdI="},"ce912796-13ae-44a4-94de-699e3bea3feb":{"docHash":"Wt2aUfNM1uFCLtPxdwGT8T2Sd9IDXs7k2t/EDoLlUqQ="},"172ff61a-d812-4186-9d3b-9dab07312847":{"docHash":"+H4bQsE30zXuenFj38TC5tFnDH+pwYfanMH2jvHLmIM="},"a1e58057-2f9d-4916-8ae1-a290d7d73ca1":{"docHash":"yFzOZjQUXIyF+1s3hLtQrNN8zdM/9K0POrSePyZoyoA="},"609657b3-39a5-460c-909b-82477537a95a":{"docHash":"ihAH/5P2m1OP7+M7gJY4PAaV9SzDyPjzKVtd9r9fo0Q="},"3acb696b-79bb-46ea-b79a-9da78911a0a7":{"docHash":"l+zojr7b2bbNXBxO2VJpkl/hK4M7Ilq8d/flCtAgusY="},"d74ca71f-f0ac-41b2-850b-20766e5c7e73":{"docHash":"gqL1pHsXgztO2L4FOmFb5VY7kvu3VPNjInfP7cCWuu4="},"65241135-4f0e-4548-8196-eba27c46a6b2":{"docHash":"fevngajSZM/DWD6kzLu/i8jPXr3ZYbdUNEDNhjFMfJk="},"bedb7d68-e124-4d58-ba20-4ecb33ae802e":{"docHash":"wWRFpkGzzwMikbAuT0Pkrht06ixqre8cklW0t2989cQ="},"6b581184-1c16-406c-8fab-e57806bae0de":{"docHash":"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc="},"a379b718-8880-4830-ac71-199281fa17fb":{"docHash":"i9XX3zNVnM4m/Oq+0xBvg+ATC+DjmoUwSooEipBOrpc="},"ce132559-9550-4216-b03f-07591d2eb311":{"docHash":"+YPuwIve5ulu3P8/zwh+r2WBME1jHDz6Dup99tQ1Uxk="},"1ac47aff-ad6b-4a9d-810d-12eebcb92784":{"docHash":"0hd4ZXlA175S2Ujsp2tpzg5jr5ePTIRHIQYq3T8fNcU="},"493e33a8-94ac-44fc-b6ed-1b318fdb1149":{"docHash":"O3zH126dJePIuzrLQ7imVis06fpDfhCSCfTCymQCg60="},"761f67a7-f823-43fa-8c21-394b29c3adaf":{"docHash":"uKkTeugMt70GMTQcNuPQA483rowiQ5Y/TzvAgUgxSw8="},"32d8be53-cb3a-4577-8d06-962088eabaec":{"docHash":"KY96tJ2UXrAGbRUny4VdMYifZorgV/i7g4ubJh/Mu88="},"854dee56-8823-4290-9045-07c606d50d60":{"docHash":"CvSlirgj4Eyf9nbfd6bjQbxMCiNr9+5zFphPfkDyEuo="},"b9c588f3-4f07-4603-aad2-b90963ffd8f9":{"docHash":"CWLW9YkKD2pIPbI3smXuqsr5kd+zJrCU9Fitj3D5P2w="},"1c8353c4-295a-47bf-ad1b-edec66ae48e3":{"docHash":"Fn3FexxH+1f3Av26pgHdUs/qd+WyUlRyx+R0v6D5CvQ="},"af4b9470-0392-4d93-8b8d-3b7cc96f4a1a":{"docHash":"8w5f8nz3Z6t9TksgqLps+AjjyvCFozhSXJ1PPW5EhEI="},"cbd8f608-891e-4328-8965-55ab0ce50082":{"docHash":"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc="},"0a1ce044-7590-45d8-95d9-aa2229ef4348":{"docHash":"wkTwiW8XRxkFsuyHTuc8fZf44DcxebEDhRHnmkK23Yg="},"a5d127c1-a9ed-4030-9c9a-42639f5473e2":{"docHash":"glTf5IBDhM9AOcTIuErndV4Lkvc9CF/QidwoDcyo6CY="},"30aafcee-e279-4452-8e95-a194a034f230":{"docHash":"5OcbZoouJ0Zl4HJzpnGO5MtiMxfE2TzxXcdADWL4yZA="},"80aa3952-d000-4091-b8f9-a75b716c9313":{"docHash":"HdHtPd4921rNLiQEM8KOeJM60gqUEDaYQNijtj6DAb8="},"aae33b37-e476-4ad4-accf-6093dc28f5a8":{"docHash":"Sp3JfCcIxkYNd6ISvkmt3PFJLt4IB3lM2Qm7upM9XNI="},"825f45c1-0a73-43a7-bc29-be2c02c265ff":{"docHash":"ennoaHvBRcXj+3t5gFDyvycVaYNusw9+Kz5EKvjrYS8="},"9dbf95de-1c54-4eaa-92a3-09a295a26eef":{"docHash":"zxlH7FNPZRTHtIYNsNxUUuIQj/+0TvCr42ICcYQcOlg="},"d53c6fc9-e958-4173-88f5-81034b658154":{"docHash":"Ntwm8d7KSGKBxeGDY2dAV8H4qATp3jXozLQV7WGV9iA="},"abfe51f8-0ba7-491c-afb7-931e54311ce9":{"docHash":"5MjMdYVz44nAtdgw1Tc1js0J0kbpBHn2jJD+bWalnhQ="},"e734a186-9266-4ad4-95a4-fcf369aa7cd1":{"docHash":"SVQgqDhSrPBV0aflPwl8I2Apc3ebvLc6VcF8D9J0+Ck="},"67ac050e-3c1b-474a-ade2-3fd9b6d14beb":{"docHash":"hjCGf2fF6bkVPSXi2VPkDgE6TAXXAVv7TiuKqqpXwdY="},"9cdf290e-9390-4255-a0a4-c16b22b1544b":{"docHash":"FDFO8gljr72SNIzMXWRqqzXp4gqRgFYdCRj64t64iUw="},"68b21055-1e08-49cd-a3fe-d83908b8de55":{"docHash":"ZOcCV805mHI1K7PP9Gfki7XMIEv408xp/0Ec6qU3Dg8="},"ed0c81f8-7407-4511-9e8c-816f3aa141a1":{"docHash":"YLRhQFu7cR5tymCeP9+W4VuDdvuG4W35PZZSFr5ifC8="},"d694b5b3-b872-47f3-8d98-ae0af440a12e":{"docHash":"lipTw/MWblyS8uuaf5aXOa6TSia8Y5SzD37uJR7zCc0="},"ba4a2f7f-a52c-4add-923c-9ab1ad613223":{"docHash":"k8M92SPDPv43aOvD9dH1trNrNGhUGZejAXSOOX7aM0c="},"c782893e-78de-4a88-837b-55dff5d9bb5d":{"docHash":"0cAIcfJfnLZTTSNDSr9rGe/t+SkSisVGxetVrHZjXcA="},"79e4ce61-65d2-4972-84fc-dc3c7fc52098":{"docHash":"a3uNR4IxiJhsOBHDXYzYdYr5ulaLJQP3pIcuIGwCGaY="},"e9648ef8-bad2-4433-a267-81248878b5f0":{"docHash":"XXnV7nMDNteWVMSeZRJqToM1cl7KakbI12maQbNuhxE="},"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141":{"docHash":"YRHg+4pG8MUCNTPj1FTyGkMeq7DOSp7PflqqeIvNwEk="},"e7951e12-0ba0-45db-9bae-b1d24dd657d8":{"docHash":"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc="},"b0f10ec1-a0f9-446d-b37d-c23ca090023f":{"docHash":"39S3VKOiYQV2Ce5xG0hugLjpyRzC4QOlnp0mDsO3yqQ="},"d3314be8-9071-4d3d-9790-8056c9f6153b":{"docHash":"sO/8qAdT0jnimLC+eyO54kmMVPWv2iBO2gn1sn/2luY="},"c34b7369-b1a5-4522-b1e5-ec923a9a15d1":{"docHash":"v8u1JrZPomW+U/T6GrINBQXrYIUqZAx4Li85qzm4NwI="},"ff6b3cbe-3a9c-4b8f-ad55-6b602d7f5ca5":{"docHash":"0JlEl7Iq6ILZRSm+PgVvxrcWQy8K7aWm+ulSIDkVaRQ="},"056fbeae-0b50-4e2c-963b-f1113c2162b4":{"docHash":"iD1nkQXLNFBQLolGGkQI9pYqc96QvaU/PBD4/8CS17o="},"9c0127d3-de93-4837-9237-bcdd4df71912":{"docHash":"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U="},"58e19fb5-c662-45f8-82c3-b5b8a1080fca":{"docHash":"Fto7XNRIo+AK5GRcsAoeFw01upvN8x+liK9EEXMqDBs="},"237e2c81-d9e3-4d82-a415-a925a3130cd5":{"docHash":"zsbchlpNGei2faVOYxDwXHhn9D2kbgOopyoiim7EbaI="},"f75748c9-ed3a-415e-a2ea-c4776cafc6e1":{"docHash":"rmh7A50kQp5pV44/tH4u3/MCfP/lWbA1yX8rqZZ5UeQ="},"717d48c3-17dc-452e-92c4-ad9a4a5f4ca5":{"docHash":"PPy+fvkgiec53v8PJ3RF4L78BWifQlB/lNaK3K38A50="},"2bd3581e-f791-4d91-a713-f494cb2481b3":{"docHash":"D+GvrN1K9yn8kULoCQZm/Yz1DXCZRPl+gZMta4xiGbo="},"4508de05-dfb5-4242-8801-0b8069d8fb89":{"docHash":"zPfAPO3KwyRyamCait5QeXtFdoOIvEDaF8c0GKmsBbg="},"7dc135f1-4be1-447f-89d0-6c0ec9a6da79":{"docHash":"q8BsnVcRpESDw1PTz4Gqm4Su1me72Nn2oAdftkZVEHU="},"44f80043-3701-4f1e-90c6-48972ba77ab3":{"docHash":"SIPETwEvKCwNpBF8ie4X+ZXdiZHRQn3LdpkkJcbqS5c="},"afa821b1-1afe-4d78-b934-1a997d0c5f0d":{"docHash":"/yQsp2IeDl8DCyaFGpdBv6kkKuZw3zA7TIpravXqKJw="},"4a72806f-ba1b-4781-8061-63099840abac":{"docHash":"NiEIFTHt0nJHyg5YqiPnXKCQOfc4OJiiOHlW3xLJKBk="},"52a5268f-f97e-47f2-9dfe-e066e5e968de":{"docHash":"2pJNpt7jJ0fHrxdz0Y7kDoipcfwYBHmxGGmXDLIiSJU="},"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371":{"docHash":"G2H9k6YzEATFD8jw6B7koYgb8g1Y9izHmyH+LL54S8E="},"dcd87579-1e63-4eed-9010-7e505f44ec5d":{"docHash":"a3uNR4IxiJhsOBHDXYzYdYr5ulaLJQP3pIcuIGwCGaY="},"3b303dfd-82db-4de5-8baa-5144a18ae7b7":{"docHash":"ykEjL/G6W+qJ4K0vfrN0smC3WQCyzC4VHkI4ZWUIiYc="},"de01d306-f9af-40a1-b099-d58106c559a6":{"docHash":"qsRcpLsysnJNOrI2llhmFUYZXq+Jy93uDAis9Rfe04c="},"21ae3777-92ef-4f21-9baf-233040386b72":{"docHash":"m7yPN70ObblK9UDVcz0mqRRUHGd9V+RJ9BprXNBdYv0="},"ccdf9472-a393-49b2-b512-47b9e9150147":{"docHash":"T257+1SV09ZyfOdhgNNpi3g7NXs6jb48pPAPN5kSakU="},"642f306a-ef53-4442-8cc1-568b44d8fb5c":{"docHash":"GUIcpyrCI6lAdGFqz2cOJg4PuQbdC2tsVojxvOu34ag="},"524017f9-34f9-49f7-acd9-f3d12c662ab7":{"docHash":"IGVBvL3VFj/W6LN0VXOvxM2dCmLHCCXQxpxMrI9Xz6U="},"bb3d8e14-26c4-4a6e-bd39-5b33f2e48550":{"docHash":"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc="},"f03bce9e-eb76-4fb6-b489-6abc03f4e25f":{"docHash":"sc2C4EgVcppv+ZBHoqbyeHLF8yvq0Hr/KU864bMrZU4="},"bb8ac55f-7f0e-4b81-9902-49365a2cae2b":{"docHash":"aCeLLJFJTU8nMv2EVUo7COabFEoS3GKDqTBgGPiq3qo="},"704ef6a6-07b6-47a5-9eef-4d6858d809ec":{"docHash":"qpkea4hLM82V7wr+/jhfEzwHcpz7MQOcLDmjQ/+OKSI="},"0e40f47b-4360-479d-83a4-bedf0541ff93":{"docHash":"UU8P5P/hcDum1R7i77m2Qd+zJMr3GphBiCZnMXLOyuA="},"d52c5fcb-9a81-4883-9db2-45012509393f":{"docHash":"CJmRvdeW6jIoRVlr8RLGcmwqwHWCSgBRCgz2Jpo8Tm0="},"9190086e-6658-4701-a671-1c824a661f31":{"docHash":"20KySb9sxatKaNXkTRDFaaiD2JB5jYMGSgHc+C3Oo/o="},"21f28f95-f326-4f5d-92cc-a48f7bd0dfeb":{"docHash":"508T/dj87dbMfWDHZtCN0InJzqiaq8KF0TX98n+tUQU="},"5fa4039f-fd43-4ee3-a413-d53475b24a1f":{"docHash":"WmwzGFrhM9BKvFfQwQPU4k5zlMqVqv9f7RK4P6NvZ7c="},"be581b29-c110-4831-9b5c-42dd0f234543":{"docHash":"DOodO1OBb0A3hpABrYh1PnqEndAgElIC7ILgXpu93Ko="},"1e9286a9-7c2a-4055-bf4e-8e9ac541d688":{"docHash":"c18PQu2OSvlKIKIR2BwMCa75e1ycNaZHE+lqfECwTbo="},"10c7ed22-30f5-4bf8-b137-22d47f1bd522":{"docHash":"rv+MGRCoHEj09krakhc6Z1+E1mxg6rHkPZfnXejfVbg=","refDocId":"40ed0b67-25fe-4163-ab0c-05b41290e466"},"d2d7a1e7-0d9f-4626-b099-b9dfd88ffef0":{"docHash":"BkglTXOds6EWELBXPnEaLuUVZNUeak1bo9ZFn8PDcbY=","refDocId":"48c11a2a-3cd6-4024-b2a4-253c85154968"},"bb744f3b-86cc-4db3-81b4-94c056888110":{"docHash":"Mcc6mXTsISBXspkQhjwHAQV6nHH+eD0YcbCO2geizqo=","refDocId":"4a091ebe-148b-498e-985f-24d2e6d73bc0"},"527dae8f-f49e-4687-bcf2-008c2109e23b":{"docHash":"2Kl7h8PnlxbVjzRcdvvioojK8eaW8xaJojmRAo62OSE=","refDocId":"4d4e3213-6009-4095-9499-73a7f6facb89"},"26f5f0d2-d6fb-43f6-8161-77dfc0400603":{"docHash":"W+SSMRUnT/BBVe+U313VzWrQ4gujQEdwKqqgjYqkqh4=","refDocId":"3ad4a0a9-3855-43ee-af96-f79391cde4fd"},"85876020-5a7a-4912-9d1b-53fefa86ab1f":{"docHash":"UhuJsya2584b506nVzoCiXRI6AUyQ4w3Du1KiQLYGG0=","refDocId":"80eb6b53-ab37-429f-9d85-1d8aacc97c93"},"d25ab7d0-c88d-4add-bda9-089f883056bb":{"docHash":"mtOEOmPqVyncn7PEh/FZXCQgoAOQy/yLS0THkW6v7c0=","refDocId":"fce81d81-f077-4305-a010-1ef0a84d98d7"},"7fb5f9a8-c7f4-4e4d-8119-c5283dbabfec":{"docHash":"TgCLRoDTQcHyE659h3q1sILt4tpd9/O2QR2lHGujXWw=","refDocId":"45457b95-6135-4f8e-8ba9-e617f4125488"},"6a050ab1-9783-4fdb-b081-f3e2b28da60e":{"docHash":"CaRqVCYwprUy1Bi9pPNaMQLHI/gb4Jn2NCmNze+BcTo=","refDocId":"8220089e-1607-443c-b6b0-269527161c38"},"259ca24d-c199-4e97-b721-3d535ed41052":{"docHash":"5WeJ8Uv95NPAMgFN1Wb4e/9v76xJ+XQs6dJ76r5vQBQ=","refDocId":"58163131-12e6-44ea-bc97-e67a6315c8b2"},"848b085d-2053-4009-ba2f-bbf3fbfd68d1":{"docHash":"cf1i42Xiou0IApyX/BZ87XxGC0xQ3GhJ4odQRFBwnZM=","refDocId":"58163131-12e6-44ea-bc97-e67a6315c8b2"},"2c1b9875-321c-4bb5-b913-187ed16db6b5":{"docHash":"7Dy6FKlXltywTru18X2j4ZVnfXreVYg+PWoMVGL942k=","refDocId":"8c95bfcb-1805-4a7b-96dc-a4cb018444af"},"8891b0ec-5e68-4c97-86e6-f3725ac14f46":{"docHash":"Ws6pLCCn6+7AAgj3rnrOnnUKaM/rtsCNGu7gGxK7cQQ=","refDocId":"8c95bfcb-1805-4a7b-96dc-a4cb018444af"},"d911f7c4-f10e-4215-991d-462f50e069b6":{"docHash":"QV8Xti5pXVMtlzPEjKI8xh8CU2AJtYuWrpEacR70p1U=","refDocId":"eaaba3a1-137a-4b33-a1ed-1c41e982caaa"},"7b489c1d-f344-41ef-93f7-45d2b53d95c8":{"docHash":"epXWeXArz3swqkKZrPHBkOkkKewPibfCYU4JlVOKEJE=","refDocId":"f9ef9a39-81ab-4227-9cc4-1c6c3020bfa8"},"79a7dec8-106d-4638-ab18-d1e28015b5c2":{"docHash":"MkEDy83sPUIhkPm0MLlRQhjrZ7p7RfmXwxaUh9hJwGA=","refDocId":"00546dc8-1249-499f-b566-89d8623c2656"},"c6d0dbc2-4289-4102-a470-f4dc1a3cf62d":{"docHash":"3yUU1flcy3CJExxjtMh5Soy83gCTZexUJEQlyv/aFFk=","refDocId":"78b834e4-5028-442d-ad2d-cf943ea5b03e"},"a557883d-2dcc-4057-b718-70d251aed68e":{"docHash":"q9r//AJ56XAy0mIsJWyQpcKiuY46gGgHVn0tN+eLUgs=","refDocId":"fc6da928-c2ee-4804-877e-7d2318aabe6e"},"a404d862-2a81-4900-bef8-49e8b0119d9d":{"docHash":"x3eMmF8nNVin+h3Su1gI4ityGJpAdEE/dLqSttDi1AU=","refDocId":"fc6da928-c2ee-4804-877e-7d2318aabe6e"},"10c07d2f-89d2-4bf5-b56b-e8d22130aafc":{"docHash":"Wptt0QcU5JSJ4ulTnh3AZYkGfo7QaoPQklnAt82xZ8o=","refDocId":"88878f1c-c20d-45ad-9616-fd477154020d"},"b1d18526-be1f-4ec2-9bea-29eb1b9c3f1f":{"docHash":"cU9WSyYCixA+cc132o/XIvpOkstkKBFJA8byyfWNag0=","refDocId":"11517fea-0ea1-488a-930c-07cb26d2d9f3"},"b4a30af8-8668-40a6-9b86-6b3c8fc425a7":{"docHash":"E1VuP+t47Glpw8u3CqsPlXvVz1uvPhXHBqQuxMROS34=","refDocId":"11517fea-0ea1-488a-930c-07cb26d2d9f3"},"60a5fd28-aa6b-4402-81d2-a6edcd79ef82":{"docHash":"4yHjXAngTlXj++zu9ubBXBsXpszgwonq4hpOne81E1A=","refDocId":"11517fea-0ea1-488a-930c-07cb26d2d9f3"},"e6b2391a-61e4-4635-9d23-7f10f088efcf":{"docHash":"lp2ehRhubfEMHbTI1ujYH4GUYAi7BSLWYCYHrchk+yc=","refDocId":"6456cac7-d020-4530-8668-55199c1f3302"},"e516b64b-199c-48df-80f8-76cfb0171260":{"docHash":"gcW4sahUabgonWofUBcPyRjEvRicCsb2E0N3n99g0wk=","refDocId":"6456cac7-d020-4530-8668-55199c1f3302"},"76c2ed76-a445-40aa-a230-8128e0b8ff96":{"docHash":"cr0AdIic3V2V9XNB6WGOYdaUKMLPAW0q6T4ydC+ksZU=","refDocId":"9150c11d-0d60-4b76-8984-34a4cc87c677"},"66e5e9bc-0bad-40a4-8fc6-08288a308178":{"docHash":"WFE23Ugr3QO4Jh/V9OxNxRRxLiucC3s1nXSOTGaIU/U=","refDocId":"a0c3661f-9ce5-4b9f-a512-2b961bd865eb"},"9253dc89-38a7-493a-9461-10cb50a43451":{"docHash":"HiIlQBc0LXPklCFv5Y1T/O9Z05Ntru21FUB1opazXrM=","refDocId":"ce912796-13ae-44a4-94de-699e3bea3feb"},"297c9920-6931-47bd-aafa-bce3f494b7d3":{"docHash":"aCF0/ER1RhQGeFsPNzN8pxX/GgWu7Pdg6l2b7E3C4vQ=","refDocId":"ce912796-13ae-44a4-94de-699e3bea3feb"},"339b20d8-240c-4cd4-94e9-1e08b1f4d682":{"docHash":"57Nj5MIzUEvP+QX84grkBbWMTs3N0XV2QFTnmlw65MQ=","refDocId":"ce912796-13ae-44a4-94de-699e3bea3feb"},"9e3d0a52-d6d8-4e01-90ea-d9dc7e3b677e":{"docHash":"hhZRpu+TR+4CBdSkGEYzJdlf7hpKQTFr/0of3e3OT5w=","refDocId":"ce912796-13ae-44a4-94de-699e3bea3feb"},"6259768d-82b4-4965-aa7c-0b4f4419ed8f":{"docHash":"SESsDjofl56jKnAf0V+Nb2vCZaBTvZKnsFMFk1GpGrs=","refDocId":"172ff61a-d812-4186-9d3b-9dab07312847"},"86f8346d-a1e3-4abb-beb0-107082bad295":{"docHash":"19261UCes6rrV//qi9/GwMW8GdeERM7pV7VRRb7LzcI=","refDocId":"a1e58057-2f9d-4916-8ae1-a290d7d73ca1"},"5e60d95f-077f-45bf-8e5f-491db98529ee":{"docHash":"iGCdtWsdJJMYXxJKwG04XxYR9jZd/1z2ENc92QWmj3k=","refDocId":"609657b3-39a5-460c-909b-82477537a95a"},"6d73770a-507d-477c-a697-519a25302981":{"docHash":"pbQ9z7SS9xqZLMa5QtuYDpCuVxwqzeq8o4Kg4Xb+sBM=","refDocId":"3acb696b-79bb-46ea-b79a-9da78911a0a7"},"fa5f0894-8749-48c9-8720-f31b084ac597":{"docHash":"LsVvWUU6XBUTLLzUkT1X3HS7tN8aZAzFYbHdZLK28jE=","refDocId":"3acb696b-79bb-46ea-b79a-9da78911a0a7"},"d88fcd2e-4532-4bb7-a9d5-9e1da3f3f4a6":{"docHash":"VqbnADNJG4W4H8JrETgKw62GrjCgR6uC8eJxq0MHdv8=","refDocId":"d74ca71f-f0ac-41b2-850b-20766e5c7e73"},"8fe76eea-6b37-4b5f-84b2-cc06479ef076":{"docHash":"81NlhjZPRKoXTxIEZKzijQKFEu4bZ2nPngs9EDym43E=","refDocId":"65241135-4f0e-4548-8196-eba27c46a6b2"},"fb01430d-83f7-4cdc-9540-5ef54d8e64d5":{"docHash":"MRwTcxxlcvA7qzsiqdcVh2jJM544nZX3g8PClBDaZ7Q=","refDocId":"bedb7d68-e124-4d58-ba20-4ecb33ae802e"},"55592220-4c75-4c08-98a9-4dae1d327ce9":{"docHash":"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=","refDocId":"6b581184-1c16-406c-8fab-e57806bae0de"},"0d28db77-596c-4f87-a5d3-d37b03e9151b":{"docHash":"yGssy9Li9JUoBbST/tOaUNLlJ2bq22x7dUZo2V5/Pqc=","refDocId":"a379b718-8880-4830-ac71-199281fa17fb"},"c5f9aefb-71c2-40a4-858c-6569f523ad35":{"docHash":"daExK2tNswZrIPAlTdv9Iq9sTSS+Cs0X5bAgBAr/SxQ=","refDocId":"ce132559-9550-4216-b03f-07591d2eb311"},"1763de92-30a2-4167-8c6a-54404f1eaedc":{"docHash":"8eBF2O/6sD8iwbhW/aepUHo5fMZ3Vj52CKp9asygRaQ=","refDocId":"1ac47aff-ad6b-4a9d-810d-12eebcb92784"},"978fe010-876e-4615-9610-aad5d7e8b9cb":{"docHash":"u7sXxaR2E9fLneeZ4N5hTSKHyHPOVt1GwapRGUpB/aY=","refDocId":"493e33a8-94ac-44fc-b6ed-1b318fdb1149"},"6f16c335-6eb6-42f5-bac1-bdf7dd0eda00":{"docHash":"Wjpq2m1x774ErU2vZvxt/Lk/CfD2I/p6nWt2HcfSv28=","refDocId":"761f67a7-f823-43fa-8c21-394b29c3adaf"},"d40f9e41-973c-4641-89cc-e2125d2c4193":{"docHash":"h2W4l5DB1Eq4bmG62i93Hf3bka4sKkuHSEGKxzHvj88=","refDocId":"761f67a7-f823-43fa-8c21-394b29c3adaf"},"af18cf1b-643e-4692-a77b-07fee22cad09":{"docHash":"LoixsIIXfw/mdwoLIH7vW4/prRID/jLw8LUOAMYTH2U=","refDocId":"32d8be53-cb3a-4577-8d06-962088eabaec"},"1489c0f2-358b-485f-ad71-e3909af6231b":{"docHash":"Cfaz1taiHhRN1DznNzZvVw7RVcaviXZqlTfrwhTaxFs=","refDocId":"854dee56-8823-4290-9045-07c606d50d60"},"c71b7335-ca64-4968-bc93-aea1b1364ad9":{"docHash":"HpxrvLVBqv/k1Xgm3JFbISJTzlnMsFGDu7//PiH09Ic=","refDocId":"854dee56-8823-4290-9045-07c606d50d60"},"cd52993c-2cb5-455f-b8ea-ca0547df580f":{"docHash":"BVvznk9hXxkFxx3yD1xUbgFuW7b5TVA9/P83FYcjX9E=","refDocId":"b9c588f3-4f07-4603-aad2-b90963ffd8f9"},"2b51d23b-253a-46d3-9318-1abd813c30a5":{"docHash":"1PHKY+pRnbV+y1XyiZWY1SkHwyb++55UlmQtsXDanFs=","refDocId":"1c8353c4-295a-47bf-ad1b-edec66ae48e3"},"f2b0fe1f-0ab2-4ef6-a853-9d2182bab392":{"docHash":"yqk2Ig48eEBtdGHuFTFcyaYT/z2cFfAwH5OJpUVB/yo=","refDocId":"1c8353c4-295a-47bf-ad1b-edec66ae48e3"},"d0f7870f-90fa-4c8f-83fa-74ba2fb04333":{"docHash":"eUMR6k+gVm/cY/J+Bs8Psb/MnTBJ7uE2PiH2HPU/TRs=","refDocId":"af4b9470-0392-4d93-8b8d-3b7cc96f4a1a"},"a23f1bb6-aa0d-4101-8e35-985f6cd54af0":{"docHash":"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=","refDocId":"cbd8f608-891e-4328-8965-55ab0ce50082"},"35c4eaad-e8fb-4242-a96f-2ec2b1faffb2":{"docHash":"jyqp6q9fFbhm2SQZJaa2ew96B1MZswnQZ+73FFUmrwU=","refDocId":"0a1ce044-7590-45d8-95d9-aa2229ef4348"},"33b56345-89b5-40ba-8099-8c8bbee87565":{"docHash":"xKv5/b2VLGzWPHtdtH2n17kqcR5YcWQPGZ+dSwgDnms=","refDocId":"a5d127c1-a9ed-4030-9c9a-42639f5473e2"},"d2e6fc6d-3528-48ca-ae36-de4888be8c35":{"docHash":"6VvLlt1d7Psj7+t7eIQvo0MZ+o5moOI8CKnj3EmWRt0=","refDocId":"30aafcee-e279-4452-8e95-a194a034f230"},"e3b1c099-ccfb-4e33-a3be-a8dc2f687fa4":{"docHash":"gPHFLyFOvfoHezeTFfaw/R6NZoPCdab6wEWnfrj8LcM=","refDocId":"30aafcee-e279-4452-8e95-a194a034f230"},"b4346177-7e28-4258-bbf4-e5cf5cbcfc0e":{"docHash":"bI+y40zNngXtTRYY1xBF4q/FQPykBj/DnZbiwzZ1py4=","refDocId":"80aa3952-d000-4091-b8f9-a75b716c9313"},"1aa643f1-9534-4f0f-9d1e-c9b98d58759c":{"docHash":"x2rwR4hPZM7mcXc/iKQFD03Ll+CiUdLYrHSTWPKhon0=","refDocId":"aae33b37-e476-4ad4-accf-6093dc28f5a8"},"ef7b5041-4987-485b-b020-9fdd888135f6":{"docHash":"+Zglw/PxfECEIfcVcAmE0zdxD2jjtHSv9LTotZKUdUY=","refDocId":"825f45c1-0a73-43a7-bc29-be2c02c265ff"},"987a4b27-83b4-4081-8e7f-cee338338530":{"docHash":"X9WbFeARVi5Xw5TrusAzWe+uLVWYtLyVykdSPDsI9fU=","refDocId":"9dbf95de-1c54-4eaa-92a3-09a295a26eef"},"0be053d7-647b-4647-851b-41911b4bd5eb":{"docHash":"kbJ978EYJ8IABMVgW03UJqpGiNlRa6C1j5Bpm5mP71I=","refDocId":"d53c6fc9-e958-4173-88f5-81034b658154"},"b7aae4bd-67bc-4126-8e52-b219f9713b9a":{"docHash":"tMAGSBMSL4zTsnzsCudVr/eOzw1MULUmrdohLb0Qk6U=","refDocId":"abfe51f8-0ba7-491c-afb7-931e54311ce9"},"5c866b32-24d8-49d1-8f0a-2b08cf7b46fc":{"docHash":"r3xLLAbcM3T/ZCY6ycZBe5pzDAuS4t8PQz1p03PJeFI=","refDocId":"e734a186-9266-4ad4-95a4-fcf369aa7cd1"},"b03c03aa-6bef-463a-895b-1de05fe938e5":{"docHash":"z/qjrjrewoEMaTT5oYVkmaeQ8rpd/pn6wdM54yrJDAE=","refDocId":"67ac050e-3c1b-474a-ade2-3fd9b6d14beb"},"d55d596e-d7ee-47f1-8ac9-d7ea07b441ab":{"docHash":"USM5vhmI36bZgrwops+cYihByYg/sEVT0nh8l5hp8gQ=","refDocId":"9cdf290e-9390-4255-a0a4-c16b22b1544b"},"e4734498-b7d7-4d03-a3a5-886d448a7bdd":{"docHash":"G0kF+i/MoPEjSBcqfEIqtQUXgjW7+YJ01/JfeVIJHSo=","refDocId":"68b21055-1e08-49cd-a3fe-d83908b8de55"},"a16b0ab5-16bc-4a6a-8a4e-959dcb8f4c33":{"docHash":"TR+BZ5Kzy9UsvgNF23LXb6aY1diFvsrIOdvt1c1V6FI=","refDocId":"68b21055-1e08-49cd-a3fe-d83908b8de55"},"f100b6c7-e228-4b94-87c7-75401fda1da3":{"docHash":"oopSO0lIQU7RvS/PeI+Izwk6XVWSARP6Z3VCUQT405I=","refDocId":"ed0c81f8-7407-4511-9e8c-816f3aa141a1"},"595b862f-40cf-476e-8d4e-6685bbedc28a":{"docHash":"H1nJnrC3o9/8Wu0/3k0pmHueGJakoYQoPxGU4qaaSfo=","refDocId":"ed0c81f8-7407-4511-9e8c-816f3aa141a1"},"0cee4698-d90d-4880-896f-2354846c34c2":{"docHash":"UVdkl9SmhynUaFMTbsn7xsn65uGlZWNhz6drVxvrQ+4=","refDocId":"d694b5b3-b872-47f3-8d98-ae0af440a12e"},"831c960a-f494-4d1b-8bb0-ce976a3e5707":{"docHash":"WUtZlt/Fosdfb9dPE1czl3sZFeOCOQbmGjiadOK7068=","refDocId":"ba4a2f7f-a52c-4add-923c-9ab1ad613223"},"32e2bd1e-1101-4660-9bb8-44c04cd54c0d":{"docHash":"wa6Xy2qp1xq+GhT/wICu4qAcdWVMOGX13HIt97OWGCk=","refDocId":"c782893e-78de-4a88-837b-55dff5d9bb5d"},"b7816421-55a9-41ec-83e6-542dd4267a8b":{"docHash":"GPqctFcVZk33yASfhVQo1PnkE1p1Hh/dSCaUw7BxYX0=","refDocId":"79e4ce61-65d2-4972-84fc-dc3c7fc52098"},"8f073552-7405-42af-8c55-ee15c6b7df3e":{"docHash":"Gdt0yHLvvGamCD2xvme5hRKBnJALbnw0XtRMVFiUPSI=","refDocId":"e9648ef8-bad2-4433-a267-81248878b5f0"},"5eb85e29-31a3-413b-b473-0bb2b9c1f38b":{"docHash":"g9FD0Jj+dqzjIfNRjArz8OF3QFeWesemjhvBk3U5vv0=","refDocId":"e9648ef8-bad2-4433-a267-81248878b5f0"},"fd7d0c7d-0312-484e-ad99-2eb8a4a062b2":{"docHash":"UxDiMHbtL4dVWWQ+8jXEmK16mkii6pwmKnWcyAgaCAQ=","refDocId":"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141"},"4698fcf2-0439-43a2-bedb-c6a16605f613":{"docHash":"ExW7Ycm2qPFUNu4G98X55O70mJVhYDOZCJybryJnTfQ=","refDocId":"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141"},"a4d77385-a1e8-4eee-91f8-cbf5b52182ad":{"docHash":"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=","refDocId":"e7951e12-0ba0-45db-9bae-b1d24dd657d8"},"990fc85c-c433-4d66-b836-9768a580afe5":{"docHash":"BbTYmODmqHS0mjxKNcmlb8RiMMemW9TB/cMbK8ZwNkU=","refDocId":"b0f10ec1-a0f9-446d-b37d-c23ca090023f"},"12b261eb-72fd-4a12-a7dc-569a8c4914e3":{"docHash":"dwdLStwfp7w/HBzB5q5RB/zkC0RsRJn43/KrnUTaX+U=","refDocId":"d3314be8-9071-4d3d-9790-8056c9f6153b"},"a7718991-2b84-48cc-ae13-53637b9e560e":{"docHash":"w4ao4/WNmXsdEuE2iZ7FQwxgFWm0/IVbpgX8mGQnnuY=","refDocId":"d3314be8-9071-4d3d-9790-8056c9f6153b"},"67c3f24e-e9cb-4c27-bc0f-cb9196234308":{"docHash":"FTI7maZ86xtrKGVnTGfsM3BzwypFcFLBMy2kmbgW+Yg=","refDocId":"c34b7369-b1a5-4522-b1e5-ec923a9a15d1"},"bbe3846e-9bdd-40c0-aed1-5b4099b5ca73":{"docHash":"8+NK5GAwPN2PiNJnYR2d9XmdAvGDwqJJpx4ahY3kv4w=","refDocId":"ff6b3cbe-3a9c-4b8f-ad55-6b602d7f5ca5"},"3cbcf0fc-2dd1-4f0e-b9a3-7e99a4ee774d":{"docHash":"Ek2L5FDqqNJiqjUjftu2DBUnjYhS+msDvoQL3WFZBsQ=","refDocId":"056fbeae-0b50-4e2c-963b-f1113c2162b4"},"1f8e91ca-f934-4c30-8e4e-78b6db485f8a":{"docHash":"cofH3QW8dh4bdfPsmuFGnin+v4dAlgK2+XXxC63GsgU=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"84cdcbc8-23c0-4b20-891a-96060fe56b2c":{"docHash":"b4difR9uOqjZJHUr7arLUd8MwXH2w+y35qlPavSncvI=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"69f390a1-0de1-4fe9-aabe-4290a2c86c6b":{"docHash":"24h/cmux5QI3iGDwqUhU5HlDzPPYTmSRCw2Y7UOynqo=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"2a47a8cc-a22f-4bd9-8406-46f3b5d33c65":{"docHash":"iMUZBLeUh2Vpoaw9z7/xS3jxUrOD6cGpa6UsATlopw8=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"8f27a129-737e-4d77-8f08-086acde73e6b":{"docHash":"oBb38VGSmShU9z6nlx6YCe/oiO+TAvaOB31UFLYSpYA=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"8a64e5aa-7cdb-4833-96f8-c656e5386747":{"docHash":"o2hwArxsRJwxhhr0fG4I5K6DuHcasdBaai3TjZLAo/4=","refDocId":"9c0127d3-de93-4837-9237-bcdd4df71912"},"4e7e5b26-21dd-4870-940d-03f46bfd7f1c":{"docHash":"W9KHBlnSo44klg/1ltqKAQH/39gyVBCkW/nudd5dRV8=","refDocId":"58e19fb5-c662-45f8-82c3-b5b8a1080fca"},"38f54452-39bb-471e-b62a-2e4e16dd1e1b":{"docHash":"Or+3bOwKgzA5FG5LuoLdUoPvMRPUZClvb0GJybz1yXk=","refDocId":"58e19fb5-c662-45f8-82c3-b5b8a1080fca"},"e2fffa70-813d-4951-a43a-8bb5540a0514":{"docHash":"xP06SOGplDB4W7h4IlHrn1f6Kd6My8pyyYDNQsjKm/w=","refDocId":"237e2c81-d9e3-4d82-a415-a925a3130cd5"},"4d6f32c2-be80-4abf-861c-0b0249caa2f0":{"docHash":"U3wZtkDUnb2Q0WHNXm6Nh0QOROF2iztqZQ/lUuvYnR8=","refDocId":"f75748c9-ed3a-415e-a2ea-c4776cafc6e1"},"b33c3f6e-45d9-4a50-b41e-7fd795073e0d":{"docHash":"3fGdeOeIHY0QdItY+bcwOV7vJyIM8nUR0VQt22QcwVs=","refDocId":"717d48c3-17dc-452e-92c4-ad9a4a5f4ca5"},"0207982b-2fad-477b-a1c0-486b3d42303b":{"docHash":"tVb7H2jIKT57sBZW7DMmLluMuRnm+Ubiv6mcnoM2uH0=","refDocId":"2bd3581e-f791-4d91-a713-f494cb2481b3"},"72b16eca-6207-479c-80aa-c8f4ff91166a":{"docHash":"/8VLc24OpBSeTK2buxZHEa8pYBgDQF407rhrNFTwoAw=","refDocId":"4508de05-dfb5-4242-8801-0b8069d8fb89"},"f817d16e-eb2e-4767-be63-850963e81eea":{"docHash":"k30o+XkbDjiGvw5W3VX3NSN5W/CWy1bNL5JAOWrQW0Y=","refDocId":"7dc135f1-4be1-447f-89d0-6c0ec9a6da79"},"48374e1f-e5b8-4591-85c2-11b85ce3689b":{"docHash":"ydk9SVm2qh637AkX8y7PGu72xFJ/9xd01Ti2CVMHy/U=","refDocId":"44f80043-3701-4f1e-90c6-48972ba77ab3"},"0b2e3d13-9f45-46a8-9e11-d3d1643ffb97":{"docHash":"aMr632dDiiYFC9dMTp1v2i36UKbg5kXzrkVnveSpWnY=","refDocId":"afa821b1-1afe-4d78-b934-1a997d0c5f0d"},"d4646e08-c99c-4036-8c33-ce327b52104a":{"docHash":"6QnrEhPsvCsX82iDl56WNJr32OIbvSTECi6cjSt5tow=","refDocId":"afa821b1-1afe-4d78-b934-1a997d0c5f0d"},"8a4ec560-1915-40a4-b1bf-3e7eea743739":{"docHash":"wg6XZFPs8zsSPxn6pyHcCkCBI9z6sqAM0Puntp1/L9Q=","refDocId":"4a72806f-ba1b-4781-8061-63099840abac"},"05f8a896-0111-4f97-b210-d932112bce46":{"docHash":"+lb+YKthMreEAyi3+3V4pEGhjbBPPCB3G2XE2llNV94=","refDocId":"4a72806f-ba1b-4781-8061-63099840abac"},"7a4e5ebf-ebc8-41f5-ba25-d45becc4e6ee":{"docHash":"X+7oZAnUOvAx6ctol8XaX1zMNOw+SSypitgHOieXIjk=","refDocId":"52a5268f-f97e-47f2-9dfe-e066e5e968de"},"04c7287a-0ead-4f59-918d-190064482777":{"docHash":"aZjfhhVSzYlSDN/vhQXpgTYraCjQ7/WUr4gGGdiyoyg=","refDocId":"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371"},"b846ee94-2c29-4416-921c-d603e7c79c8c":{"docHash":"RQ8Mm1pkO6B6tl1H+JpxNrFdP4dREpyJn95nh9xrJw4=","refDocId":"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371"},"47ba07f4-659f-4441-8479-4452e0b7d259":{"docHash":"GPqctFcVZk33yASfhVQo1PnkE1p1Hh/dSCaUw7BxYX0=","refDocId":"dcd87579-1e63-4eed-9010-7e505f44ec5d"},"c0b3134f-46f0-472c-b56a-a15559132b15":{"docHash":"0txM6/p0hB0qGqn4HB9o0Ph1HVgCiFRpx0mtByeGVFg=","refDocId":"3b303dfd-82db-4de5-8baa-5144a18ae7b7"},"587e581a-3f38-4640-9f06-493a8d8bc2e9":{"docHash":"9JnAYRzxiuuHNHC9WZ95mOgHWrGL3pYk5Hai9xJ4THA=","refDocId":"de01d306-f9af-40a1-b099-d58106c559a6"},"a04a9c68-9c4a-44aa-b469-c6214883f7ec":{"docHash":"TOcv9TiEDNZV8jKjive9JnUk2TFRReNVOARwBnHfDjI=","refDocId":"de01d306-f9af-40a1-b099-d58106c559a6"},"8ccaaee2-9402-4125-bce6-12b7c8abcf6d":{"docHash":"rT/Sstm6TFI+vx7SMmr2LpgahFkvYDupgCyhEu8CaPo=","refDocId":"21ae3777-92ef-4f21-9baf-233040386b72"},"b8b1ed7c-72b1-4d98-8021-740f80668bb4":{"docHash":"wqCleOsTX/DCE6emV/6A5u+Wmai//+ldJOyWeunZ3pc=","refDocId":"ccdf9472-a393-49b2-b512-47b9e9150147"},"37a6034a-3024-4810-b3b8-37bd9a7e75e9":{"docHash":"UNRStXjBGd/WVhyygwWt/lAthUSp7QMwnapO32ryBvw=","refDocId":"642f306a-ef53-4442-8cc1-568b44d8fb5c"},"738fd1b1-630c-4615-91fd-a92cee423c49":{"docHash":"L8FXREX6mYTOi/9oHieycs/E50u6/enoei5N/lU2GJI=","refDocId":"524017f9-34f9-49f7-acd9-f3d12c662ab7"},"cb87f621-d13d-414c-bafc-db4f6e74139b":{"docHash":"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=","refDocId":"bb3d8e14-26c4-4a6e-bd39-5b33f2e48550"},"13b7c01f-cd7e-4604-917f-3b6b774a33c5":{"docHash":"bIdrtI2bP7vXEcXbZf04wUe8+lJUoEz017KZJpxhd+w=","refDocId":"f03bce9e-eb76-4fb6-b489-6abc03f4e25f"},"46a39dea-e41d-4b19-ae03-c17be57a918a":{"docHash":"jfh3Tn94Q+9afe3SjlnUi5YWSbNWzEV2PTINaFrlGPE=","refDocId":"bb8ac55f-7f0e-4b81-9902-49365a2cae2b"},"7e531466-1f3a-4d35-98f8-18f7ff6a4bf0":{"docHash":"Lh9t15NqizyKU+iFEyEd6YKYb+rIKqf2/mI9UFKMYr0=","refDocId":"bb8ac55f-7f0e-4b81-9902-49365a2cae2b"},"8f2895c7-92e8-46a3-ba09-402f6c038bc6":{"docHash":"rboqJ90H0JxAH5hoO/1HG6Ry6jkiusVJR6O+mcifINI=","refDocId":"704ef6a6-07b6-47a5-9eef-4d6858d809ec"},"5d63c4cc-b635-4955-b871-5e7d01c54b52":{"docHash":"ltLsOqoXUxbM9EL1go3CiExB+cQHGgcRY8LSFsPIMjE=","refDocId":"0e40f47b-4360-479d-83a4-bedf0541ff93"},"cd953628-34a1-4cc3-a5ac-ae0e04b94ac6":{"docHash":"6xEWOGlZlqF7kACKiD+HmzxEBrjMefO/py7FHyrxdis=","refDocId":"d52c5fcb-9a81-4883-9db2-45012509393f"},"54656135-4f51-40be-9bd4-d11b52e62454":{"docHash":"pqRhk/VgKHZ08AQux+xz6Ue4xxb5DwcPr/gbouGFtuo=","refDocId":"9190086e-6658-4701-a671-1c824a661f31"},"181b7a70-9fd7-48eb-af8f-b367d66d1de7":{"docHash":"seDFIZJFy43dDFVCGcsmQVYn/7ra++OZvLxoQ7T18qk=","refDocId":"21f28f95-f326-4f5d-92cc-a48f7bd0dfeb"},"452ed6ac-55b7-4dd5-97bd-9082ac2ff97f":{"docHash":"YLFbUq72qUjcVoVDZ5mQNXfgcepFMgS9niTyZrLKAws=","refDocId":"5fa4039f-fd43-4ee3-a413-d53475b24a1f"},"e3f223d9-d4bf-409d-aee5-67e5c5200449":{"docHash":"ionkUsyN4pFQU75stvd0vrvl2B0aXz2dileXW02fuYw=","refDocId":"5fa4039f-fd43-4ee3-a413-d53475b24a1f"},"c0ae7a0e-4ef4-40f8-ab26-fa7da4f6ddb8":{"docHash":"oRkZCPtEN/h3SZCz1j6JqDpPERuFcRf+crn3Z05V9cw=","refDocId":"be581b29-c110-4831-9b5c-42dd0f234543"},"4b514e50-6417-4837-89b8-72e05f0869d0":{"docHash":"U/S24XDX+qj8K5KE051htSCbqhSoyt2fyIvuoajLJfI=","refDocId":"be581b29-c110-4831-9b5c-42dd0f234543"},"22ff41d4-5f3d-4898-b508-45db38f07d10":{"docHash":"dMKvIBF/uzjzoukkcszQb7OetH+2DzOM3imgjq7kUvw=","refDocId":"be581b29-c110-4831-9b5c-42dd0f234543"},"e9be23f2-a214-4241-9bd5-4c74f29a0f5c":{"docHash":"5V3m5CjRCsV8MCFVp6XzDk2ND/Jqwi29weeyG+WeK1U=","refDocId":"1e9286a9-7c2a-4055-bf4e-8e9ac541d688"}},"docstore/data":{"10c7ed22-30f5-4bf8-b137-22d47f1bd522":{"__data__":"{\"id_\":\"10c7ed22-30f5-4bf8-b137-22d47f1bd522\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"40ed0b67-25fe-4163-ab0c-05b41290e466\",\"metadata\":{},\"hash\":\"gQY0SecKhqgvDXY87Tk67Ir4KuaAuT8aZ8IbelNnCyY=\"}},\"hash\":\"rv+MGRCoHEj09krakhc6Z1+E1mxg6rHkPZfnXejfVbg=\",\"text\":\"# Unraveling Hidden Patterns of Brain Activity: A Journey Through Hemodynamic Deconvolution in Functional MRI\\n\\n:::{note} Welcome to my PhD dissertation! Thank you for your interest in my work. This website is a summary of my PhD dissertation and is the\\n**perfect place to learn about hemodynamic deconvolution in functional MRI**: a technique that allows\\nyou to blindly estimate the neuronal-related activity without any knowledge of the timings of the\\nneuronal events. :::\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d2d7a1e7-0d9f-4626-b099-b9dfd88ffef0":{"__data__":"{\"id_\":\"d2d7a1e7-0d9f-4626-b099-b9dfd88ffef0\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"48c11a2a-3cd6-4024-b2a4-253c85154968\",\"metadata\":{},\"hash\":\"bl7SXErAHIz5+G2VSXZ96rf8en0FHJs5BIk5opA2W9Q=\"}},\"hash\":\"BkglTXOds6EWELBXPnEaLuUVZNUeak1bo9ZFn8PDcbY=\",\"text\":\"## The different chapters\\n\\nIf you are interested in learning about the current background of the analysis of resting-state\\nfunctional MRI data, please refer to . If you are interested in learning about hemodynamic deconvolution and how it works, please refer\\nto . If you are interested in learning how you can make your estimates more robust without having to\\nselect a fixed value for the regularization parameter $\\\\lambda$, please refer to \\nand . If you want to learn how you can exploit spatial information to improve your estimates of the\\nactivity-inducing signal, please refer to . If you are interested in employing hemodynamic deconvolution to study the shared and individual responses\\nof a group of subjects in a naturalistic paradigm, please refer to . Finally, if you are interested in learning how you can reduce the bias of global components like\\nthe global signal or respiration-related artifacts from your estimates of neuronal-related\\nactivity, please refer to .\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"bb744f3b-86cc-4db3-81b4-94c056888110":{"__data__":"{\"id_\":\"bb744f3b-86cc-4db3-81b4-94c056888110\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"4a091ebe-148b-498e-985f-24d2e6d73bc0\",\"metadata\":{},\"hash\":\"jp7xeijZzPfXoGzJVpVBurtMuHXToTbfq8wytgJG7O4=\"}},\"hash\":\"Mcc6mXTsISBXspkQhjwHAQV6nHH+eD0YcbCO2geizqo=\",\"text\":\"## How to use the Python packages\\n\\nIf you are interested in using the Python packages I developed during my PhD, please refer to the\\n[Paradigm Free Mapping organization on\\nGitHub](https://github.com/orgs/Paradigm-Free-Mapping/repositories) or click on the `Packages`\\nbutton on the top right corner of this page. To install the individual packages, you can use the following commands:\\n\\n::::{tab-set}\\n:::{tab-item} pySPFM\\n\\n```bash\\npip install pySPFM\\n```\\n:::\\n:::{tab-item} splora\\n\\n```bash\\npip install splora\\n```\\n:::\\n:::{tab-item} msPFM\\n\\n`msPFM` will be available soon. Please stay tuned and follow eurunuela\\non X for updates. :::\\n::::\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"527dae8f-f49e-4687-bcf2-008c2109e23b":{"__data__":"{\"id_\":\"527dae8f-f49e-4687-bcf2-008c2109e23b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"4d4e3213-6009-4095-9499-73a7f6facb89\",\"metadata\":{},\"hash\":\"y5tg+dG6667MeRXLOQYj2H3orlev7xSuBo0Gh8oE7Wg=\"}},\"hash\":\"2Kl7h8PnlxbVjzRcdvvioojK8eaW8xaJojmRAo62OSE=\",\"text\":\"## How to cite our work if you used one of our Python packages\\n\\nSelect a tab below to see the citation information for the package you used. ::::{tab-set}\\n:::{tab-item} pySPFM\\n\\nPlease cite the following if you use the package on single-echo data:\\n\\n- \\n- \\n- \\n\\nIf you use the package on multi-echo data, please cite the following:\\n\\n- \\n- \\n- \\n\\nIf you use stability selection, please cite the following as well:\\n\\n- \\n\\n:::\\n:::{tab-item} splora\\n\\nPlease cite the following if you use the package:\\n\\n- \\n\\nIf you use the package without using the low-rank model, please add the following citation as well:\\n\\n- \\n\\nIf you do use the sparse & low-rank model, pleasee add the following citation:\\n\\n- \\n\\n:::\\n:::{tab-item} msPFM\\n\\n`msPFM` will be available soon. Please stay tuned and follow eurunuela\\non X for updates. :::\\n::::\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"26f5f0d2-d6fb-43f6-8161-77dfc0400603":{"__data__":"{\"id_\":\"26f5f0d2-d6fb-43f6-8161-77dfc0400603\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"3ad4a0a9-3855-43ee-af96-f79391cde4fd\",\"metadata\":{},\"hash\":\"fSqOVNEUlUdQvxRxR5yeNUOVbqCn352yColonOCUTx8=\"}},\"hash\":\"W+SSMRUnT/BBVe+U313VzWrQ4gujQEdwKqqgjYqkqh4=\",\"text\":\"## Acknowledgements\\n\\nI would like to thank the [Signal Processing in Neuroimaging\\n(SPiN)](https://bcbl.eu/en/research/research-groups/signal-processing-neuroimaging) lab at the\\nBasque Center on Cognition, Brain and Language (BCBL) for their support and\\nguidance throughout my PhD and I would like to especially thank my supervisors, [Dr. César\\nCaballero-Gaudes](https://bcbl.eu/en/conocenos/equipo/cesar-caballero-gaudes) and Dr. Miguel Ángel Veganzones,\\nfor their support and guidance.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"85876020-5a7a-4912-9d1b-53fefa86ab1f":{"__data__":"{\"id_\":\"85876020-5a7a-4912-9d1b-53fefa86ab1f\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"80eb6b53-ab37-429f-9d85-1d8aacc97c93\",\"metadata\":{},\"hash\":\"D5iV49e7y5u0qiKSfL4M+uW2Zcmcu7Y5niz27Zs5su8=\"}},\"hash\":\"UhuJsya2584b506nVzoCiXRI6AUyQ4w3Du1KiQLYGG0=\",\"text\":\"## Feedback\\n\\nIf you have any feedback or questions, please feel free to reach out to me at\\neurunuela on X or by opening an issue on the GitHub repository of the\\npackage you used.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d25ab7d0-c88d-4add-bda9-089f883056bb":{"__data__":"{\"id_\":\"d25ab7d0-c88d-4add-bda9-089f883056bb\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"fce81d81-f077-4305-a010-1ef0a84d98d7\",\"metadata\":{},\"hash\":\"NhAW7oUwEfEkSpOhsYO38LOqTZ6AKFfWR61mI99qB64=\"}},\"hash\":\"mtOEOmPqVyncn7PEh/FZXCQgoAOQy/yLS0THkW6v7c0=\",\"text\":\"# Abstract\\n\\nFunctional magnetic resonance imaging data analysis is often directed to\\nidentify and disentangle the neural processes that occur in different brain\\nregions during task or at rest, and employs the blood oxygen level dependent\\n(BOLD) signal of fMRI as a proxy for neuronal activity mediated through\\nneurovascular coupling. The goal of this thesis is to enhance and expand\\ntechniques for identifying and analyzing individual trial event-related BOLD\\nresponses based on the Paradigm Free Mapping (PFM) algorithm, which utilizes a linear\\nhemodynamic response model and relies on regularized least squares estimators to\\ndeconvolve the neuronal-related signal that drives the BOLD effect. Notably,\\nthese techniques estimate neuronal-related activity without relying on prior\\nparadigm information. First of all, this work aims to establish the equivalence between the\\nsynthesis-based PFM and analysis-based Total Activation (TA) algorithms. Then,\\nthe thesis addresses the challenge of selecting the regularization parameter. This was accomplished by employing the stability selection procedure, which\\nprovides a measure of the likelihood that the estimated neuronal-related events\\nare accurate. Building upon this, the next goal of this work is to extend the\\noriginal univariate PFM formulation to a multivariate context, enabling the\\nincorporation of spatial information through regularization terms such as the\\n$\\\\ell_1 + \\\\ell_{2,1}$ mixed-norm regularization. Expanding further, the third\\nobjective of this thesis is to extend the multivariate PFM formulation to a\\nmulti-subject framework, facilitating the estimation of shared and\\nindividualized neuronal-related activity across subjects. This approach proved\\nparticularly suitable for naturalistic fMRI experiments. Lastly, the fourth and\\nlast goal of this work is to introduce an additional regularization term, the\\nnuclear norm, into the multivariate PFM formulation. This term was employed to\\nestimate global fluctuations during the deconvolution process and mitigate their\\nimpact on the estimation of neuronal-related activity, thereby reducing bias. The techniques presented in this thesis were thoroughly evaluated using\\nsimulations and experimental fMRI datasets. Comparisons were made with\\nestablished fMRI analysis methods, including the single-trial\\ngeneral linear model, previous PFM algorithms, and other\\nstate-of-the-art techniques. Notably, the developed methods demonstrated the\\nability to accurately detect single trial BOLD responses in resting-state and\\nnaturalistic fMRI data, without relying on prior event information. Additionally, the potential application of multi-subject PFM in\\nidentifying both shared and individualized neuronal-related activity in more\\necological datasets was explored, yielding promising results. Moreover, the\\nutilization of low-rank and sparse PFM facilitated the extraction of\\nglobal fluctuations, such as the global signal, physiological fluctuations, and\\nmotion artifacts, thereby reducing their influence on the analysis. In summary,\\nthis work demonstrates that PFM techniques can be used to reliably\\nretrieve the neuronal-related activity from fMRI data without any prior\\ninformation about the experimental paradigm, and that there now exists a\\nformulation of PFM that is suitable for potentially any experimental\\nsetting and research question.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"7fb5f9a8-c7f4-4e4d-8119-c5283dbabfec":{"__data__":"{\"id_\":\"7fb5f9a8-c7f4-4e4d-8119-c5283dbabfec\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"45457b95-6135-4f8e-8ba9-e617f4125488\",\"metadata\":{},\"hash\":\"8oHPgeFasWGMe/DNdqVS38ySvhYK4P4Gf9rh7GB29RY=\"}},\"hash\":\"TgCLRoDTQcHyE659h3q1sILt4tpd9/O2QR2lHGujXWw=\",\"text\":\"# Acronyms\\n\\n| Acronym | Definition |\\n| --- | --- |\\n| ADHD | attention deficit hyperactivity disorder |\\n| AIC | akaike information criterion |\\n| ASL | arterial spin labeling |\\n| ATS | activation time series |\\n| AUC | area under the curve |\\n| BIC | bayesian information criterion |\\n| BOLD | blood oxygenation-level dependent |\\n| CAP | co-activation pattern |\\n| CBV | cerebral blood volume |\\n| CBF | cerebral blood flow |\\n| CMRO2 | cerebral metabolic rate of oxygen |\\n| CNN | convolutional neural network |\\n| CSF | cerebrospinal fluid |\\n| DAN | dorsal attention network |\\n| DMN | default mode network |\\n| DOT | diffusion optical tomography |\\n| ECoG | electrocorticography |\\n| EEG | electroencephalography |\\n| EROS | event-related optical signaling |\\n| FC | functional connectivity |\\n| fMRI | functional magnetic resonance imaging |\\n| FISTA | fast iterative shrinkage-thresholding algorithm |\\n| FWHM | full-width at half-maximum |\\n| GLM | general linear model |\\n| GM | gray matter |\\n| GSBS | greedy state boundary search |\\n| HMM | hidden Markov model |\\n| HR | heart rate |\\n| HRF | hemodynamic response function |\\n| iCAPs | innovation-driven co-activation patterns |\\n| ICA | independent component analysis |\\n| ISC | inter-subject correlation |\\n| LARS | least angle regression |\\n| LASSO | least absolute shrinkage and selection operator |\\n| MAD | median absolute deviation |\\n| ME | multi-echo |\\n| ME-ICA | multi-echo independent component analysis |\\n| ME-SPFM | multi-echo sparse paradigm free mapping |\\n| MFISTA-VA | monotone fast iterative shrinkage-thresholding algorithm with variable acceleration |\\n| MRI | magnetic resonance imaging |\\n| MR | magnetic resonance |\\n| MRSI | MR spectroscopy |\\n| MvME-SPFM | multivariate multi-echo sparse paradigm free mapping |\\n| Mv-SPFM | multivariate sparse paradigm free mapping |\\n| msPFM | multi-subject paradigm free mapping |\\n| NIRS | near-infrared spectroscopy |\\n| PET | positron emission tomography |\\n| PFM | paradigm free mapping |\\n| PopSync+ | population synchrony |\\n| PS | phase synchrony |\\n| PPI | psychophysiological interactions |\\n| QPP | quasi-periodic patterns |\\n| RVT | respiratory volume per time |\\n| ROC | receiver operating characteristic |\\n| ROI | region of interest |\\n| RSSD | root sum of squares difference |\\n| SNR | signal-to-noise ratio |\\n| SVD | singular value decomposition |\\n| SPLORA-PFM | sparse and low rank paradigm free mapping |\\n| SPFM | sparse paradigm free mapping |\\n| TA | total activation |\\n| TCD | transcranial doppler ultrasound |\\n| TE | echo time |\\n| TR | repetition time |\\n| WM | white matter |\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"6a050ab1-9783-4fdb-b081-f3e2b28da60e":{"__data__":"{\"id_\":\"6a050ab1-9783-4fdb-b081-f3e2b28da60e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"8220089e-1607-443c-b6b0-269527161c38\",\"metadata\":{},\"hash\":\"xkiIwA1pY/YXEl5gjmaL380uv0LjKFgSPfYH2cb45Xo=\"}},\"hash\":\"CaRqVCYwprUy1Bi9pPNaMQLHI/gb4Jn2NCmNze+BcTo=\",\"text\":\"# Chapter 7: Conclusion and future directions\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"259ca24d-c199-4e97-b721-3d535ed41052":{"__data__":"{\"id_\":\"259ca24d-c199-4e97-b721-3d535ed41052\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"58163131-12e6-44ea-bc97-e67a6315c8b2\",\"metadata\":{},\"hash\":\"2QoPvMe2JoZQYlb9vuex6e5ihlC8uajQjHF0N3OPZp0=\"},\"NEXT\":{\"nodeId\":\"848b085d-2053-4009-ba2f-bbf3fbfd68d1\",\"metadata\":{},\"hash\":\"cf1i42Xiou0IApyX/BZ87XxGC0xQ3GhJ4odQRFBwnZM=\"}},\"hash\":\"5WeJ8Uv95NPAMgFN1Wb4e/9v76xJ+XQs6dJ76r5vQBQ=\",\"text\":\"## Summary and Final Discussion\\n\\nAs mentioned in {ref}`the introduction <cha-intro>`, conventional single trial fMRI analysis relies\\nheavily on preexisting knowledge of event timing\\n[@Buckner1996Detectioncorticalactivation;@Menon1998Mentalchronometryusing;@Richter1997TimeresolvedfMRI]. However, in certain situations such as clinical settings, resting-state, or naturalistic paradigms,\\nit can be challenging or even impossible to formulate a temporal model of activations. This thesis\\nhas introduced new fMRI analysis techniques that allow for the study of true single trial BOLD\\nresponses without any prior information about the event timings. These methods greatly improve upon\\nthe Paradigm Free Mapping (PFM) approach [@Gaudes2013Paradigmfreemapping], and extend its\\ncapabilities to include multivariate and multi-subject settings. In {ref}`Chapter 2 <cha-synthesis-analysis>`, the underlying motivations and principles of PFM and\\nhemodynamic deconvolution are discussed. Additionally, the chapter also delved into existing fMRI\\nanalysis methods that aim to conduct single trial experiments without the need for precise or null\\nspecifications of the experimental paradigm. Notably, Total Activation (TA) was highlighted as a\\nleading deconvolution technique that follows an analysis formulation, in contrast to the synthesis\\nformulation of PFM. The chapter also introduced the block model for PFM, which allows for the\\nestimation of the innovation signal --the derivative of the activity-inducing signal. This approach\\nis especially useful for block-design experiments and utilizes the sparsity constraint of the LASSO\\nmore effectively. After thorough comparison, it was found that the two methods are essentially\\nequivalent, with PFM emerging as the preferred option due to its simplistic and adaptable\\nformulation. This paved the way for the development of various PFM techniques in this thesis,\\nincluding {ref}`stability-based PFM <cha-stability>`, {ref}`multivariate PFM <cha-multivariate>`,\\n{ref}`multi-subject PFM <cha-multi-subject>`, and {ref}`sparse and low-rank PFM <cha-low-rank>`. A crucial aspect for achieving satisfactory operation of the PFM techniques is the accurate\\nselection of the regularization parameters, as the deconvolution relies on regularized estimators. In the original PFM techniques [@Gaudes2013Paradigmfreemapping], the choice of the regularization\\nparameter $\\\\lambda$ was determined using Akaike and Bayesian information criteria independently for\\neach voxel. {ref}`Chapter 3 <cha-stability>` introduced an alternative approach based on stability\\nselection, which eliminates the need for selecting this parameter altogether. Moreover, this new\\nprocedure offers an additional metric, defined as the area under the curve of the stability path,\\nthat represents the likelihood of the detected events being true at the finest spatial and temporal\\nscales. {ref}`Chapter 4<cha-multivariate>` presented a novel approach to the PFM methodology, introducing a\\nmultivariate formulation that organizes voxel or ROI time series into a matrix and incorporates the\\nstability selection procedure. By combining these two techniques with the use of the $\\\\ell_1 +\\n\\\\ell_{2,1}$ mixed norm group sparsity regularization --which incorporates spatial information and\\ninteractions into the formulation-- the chapter showcased the enhanced performance of the\\nmultivariate PFM with stability selection in comparison to the original univariate formulation of\\nPFM. Notably, this method yielded results that were more concordant with single-trial GLM findings. Additionally, the chapter demonstrated the robustness of the approach across both single-echo and\\nmulti-echo fMRI data. This was achieved through the utilization of the area under the curve (AUC)\\nmeasure, which facilitated the application of various thresholding techniques adaptable to the\\nnoise level inherent in the data. {ref}`Chapter 5 <cha-multi-subject>` introduced a new application of the multivariate PFM\\nformulation: simultaneous deconvolution of multiple subjects performing a naturalistic paradigm. In\\nthis case, instead of concatenating voxels or ROIs to form a time by space matrix, the same voxel\\nor ROI from different subjects was used to create a time by subject matrix. The underlying\\nassumption is that the estimation of neuronal-related activity should not be significantly affected\\nby anatomical and functional differences between subjects once their data has been aligned to a\\nshared space or template. This assumption holds true when analyzing data at the ROI level, where\\ndifferences are smoothed out during averaging and spatial resolution is reduced. However, when\\nworking with voxels, this assumption no longer holds, and differences across subjects are expected.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"848b085d-2053-4009-ba2f-bbf3fbfd68d1":{"__data__":"{\"id_\":\"848b085d-2053-4009-ba2f-bbf3fbfd68d1\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"58163131-12e6-44ea-bc97-e67a6315c8b2\",\"metadata\":{},\"hash\":\"2QoPvMe2JoZQYlb9vuex6e5ihlC8uajQjHF0N3OPZp0=\"},\"PREVIOUS\":{\"nodeId\":\"259ca24d-c199-4e97-b721-3d535ed41052\",\"metadata\":{},\"hash\":\"5WeJ8Uv95NPAMgFN1Wb4e/9v76xJ+XQs6dJ76r5vQBQ=\"}},\"hash\":\"cf1i42Xiou0IApyX/BZ87XxGC0xQ3GhJ4odQRFBwnZM=\",\"text\":\"Due to the immense computational cost and memory requirements of simultaneously deconvolving 43\\nsubjects at the voxel level, the analysis in this chapter was performed at the ROI level, where the\\nassumption remained valid. The results demonstrated the capability of the multi-subject PFM (msPFM)\\nalgorithm to detect shared and individualized neuronal-related activity across subjects without\\nprior knowledge. Furthermore, the technique successfully linked moment-to-moment brain activity to\\nits underlying causes. Encouragingly, the group synchrony metric showed significant correlations\\nwith changes in luminance, audio, speech, the presence of hands, and the presence of faces. Importantly, msPFM was able to adapt to different movies. For example, in the movie \\\"Iteration,\\\"\\nwhere a single character's face was frequently shown, the group synchrony metric correlated with\\nthe presence of faces in left middle temporal gyrus, which is associated with face familiarity and\\ngaze. In contrast, in the movie \\\"Sherlock,\\\" where multiple characters appeared and facial\\nidentification was more challenging, the group synchrony metric correlated with changes in the\\npresence of faces in the fusiform face areas. These findings indicate that participants may have\\nadapted to certain characteristics of the stimuli, such as luminance and the presence of faces, and\\nthat the msPFM estimates were able to capture this adaptation. Although these results are\\npromising, many questions still remain unanswered. For instance, utilizing msPFM could help us\\nunderstand how the human brain comprehends complex multiplexed signals and identify the specific\\nstimulus features that elicit responses. Furthermore, msPFM has the potential to elucidate the\\nconnection between individual differences in these responses and subsequent memory formation or\\nappraisal of the stimulus. In {ref}`Chapter 6 <cha-low-rank>`, the nuclear norm was employed as an additional regularization\\nterm in the multivariate PFM formulation. This term effectively tackles the issue of global\\nfluctuations in the BOLD signal, including motion-related signals and physiological artifacts,\\nwhich can distort the deconvolution of neuronal-related activity. By employing the sparse and\\nlow-rank PFM algorithm, the method successfully mitigated this bias, resulting in an accurate\\nestimation of the activity-inducing signal. Notably, the results exhibited a remarkable similarity\\nbetween the sparse and low-rank PFM algorithm and the single-trial GLM results in detecting\\nneuronal-related activity in a complex dataset characterized by numerous conditions in the\\nexperimental task. When the regularization parameter $\\\\lambda$ was manually selected, the algorithm\\nperformed comparably to the multivariate PFM. However, the selection of the regularization\\nparameter for the nuclear norm penalty in the sparse and low-rank PFM posed a significant\\nchallenge, which will be addressed in the subsequent section. Given the success of the stability\\nselection procedure in \\\\cref{cha:stability} and \\\\cref{cha:multivariate}, it is worth exploring its\\nadaptation for this algorithm to avoid selecting all three regularization parameters. Overall, these series of studies demonstrate that PFM techniques can be used to\\nreliably retrieve the neuronal-related activity from fMRI data without any prior\\ninformation about the experimental paradigm, and that there now exists a\\nformulation of PFM that is suitable for potentially any experimental setting and\\nresearch question. Finally, the code used for all the research and algorithms presented in this thesis was written in\\nPython. To promote the use of the PFM techniques developed within this thesis, three separate\\nPython packages have been created and made available as open source software: `pySPFM` for the\\nunivariate analysis and as the core library for the other two, `splora` for the multivariate and\\nsparse and low-rank PFM, and `msPFM` for the multi-subject version of PFM. The packages are\\navailable on GitHub at\\nhttps://github.com/paradigm-free-mapping and can be\\ninstalled using the Python package manager `pip`.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"2c1b9875-321c-4bb5-b913-187ed16db6b5":{"__data__":"{\"id_\":\"2c1b9875-321c-4bb5-b913-187ed16db6b5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"8c95bfcb-1805-4a7b-96dc-a4cb018444af\",\"metadata\":{},\"hash\":\"xfIEbeJnOmBZecGQRrH7/imINrHHbENpADrPyY5iWjk=\"},\"NEXT\":{\"nodeId\":\"8891b0ec-5e68-4c97-86e6-f3725ac14f46\",\"metadata\":{},\"hash\":\"Ws6pLCCn6+7AAgj3rnrOnnUKaM/rtsCNGu7gGxK7cQQ=\"}},\"hash\":\"7Dy6FKlXltywTru18X2j4ZVnfXreVYg+PWoMVGL942k=\",\"text\":\"## Future Developments\\n\\nThis thesis showcases research findings that emphasize certain aspects deserving further\\ndevelopments or refinement. First of all, this thesis assumed an identical hemodynamic response\\nmodel for the entire brain. However, the waveform of the hemodynamic response function (HRF) is\\nknown to vary across voxels within cortical regions, across cortical regions, and across subjects\\n[@Aguirre1998VariabilityHumanBOLD;@Handwerker2004VariationBOLDhemodynamic;@Miezin2000CharacterizingHemodynamicResponse;@Zwart2005TemporaldynamicsBOLD;@Saad2001AnalysisuseFMRI],\\npotentially reflecting different local distributions of vascular anatomy and neurovascular\\ncoupling. Therefore, employing prior information about the HRF would allow a more precise\\nestimation of neuronal-related events. Its implementation is straightforward in the case of the\\nunivariate formulation of PFM. However, the use of voxel- or region-specific HRFs is not as\\nstraightforward in a multivariate scenario. An alternative solution would be to apply the\\nmultivariate PFM technique within ROIs using an ROI-specific HRF. An alternative strategy would be\\nto adaptively model the HRF by including the temporal and dispersion derivatives of the assumed\\ncanonical HRF in the Toeplitz matrix of the deconvolution model\\n[@Gaudes2012Structuredsparsedeconvolution]. Another area of focus to improve PFM is the integration of new regularization\\nterms to mitigate the bias associated with the $\\\\ell_1$-norm. In cases where a\\ngrouping sparsity constraint is not applied or when dealing with the univariate\\nPFM, an effective method would be to implement regularization with the\\n$\\\\ell_0$-norm. However, this presents a challenge as the optimization problem\\nassociated with the $\\\\ell_0$-norm is known to be a non-convex, NP hard problem. In such cases, an alternative solution could be to utilize $\\\\ell_{0.5}$-norm\\nregularization instead. For the multivariate formulations, a viable option would\\nbe to adopt the OSCAR (octagonal selection and clustering algorithm for\\nregression) regularizer. This method involves the use of a combination of\\n$\\\\ell_1$ and pair-wise $\\\\ell_{\\\\infty}$-norms, which is responsible for its\\ngrouping behavior. This approach was proposed to promote group sparsity in\\nsituations where the groups are not known beforehand\\n[@Bondell2008SimultaneousRegressionShrinkage;@Gueddari2021CalibrationLessMulti]. The multivariate formulation of PFM has introduced a significant advancement by\\nenabling the incorporation of spatial information and interactions into the\\nestimation of neuronal-related activity. This opens up possibilities for\\nenhancing the estimation process. For example, the matrix representing the\\nestimated activity-inducing signal $\\\\mathbf{S}$ could be multiplied by a\\nconnectivity matrix that represents the interactions between voxels or ROIs in\\nthe penalty term. This connectivity matrix could be obtained from other imaging\\nmodalities, either structural connectivity from diffusion-weighted MRI or\\nfunctional connectivity from complementary electrophysiological recordings\\n(e.g., EEG or MEG). The main limitation of the current multi-subject PFM approach is the assumption that the anatomical\\nand hemodynamic differences between subjects do not significantly affect the estimation of\\nneuronal-related activity when all the data is moved into a shared space. This assumption holds to\\nsome extent when working with ROIs, where spatial resolution is reduced and finer anatomical\\ndifferences across subjects are smoothed out during averaging. However, this assumption no longer\\nholds striclty in the case of operating at the voxel level. In other words, a perfect anatomical\\nalignment and voxel-to-voxel correspondence in the location of activations cannot be assumed across\\ndifferent subjects. To address the issue of inter-subject spatial variability of functional\\nactivations, optimal transport theory could be adopted. This approach, as demonstrated in\\n[@Gramfort2015FastOptimalTransport;@Janati2019Wassersteinregularizationsparse;@Janati2020MultisubjectMEG/EEG],\\ndoes not require exact spatial correspondence between neuronal-related events in the group of\\nsubjects. Instead, it compares the estimates by considering the geodesic distances between their\\nlocations. Furthermore, to tackle the sources of invariance arising from shifts in time, space, and\\ntotal population size, a more sophisticated formulation that integrates dynamic time warping and\\nunbalanced optimal transport could be considered [@Janati2022AveragingSpatiotemporal]. Furthermore, the selection of the regularization parameter for the nuclear norm in the sparse and\\nlow-rank PFM poses a significant challenge.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8891b0ec-5e68-4c97-86e6-f3725ac14f46":{"__data__":"{\"id_\":\"8891b0ec-5e68-4c97-86e6-f3725ac14f46\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"8c95bfcb-1805-4a7b-96dc-a4cb018444af\",\"metadata\":{},\"hash\":\"xfIEbeJnOmBZecGQRrH7/imINrHHbENpADrPyY5iWjk=\"},\"PREVIOUS\":{\"nodeId\":\"2c1b9875-321c-4bb5-b913-187ed16db6b5\",\"metadata\":{},\"hash\":\"7Dy6FKlXltywTru18X2j4ZVnfXreVYg+PWoMVGL942k=\"}},\"hash\":\"Ws6pLCCn6+7AAgj3rnrOnnUKaM/rtsCNGu7gGxK7cQQ=\",\"text\":\"In this thesis, a fixed number of low rank components\\nwas chosen as the criterion for selection. However, if functional activations are widespread, this\\napproach may mistakenly classify components resembling BOLD responses as a low-rank, global\\ncomponents. Alternatively, one could consider using a more liberal value for the regularization\\nparameter and then employ a decision tree to distinguish between global and neuronal-related\\ncomponents. For instance, such a decision tree could be developed by drawing inspiration from the\\nICA AROMA [@Pruim2015ICAAROMArobust] or ICA FIX [@SalimiKhorshidi2014Automaticdenoisingfunctional]\\nmethods. Moreover, the application of the low-rank and sparse PFM to resting-state fMRI data\\nremains to be studied. Future research should also consider the development of deep learning methods for fMRI\\ndeconvolution based on physical models of the BOLD signal. Convolutional neural networks (CNNs)\\nhave gained significant attention due to their exceptional performance in object classification and\\nsegmentation tasks, achieved through training on large image databases. Inspired by these\\nachievements, CNNs have been applied to various inverse problems in imaging, such as denoising,\\ndeconvolution, superresolution, and medical image reconstruction\\n[@McCann2017ConvolutionalNeuralNetworks;@Wang2020Multiresolutionconvolutional]. These applications\\nhave demonstrated promising results, surpassing state-of-the-art techniques, including compressed\\nsensing. Consequently, the implementation of CNNs in PFM techniques has the potential to enhance\\nthe accuracy of neuronal-related activity estimates. However, these models are very expensive to\\ntrain as they require large amounts of data and computational power. Hence, physics-based and\\nself-supervising models could be explored for the development of PFM's deep learning counterparts\\n[@Lucas2018UsingDeepNeural;@LopezTapia2021Deeplearningapproaches;@Hammernik2023PhysicsDrivenDeep;@Aggarwal2019MoDLModelBased]. Finally, the availability of the Python libraries for researchers is crucial. However, in order to promote wider adoption of the PFM techniques, it is\\nessential that these libraries are well documented and include numerous usage\\nexamples. Therefore, the development of a comprehensive documentation and\\ntutorial is a priority for the near future.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d911f7c4-f10e-4215-991d-462f50e069b6":{"__data__":"{\"id_\":\"d911f7c4-f10e-4215-991d-462f50e069b6\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"eaaba3a1-137a-4b33-a1ed-1c41e982caaa\",\"metadata\":{},\"hash\":\"lGl839RNqskX6bbxzMlMj29jnJv2S2MKDj6rJYcYxJ4=\"}},\"hash\":\"QV8Xti5pXVMtlzPEjKI8xh8CU2AJtYuWrpEacR70p1U=\",\"text\":\"# Chapter 1: Functional Magnetic Resonance Imaging and Blood Oxygen Level Dependent Signal\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"7b489c1d-f344-41ef-93f7-45d2b53d95c8":{"__data__":"{\"id_\":\"7b489c1d-f344-41ef-93f7-45d2b53d95c8\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"f9ef9a39-81ab-4227-9cc4-1c6c3020bfa8\",\"metadata\":{},\"hash\":\"C25d0gEE0NC05NqqJJWCO/LM58ZAs7XqkObewv9w5g4=\"}},\"hash\":\"epXWeXArz3swqkKZrPHBkOkkKewPibfCYU4JlVOKEJE=\",\"text\":\"## Functional Imaging of the Human Brain\\n\\nFor over a century, neuroscientists and neurophysiologists have dedicated their efforts to uncovering the functional\\norganization of the brain. Through the use of various functional neuroimaging techniques with complementary temporal and\\nspatial resolutions, they aim to reveal the neuro-anatomical localization and dynamic changes of brain activations. While non-invasive electrophysiological techniques such as electroencephalography (EEG) or magnetoencephalography (MEG)\\nexcel in temporal resolution (10-100 ms), their spatial resolution is relatively poor (several mm or cm)\\n[@Baillet2001Electromagneticbrainmapping;@Haemaelaeinen1993Magnetoencephalographytheoryinstrumentationapplications]. In\\ncontrast, invasive electrophysiological techniques, including patch clamps [@Neher1978extracellularpatchclamp],\\nsingle-unit or multi-unit recordings [@Arieli1995Coherentspatiotemporalpatterns], and electrocorticography (ECOG)\\n[@Miller2007Realtimefunctional;Nir2008Interhemisphericcorrelationsslow], offer high spatial resolution. Functional magnetic resonance imaging (fMRI) and Positron Emission Tomography (PET) provide insight into cerebral blood\\nflow and oxygen metabolism, indirectly associated with neural activations. With spatial resolutions in the order of\\nmillimeters, these techniques are capable of capturing activations in both cortical and deep brain structures, but their\\ntemporal resolution is limited by the sluggish dynamics of hemodynamic changes [@Dale2001Spatiotemporalmappingbrain]. fMRI offers higher temporal and spatial resolution compared to PET, making it more suitable for studying the temporal\\nresponses to short neuronal-related events. However, PET has the advantage of measuring well-defined physiological\\nquantities such as cerebral blood flow (CBF), cerebral blood volume (CBV), or cerebral metabolic rate of oxygen or CMRO2\\n[@Fox1986Mappinghumanvisual;@Friston1993FunctionalConnectivityPrincipal]. Functional MR spectroscopy (MRS) is an alternative method for metabolic imaging, offering quantitative measurements of\\nfunctional changes in neurometabolite and neurotransmitter concentrations within a specific brain region. However, it is\\nimportant to note that MRS has lower spatial and temporal resolutions compared to fMRI\\n[@Morris1999Magneticresonanceimaging]. Typically, MRS is performed in a single voxel with an isotropic size of a few\\ncentimeters, or in multiple voxels using chemical shift imaging. Lastly, optical diffusion imaging techniques, such as near infrared spectroscopy (NIRS)\\n[@Kleinschmidt1996SimultaneousRecordingCerebral;@Villringer1993infraredspectroscopyNIRS], diffusion optical tomography\\n(DOT) [@White2010Quantitativeevaluationhigh], or event-related optical signaling (EROS)\\n[@Gratton2001eventrelatedoptical;@Gratton1997FastLocalizedEvent], utilize an optical imaging device placed on the scalp\\nto measure changes in cortical blood flow. However, due to the need for the light to penetrate through the skull, these\\ntechniques have lower spatial resolution compared to MR imaging techniques and are limited to studying the cortical\\nsurface. The temporal resolution of EROS is similar to MEG and EEG (in the order of milliseconds), while NIRS has a ten\\ntimes higher temporal resolution to fMRI.A notable advantage of optical imaging is its lower cost and portability\\ncompared to other techniques such as MRI or MEG.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"79a7dec8-106d-4638-ab18-d1e28015b5c2":{"__data__":"{\"id_\":\"79a7dec8-106d-4638-ab18-d1e28015b5c2\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"00546dc8-1249-499f-b566-89d8623c2656\",\"metadata\":{},\"hash\":\"tX9M2Lqs2rGbs9KuMi4uf8ztr9weJak1LFWKlR3VujU=\"}},\"hash\":\"MkEDy83sPUIhkPm0MLlRQhjrZ7p7RfmXwxaUh9hJwGA=\",\"text\":\"## Blood Oxygen Level Dependent Functional MRI\\n\\nIn order to fully comprehend the assumptions and methods presented in this thesis, it is essential to review some basic\\nconcepts related to the physical and physiological basis of the blood oxygen-level dependent (BOLD) effect. MRI\\ntechniques offer a range of approaches to detect the increased metabolic demand associated with brain function. These\\ninclude utilizing the BOLD contrast, changes in CBV using contrast agents such as gadolinium [@Dean1992CerebralHA],\\nferumoxytol [@Christen2012Highresolutioncerebral] or hyperoxic contrasts [@Bulte2007Measurementcerebralblood], and\\nassessing CBF through arterial spin labeling techniques (ASL) [@Buxton2009IntroductionFunctionalMagnetic]. BOLD fMRI,\\nintroduced by [@Ogawa1990Brainmagneticresonance;@Ogawa1992Intrinsicsignalchanges], is particularly advantageous as it\\nrequires no exogenous contrast agent and exhibits higher sensitivity compared to CBF-based contrast, such as ASL. Consequently, it has gained widespread usage for functional brain imaging.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"c6d0dbc2-4289-4102-a470-f4dc1a3cf62d":{"__data__":"{\"id_\":\"c6d0dbc2-4289-4102-a470-f4dc1a3cf62d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"78b834e4-5028-442d-ad2d-cf943ea5b03e\",\"metadata\":{},\"hash\":\"LMcsNALcznjFBtEv7Cgh8KXENlUfxn3DVK1Aq3ysmW0=\"}},\"hash\":\"3yUU1flcy3CJExxjtMh5Soy83gCTZexUJEQlyv/aFFk=\",\"text\":\"### Physiological Basis of the BOLD Constrast\\n\\nThe signal contrast in BOLD fMRI images arises from variations in the local magnetic susceptibility, $\\\\chi$, caused by\\ndisparities in blood hemoglobin oxygen concentration. As local neuronal activity intensifies, there is a rise in oxygen\\nconsumption, leading to an augmented supply of oxygenated blood that diffuses passively through the capillary blood\\nvessels to the tissue. When oxygen binds to hemoglobin (forming oxyhemoglobin), it exhibits slight diamagnetic\\nproperties relative to the tissue, causing the molecule to repel the magnetic field. In contrast, deoxygenated\\nhemoglobin is paramagnetic compared to the tissue, attracting the magnetic field. Consequently, the magnetic field\\nbecomes distorted near deoxygenated red blood cells, creating higher local magnetic field gradients in the surrounding\\ntissue, which results in spin dephasing. Reduced oxygenation amplifies the spin dephasing effect, shortening the\\ntissue's $T_2^*$ and diminishing the amplitude of the MR signal in $T_2^*$-weighted images. Conversely, higher oxygen\\nconcentration aligns the susceptibility of the blood with that of the surrounding tissue, reducing the local magnetic\\nfield gradient, increasing $T_2^*$, and raising the measured MR signal amplitude by a few percent. This forms the basis\\nof BOLD fMRI, where changes in blood oxygenation serve as an intrinsic contrast mechanism in $T_2^*$-weighted images,\\nenabling the identification of cortical regions exhibiting functional activity characterized by increased oxygen demand\\nand supply\\n[@Bandettini1992TimecourseEPI;@Belliveau1991FunctionalMappingHuman;@Kwong1992Dynamicmagneticresonance;@Ogawa1990Brainmagneticresonance;@Ogawa1992Intrinsicsignalchanges;@Turner1991Echoplanartime].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a557883d-2dcc-4057-b718-70d251aed68e":{"__data__":"{\"id_\":\"a557883d-2dcc-4057-b718-70d251aed68e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"fc6da928-c2ee-4804-877e-7d2318aabe6e\",\"metadata\":{},\"hash\":\"xlstDpb6SC8G+AgTmbCMN1fojir0C36K1V+Fo/FmPhE=\"},\"NEXT\":{\"nodeId\":\"a404d862-2a81-4900-bef8-49e8b0119d9d\",\"metadata\":{},\"hash\":\"x3eMmF8nNVin+h3Su1gI4ityGJpAdEE/dLqSttDi1AU=\"}},\"hash\":\"q9r//AJ56XAy0mIsJWyQpcKiuY46gGgHVn0tN+eLUgs=\",\"text\":\"### Temporal Characteristics of the BOLD Signal: the Hemodynamic Response Function\\n\\nThe BOLD effect does not directly reflect neuronal activity, but rather measures the hemodynamic response associated\\nwith it [@Logothetis2008Whatwecan;@Logothetis2001Neurophysiologicalinvestigationbasis]. The relationship between the\\nhemodynamic response and the underlying neuronal activity is complex involving dynamic changes in CBF, CBV and $CMRO_2$\\n[@Buxton2009IntroductionFunctionalMagnetic]. After neuronal activity increases in a brain region, there is an initial\\ndecrease in blood oxygenation due to oxygen consumption which might cause a small initial dip in the hemodynamic\\nresponse following the first second after the activation\\n[@Ernst1994Observationfastresponse;@Menon1995BOLDBasedFunctional]. Although this initial dip is not always observed in\\nfMRI\\n[@Behzadi2006Caffeinereducesinitial;@Buxton2009IntroductionFunctionalMagnetic;@Hu1997Evaluationearlyresponse;@Hu1997Evaluationearlyresponse],\\nit is suggested that it maps more accurately the site of neural activity\\n[@Duong2000SpatiotemporaldynamicsBOLD;@Malonek1996InteractionsElectricalActivity]. Afterwards, the local supply of\\noxyhemoglobin increases more than it is strictly demanded, probably to ensure a large oxygen gradient across capillary\\nwalls so that there is a high rate of transfer of oxygen or glucose to tissue [@Logothetis2008Whatwecan], generating a\\npositive BOLD response due to an excess of oxyhemoglobin. Negative BOLD responses have also been observed associated\\nwith neuronal deactivations [@Shmuel2006NegativefunctionalMRI]. Regardless of the polarity of the response, the BOLD\\nresponse peaks between 5 and 8 s after the activation starts and its amplitude depends on the type of stimulus and the\\nmagnetic field strength. For instance, for visual stimulation the signal change is 2-3% at 1.5T, 4-6% at 3T, 7-10% at 7T\\n[@Zwaag2009fMRI1.53]. After the stimulus ceases, there is a return of the BOLD response to baseline, often followed by a\\npost-stimulus undershoot due to an increase of deoxyhemoglobin which may last for several seconds until the response\\nreturns to baseline. The cause of the post-stimulus undershoot is also not completely understood, whether this is a\\nvascular, neural or metabolic effect [@Buxton2009IntroductionFunctionalMagnetic;@Chen2009OriginsBOLDpost]. In summary,\\nthe time scale of the BOLD response is much slower than the time scale of neural activity and the return of the BOLD\\nsignal to baseline level after a short stimulus may occur more than 30 s from the stimulus onset. The temporal\\ncharacteristics of the BOLD response are usually modelled by a hemodynamic response function (HRF). shows the shape of typical HRF, along with the initial dip for illustration of this effect. In this figure, the HRF\\nplotted is the well-known canonical HRF [@Friston2007Statisticalparametricmapping;@Friston1998EventRelatedfMRI], which\\nis defined as the difference of two-gamma functions:\\n\\n```{figure} figures/introduction/hrf_shape.png\\n:name: fig-hrf-shape\\n:align: center\\n\\nTemporal characterization of the haemodynamic response function. The shape in bold line\\ncorresponds to the canonical haemodynamic response function. ```\\n\\n```{math}\\n    h(t)=g(t; a_1, b_1) - \\\\frac{1}{c}g(t; a_2, b_2),\\n```\\n\\nwhere the Gamma function is given by\\n\\n```{math}\\n    g(t; a, b) = \\\\frac{b^a t^{a-1} e^{-bt}}{\\\\Gamma(a)}. ```\\n\\nThe canonical HRF, as described in literature [@Friston2007Statisticalparametricmapping], is characterized by specific\\nparameters. These parameters include a time-to-peak $(a/b)$ of 6 s and dispersion $(a/b^2)$ of 1 s for the initial\\novershoot. Additionally, it has a time-to-peak of 16 s and dispersion of 1 s for the undershoot. The\\novershoot-undershoot ratio $(c)$ is approximately 6.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a404d862-2a81-4900-bef8-49e8b0119d9d":{"__data__":"{\"id_\":\"a404d862-2a81-4900-bef8-49e8b0119d9d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"fc6da928-c2ee-4804-877e-7d2318aabe6e\",\"metadata\":{},\"hash\":\"xlstDpb6SC8G+AgTmbCMN1fojir0C36K1V+Fo/FmPhE=\"},\"PREVIOUS\":{\"nodeId\":\"a557883d-2dcc-4057-b718-70d251aed68e\",\"metadata\":{},\"hash\":\"q9r//AJ56XAy0mIsJWyQpcKiuY46gGgHVn0tN+eLUgs=\"}},\"hash\":\"x3eMmF8nNVin+h3Su1gI4ityGJpAdEE/dLqSttDi1AU=\",\"text\":\"The\\novershoot-undershoot ratio $(c)$ is approximately 6. However, it is important to note that the BOLD response exhibits\\nvariability across trials, brain regions, and subjects\\n[@Aguirre1998VariabilityHumanBOLD;@Duann2002SingleTrialVariability;@Handwerker2004VariationBOLDhemodynamic;@McGonigle2000VariabilityfMRIExamination;@Smith2005VariabilityfMRIre]. To account for this variability, alternative HRF shapes have been proposed in the scientific literature. These include\\nsingle gamma functions [@Boynton1996LinearSystemsAnalysis;@Cohen1997ParametricAnalysisfMRI], two-gamma functions with\\ndifferent HRF parameters [@Glover1999DeconvolutionImpulseResponse], Poisson functions\\n[@Friston1994AnalysisfunctionalMRI]. and Gaussian functions\\n[@Kruggel1999Modelinghemodynamicresponse;@Rajapakse1998Modelinghemodynamicresponse].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"10c07d2f-89d2-4bf5-b56b-e8d22130aafc":{"__data__":"{\"id_\":\"10c07d2f-89d2-4bf5-b56b-e8d22130aafc\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"88878f1c-c20d-45ad-9616-fd477154020d\",\"metadata\":{},\"hash\":\"A4mXRfT05bFYDjstR1t/TRpIP/b8BYsSiHFU6c/iecc=\"}},\"hash\":\"Wptt0QcU5JSJ4ulTnh3AZYkGfo7QaoPQklnAt82xZ8o=\",\"text\":\"## Noise in BOLD fMRI\\n\\nIn addition to neuronal-related activity, the BOLD signal presents multiple sources of noise related to hardware-related\\nartifacts and drifts, head motion, confounding physiological fluctuations\\n[@Bianciardi2009Sourcesfunctionalmagnetic;@Jorge2013SignalfluctuationsfMRI] as well as image distortions related to data\\nacquisition that should be accounted for and corrected during fMRI data preprocessing.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b1d18526-be1f-4ec2-9bea-29eb1b9c3f1f":{"__data__":"{\"id_\":\"b1d18526-be1f-4ec2-9bea-29eb1b9c3f1f\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"11517fea-0ea1-488a-930c-07cb26d2d9f3\",\"metadata\":{},\"hash\":\"G965XY/zyZD9yS9BkggiYlqFseknWQWG+LlKkmHhnWs=\"},\"NEXT\":{\"nodeId\":\"b4a30af8-8668-40a6-9b86-6b3c8fc425a7\",\"metadata\":{},\"hash\":\"E1VuP+t47Glpw8u3CqsPlXvVz1uvPhXHBqQuxMROS34=\"}},\"hash\":\"cU9WSyYCixA+cc132o/XIvpOkstkKBFJA8byyfWNag0=\",\"text\":\"### Motion and Other Artifacts\\n\\nFor instance, the images could present geometric distortions in the phase direction of the acquisition that can be\\nremoved by means of mapping field distorsions, either using field maps or using two images acquired in opposite\\nphase-encoding directions, and then with a non-linear transformation of the fMRI volumes (e.g. TOPUP,\\n[@Andersson2003Howcorrectsusceptibility;@Glasser2018UsingtemporalICA]). Also, fMRI images are typically acquired slice\\nby slice and the difference in their time of acquisition can be compensated via slice timing correction, although this\\nstep can also introduce confounding effects in the data due to signal interpolation [@Parker2019BenefitSliceTiming]. More generally, realigning all fMRI volume to a reference image can deal with part of the artifacts introduced by head\\nmotion [@Friston1994Statisticalparametricmaps]. However, this step does not remove the effect of motion completely\\n[@CaballeroGaudes2017MethodscleaningBOLD]. The most straight-forward way to deal with signal artifacts is to model them as regressors of non-interest along with\\nthe task regressors (in tIA-fMRI) or to project them out of the fMRI data if there is no task paradigm, as in\\nresting-state (RS) experiments. For instance, motion-related effects can be expressed as a set of the relative\\ntranslations and rotation obtained during realignment, considering their first derivative and their squared\\ntransformation for up to 24 regressors for a better denoising [@Friston1994Statisticalparametricmaps]. Similarly, very\\nlow frequency trends due to hardware-related inestabilities can be modelled as a set of basis functions (e.g. using\\nLegendre polynomials, Discrete Cosine Transform). Furthermore, large deviations in the fMRI signal (e.g., spikes) caused by motion jerks and scanner noise can be removed\\nthrough scrubbing or censoring [@Power2012Spurioussystematiccorrelations]. This process consists in identifying those\\nfMRI volumes characterized by abrupt changes in the BOLD signal and removing or interpolating them. The identification\\ncan be performed by using summary metrics of motion, like Framewise Displacement\\n[@Power2012Spurioussystematiccorrelations], or by observing transient changes in the signal (DVARS,\\n@Power2012Spurioussystematiccorrelations;@Smyser2010LongitudinalAnalysisNeural). However, it is important to notice\\nthat, if correctly accounted for, scrubbing could reduce the degrees of freedom in statistical analysis\\n[@Mascali2021Evaluationdenoisingstrategies], leading to biases in second-level analysis between subjects that move too\\nmuch and others, or introduce discontinuity in the signal itself, limiting the use of particular analyses dependent on\\nsignal continuity (e.g. ICA, see @CaballeroGaudes2017MethodscleaningBOLD), and biasing the estimation of functional\\nconnectivity [@Mascali2021Evaluationdenoisingstrategies]. Moreover, interpolating the signal could introduce spurious\\nchanges in the signal. Another common approach to remove not only motion, but also other sources of noise, is based on data decomposition\\ntechniques. For instance, ICA can be leveraged to model, identify and remove motion artifacts as well as other sources\\nof noise\\n[@Behzadi2007componentbasednoise;@Griffanti2014ICAbasedartefact;@Muschelli2014Reductionmotionrelated;@Pruim2015ICAAROMArobust;@Pruim2015EvaluationICAAROMA;@SalimiKhorshidi2014Automaticdenoisingfunctional]. Ideally, the best candidate to identify noisy timeseries would be temporal ICA, i.e., a decomposition in which the\\nindependence is forced in the temporal domain [@Glasser2018UsingtemporalICA;@Smith2012Temporallyindependentfunctional]. However, such approach is not feasible in a normal fMRI context since it would require the samples in time to be much\\nhigher than the samples in space [@Smith2012Temporallyindependentfunctional]. Hence, spatial ICA is the most common\\napplication for fMRI decomposition, although this might lead to detect spurious components that contain both true BOLD\\nsignal and noise [@CaballeroGaudes2017MethodscleaningBOLD]. Alternatively, several fMRI sessions could be concatenated\\nto apply temporal ICA, although this approach would lead to the impossibility of removing session-specific noise. The\\nchallenging factor in adopting ICA for denoising is the classification of the independent components.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b4a30af8-8668-40a6-9b86-6b3c8fc425a7":{"__data__":"{\"id_\":\"b4a30af8-8668-40a6-9b86-6b3c8fc425a7\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"11517fea-0ea1-488a-930c-07cb26d2d9f3\",\"metadata\":{},\"hash\":\"G965XY/zyZD9yS9BkggiYlqFseknWQWG+LlKkmHhnWs=\"},\"PREVIOUS\":{\"nodeId\":\"b1d18526-be1f-4ec2-9bea-29eb1b9c3f1f\",\"metadata\":{},\"hash\":\"cU9WSyYCixA+cc132o/XIvpOkstkKBFJA8byyfWNag0=\"},\"NEXT\":{\"nodeId\":\"60a5fd28-aa6b-4402-81d2-a6edcd79ef82\",\"metadata\":{},\"hash\":\"4yHjXAngTlXj++zu9ubBXBsXpszgwonq4hpOne81E1A=\"}},\"hash\":\"E1VuP+t47Glpw8u3CqsPlXvVz1uvPhXHBqQuxMROS34=\",\"text\":\"Although manual\\nclassification is still the approach with the best outcome [@Griffanti2017HandclassificationfMRI], it is time consuming,\\nit requires trained researchers, and the result is dependent on the observer. For this reason, different approaches for\\nautomatic classification of ICA components have been proposed in time, from full classifiers (FIX,\\n@SalimiKhorshidi2014Automaticdenoisingfunctional) to approaches specifically targeting motion artifacts (ICA-AROMA,\\n@Pruim2015ICAAROMArobust;@Pruim2015EvaluationICAAROMA). Alternatively, decomposing the signal of white matter (WM) and cerebrospinal fluid (CSF) into principal components and\\nconsidering the first few (a technique called anatomical CompCor, see @Behzadi2007componentbasednoise) can help\\nretrieving proxies of motion-related artifacts and physiological fluctuations\\n[@Behzadi2007componentbasednoise;@Muschelli2014Reductionmotionrelated]. In fact, it has been shown that CompCor can be\\nmore effective in denoising motion artifacts than ICA based techniques and censoring\\n[@Mascali2021Evaluationdenoisingstrategies]. Noise in fMRI can also be reduced by using multi-echo (ME) acquisitions that sample the data at multiple successive echo\\ntimes (TE). A weighted combination of the multiple echoes based on each voxel's $T_2^*$ value\\n[@Posse1999EnhancementBOLDcontrast] or temporal signal-to-noise ratio [@Poser2006BOLDcontrastsensitivity] can smear\\nout random noise and enhance the sensitivity to the BOLD contrast. In fact, compared with single-echo data, this optimal\\ncombination [@Liu2022geometricviewsignal] can improve the mapping of neuronal activity at 3T\\n[@Fernandez2017MultiechoEPI] and 7T [@Puckett2018Usingmultiecho], with results comparable to other preprocessing\\ntechniques requiring extra data such as RETROICOR [@Atwi2018AttentionRelatedBrain]. Optimal combination of multiple echo\\nvolumes can also improve sensitivity, specificity, repeatability and reliability of fMRI mapping\\n[@Cohen2021ImprovingBreathHolding;@Cohen2019ImprovingAssessmentBreath]. Furthermore, assuming a monoexponential decay, the voxelwise fMRI signal acquired at a given echo time TE, i.e. $S(TE)$,\\ncan be expressed in signal percentage change as:\\n\\n```{math}\\n\\\\frac{S(TE)-\\\\overline{S}(TE)}{\\\\overline{S}(TE)}\\\\approx \\\\Delta \\\\rho - \\\\text{TE} \\\\cdot \\\\Delta R_2^* + n,\\n```\\n\\nwhere $\\\\overline{S}(TE)$ is the average signal at a given TE, $\\\\Delta \\\\rho$ represents non-BOLD related changes in the\\nnet magnetisation, $\\\\Delta R_2^*$ represents BOLD-related susceptibility changes (and is the inverse of $\\\\Delta T_2^*$),\\nand $n$ denotes random noise [@Kundu2013Integratedstrategyimproving;@Kundu2012DifferentiatingBOLDnon]. As the\\nBOLD-related signal can be expressed as a function of the TE, whereas noise-related (i.e., non-BOLD) changes in the net\\nmagnetization are independent of TE, the information available in multiple echoes can be leveraged for the purpose of\\ndenoising. For example, in a dual-echo acquisition where the first TE is suficiently short, the first echo signal mainly\\ncaptures changes in $\\\\Delta \\\\rho$ rather than in $\\\\Delta R_2^*$. It is then possible to remove artifactual effects,\\nthrough voxelwise regression, from the second echo signal acquired at a longer TE with appropriate BOLD contrast\\n[@Bright2013Removingmotionphysiological]. Collecting more echoes opens up the possibility to leverage ICA and automatically classifying independent components\\ninto BOLD-related (i.e., describing $\\\\Delta R_2^*$ fluctuations with a linear TE-dependency) or noise (i.e., independent\\nof TE, related to non-BOLD fluctuations in the net magnetization $\\\\Delta \\\\rho$), an approach known as ME independent\\ncomponent analysis (ME-ICA,\\n@Kundu2013Integratedstrategyimproving;@Kundu2012DifferentiatingBOLDnon;@Kundu2017MultiechofMRI).\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"60a5fd28-aa6b-4402-81d2-a6edcd79ef82":{"__data__":"{\"id_\":\"60a5fd28-aa6b-4402-81d2-a6edcd79ef82\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"11517fea-0ea1-488a-930c-07cb26d2d9f3\",\"metadata\":{},\"hash\":\"G965XY/zyZD9yS9BkggiYlqFseknWQWG+LlKkmHhnWs=\"},\"PREVIOUS\":{\"nodeId\":\"b4a30af8-8668-40a6-9b86-6b3c8fc425a7\",\"metadata\":{},\"hash\":\"E1VuP+t47Glpw8u3CqsPlXvVz1uvPhXHBqQuxMROS34=\"}},\"hash\":\"4yHjXAngTlXj++zu9ubBXBsXpszgwonq4hpOne81E1A=\",\"text\":\"Compared to single-echo\\ndata denoising, MEICA can improve the mapping of task-induced activation\\n[@DuPre2021TEdependentanalysis;@GonzalezCastillo2016Evaluationmultiecho;@Lombardo2016Improvingeffectsize], for example\\nin challenging paradigms with slow-varying stimuli [@Evans2015SeparatingslowBOLD] or language mapping and laterality\\n[@Amemiya2018Integratedmultiecho]. It also outperforms single-echo ICA-based denoising of resting-state fMRI data\\n[@Dipasquale2017Comparingrestingstate;@Lynch2020RapidPrecisionFunctional], and provide more effcient and reliable\\nfunctional connectivity mapping in individual subjects [@Lynch2020RapidPrecisionFunctional] and in brain regions where\\ntraditional single-echo acquisitions offer reduced signal-to-noise ratio, such as the basal forebrain\\n[@Markello2018Segregationhumanbasal]. Finally, ME-ICA also enhances the deconvolution of neuronal-related signal changes\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e6b2391a-61e4-4635-9d23-7f10f088efcf":{"__data__":"{\"id_\":\"e6b2391a-61e4-4635-9d23-7f10f088efcf\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"6456cac7-d020-4530-8668-55199c1f3302\",\"metadata\":{},\"hash\":\"AdWb7hI9ATZRUAaYeTihaDh+pIPcX07dorCuJjXwJ7o=\"},\"NEXT\":{\"nodeId\":\"e516b64b-199c-48df-80f8-76cfb0171260\",\"metadata\":{},\"hash\":\"gcW4sahUabgonWofUBcPyRjEvRicCsb2E0N3n99g0wk=\"}},\"hash\":\"lp2ehRhubfEMHbTI1ujYH4GUYAi7BSLWYCYHrchk+yc=\",\"text\":\"### Physiological Artifacts\\n\\nWhen employing BOLD fMRI as an intrinsic contrast to investigate neural correlates, it becomes essential to decouple the\\nneurovascular coupling. In this context, physiological signals may introduce noise, requiring their modeling to account\\nfor and minimize their associated variance during preprocessing or data analyses\\n[@CaballeroGaudes2017MethodscleaningBOLD;@Liu2016NoisecontributionsfMRI]. The principal frequencies characterising\\nphysiological signals like cardiac pulse and respiration are in a different band compared to those of the neural-related\\nBOLD signal: namely, the primary component of cardiac related fluctuations are around 1 Hz, while the respiratory\\nrelated ones are around 0.3 Hz. Thus, if the temporal sampling is high enough, a simple band-pass filter could easily\\nremove their confounding effects\\n[@Biswal1995Functionalconnectivitymotor;@Chuang2001IMPACTImagebased;@Lowe1998FunctionalConnectivitySingle]. The downside\\nis that this approach will remove the BOLD-related signal frequencies in the same range as well, and it will not remove\\nthe impact of physiological frequencies in the same range as the BOLD signal [@CaballeroGaudes2017MethodscleaningBOLD]. This is especially true if the temporal sampling is low and the physiological signal is aliased in the BOLD-related\\nfrequency range. Moreover, physiological signal, and respiration in particular, has an impact on other sources of noise,\\nlike magnetic field perturbation [@Raj2001Respiratoryeffectshuman], and motion\\n[@Fair2020Correctionrespiratoryartifacts;@PaisRoldan2018IdentifyingRespirationRelated;@Power2019Distinctionsrealapparent]\\nthat should be taken into account and removed [@Gratton2020Removalhighfrequency]. An easy way to remove such perturbations is to remove the average brain signal (also called global signal), since it is\\noften considered as a proxy of the combined impact of different sources of noise, especially related to movement or\\nphysiological in nature. However, its removal is controversial, since it can heavily alter the interpretation of BOLD\\nfMRI [@Power2017Sourcesimplicationswhole]. For this reason, @Power2018RiddingfMRIdata proposed to decompose fMRI data in\\nlow and high rank components, and to consider the first few low rank components timeseries as noise. This technique,\\ncalled GODEC, showed improved denoising of fMRI data after ME-ICA\\n[@Power2018RiddingfMRIdata;@Zhou2011GoDecRandomizedlow]. As an alternative, the average signal in the white matter (WM) and cerebrospinal fluid (CSF) can be used as a proxy of\\nphysiological noise, since no neural-related signal is present in these tissues, that are conversely dominated by\\ncardiac pulsatility and respiration [@Anderson2011Networkanticorrelationsglobal;@Jo2010Mappingsourcescorrelation],\\nalthough more recently @Attarpour2021Vascularoriginslow showed that the average CSF does not represent cardiac\\nfluctuations properly. Specifically, ICA based decomposition can be set up to retrieve physiological-related signals,\\nboth in space (CORSICA, @Perlbarg2007CORSICAcorrectionstructured) and in time (PESTICA,\\n@Beall2007Isolatingphysiologicnoise). An alternative to data-driven approaches consists in acquiring physiological signals such as cardiac pulse and\\nrespiration effort during the imaging session, opening up the possibility to adopt more model-based approaches to deal\\nwith physiological noise. For instance, it is possible to estimate the frequencies of the amplitude envelope of cardiac\\nand respiratory signals, and then selectively filter them from fMRI data\\n[@Biswal1996Reductionphysiologicalfluctuations]. However, the main frequency and the harmonics of physiological\\nfluctuations are usually aliased with the spectra of BOLD components with neurobiological relevance, and bandpass\\nfiltering would remove them as well. Alternatively, it is possible to use the measured cardiac and respiratory signals to model their pseudo-periodic\\nfluctuation that are phase-locked to the fMRI signal. Cardiac and respiratory phases can be estimated from signal\\nrecordings, then their Fourier expansion can be removed from the data in a slice-dependent manner at the beginning of\\nthe preprocessing, an approach known as RETROICOR, @Glover2000Imagebasedmethod. However, RETROICOR does not remove\\ncompletely the effect of physiological signal from the data, especially regional low frequency effects that vary between\\nbrain regions\\n[@Birn2006Separatingrespiratoryvariation;@Chang2009Influenceheartrate;@Shmueli2007Lowfrequencyfluctuations].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e516b64b-199c-48df-80f8-76cfb0171260":{"__data__":"{\"id_\":\"e516b64b-199c-48df-80f8-76cfb0171260\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"6456cac7-d020-4530-8668-55199c1f3302\",\"metadata\":{},\"hash\":\"AdWb7hI9ATZRUAaYeTihaDh+pIPcX07dorCuJjXwJ7o=\"},\"PREVIOUS\":{\"nodeId\":\"e6b2391a-61e4-4635-9d23-7f10f088efcf\",\"metadata\":{},\"hash\":\"lp2ehRhubfEMHbTI1ujYH4GUYAi7BSLWYCYHrchk+yc=\"}},\"hash\":\"gcW4sahUabgonWofUBcPyRjEvRicCsb2E0N3n99g0wk=\",\"text\":\"Noticeably, slow variations in the heart rate (HR, @Shmueli2007Lowfrequencyfluctuations) and the respiration volume per\\ntime (RVT, @Birn2006Separatingrespiratoryvariation) have been applied successfully to denoise BOLD signal from\\nphysiological fluctuations after RETROICOR, especially when convolved with a modelled response function, cardiac\\n[@Chang2009Influenceheartrate] or respiratory [@Birn2008respirationresponsefunction]. Various alternatives to RVT to\\nimprove breathing-related denoising have been proposed, either to simplify their calculation, that is normally based on\\nthe peak detection in the respiratory signal, or to improve the detection of particular changes in the respiratory\\nsignal. For instance, @Chang2009Relationshiprespirationend proposed to simply use the standard deviation of the\\nrespiratory signal, thus avoiding peak detection. @Power2018RiddingfMRIdata suggested to compute the standard deviation\\nof the respiratory envelope in small windows to be more susceptible to breathing changes. More recently,\\n@Harrison2021Hilbertbasedmethod showed that applying an Hilbert transform to compute RVT improves the characterisations\\nof breathing rhythms and the detection of deep breaths. Although the regions impacted by slow variations in cardiac rate\\nand breathing patterns frequently overlap\\n[@Chang2009Influenceheartrate;@Kassinopoulos2019Identificationphysiologicalresponse], HR and RVT regressor can be used\\ntogether for better performance [@Chang2009Influenceheartrate]. Another physiological confound related to RVT consists in spontaneous changes in arterial CO2, called poikilocapnia,\\nwhich act as a vasoactive process. These fluctuations have been corroborated with Transcranial Doppler ultrasound (TCD)\\nand induce low frequency fluctuations in the BOLD signal. If they are not accounted for, they can induce a bias in the\\nsignal estimation in up to a fifth of the cortex [@Wise2004Restingfluctuationsarterial]. The pattern of biases induced\\nby poikilocapnia has been found comparable to that of RVT [@Chang2009Relationshiprespirationend], although accounting\\nfor the latter is not suffcient to explain all the variability induced by the former [@Golestani2015Mappingendtidal]. However, the fact that BOLD signal is susceptible to CO2 fluctuations can be conversely seen as an advantage, and used\\nto image cerebral physiology\\n[@Pinto2021CerebrovascularReactivityMapping;@Zvolanek2023Comparingendtidal;@Moia2021ICAbaseddenoising].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"76c2ed76-a445-40aa-a230-8128e0b8ff96":{"__data__":"{\"id_\":\"76c2ed76-a445-40aa-a230-8128e0b8ff96\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9150c11d-0d60-4b76-8984-34a4cc87c677\",\"metadata\":{},\"hash\":\"7OZgTtfYP8i/7f8O7kzrNJ6HC71rCjmLILal67rxPkw=\"}},\"hash\":\"cr0AdIic3V2V9XNB6WGOYdaUKMLPAW0q6T4ydC+ksZU=\",\"text\":\"## fMRI Data Analysis\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"66e5e9bc-0bad-40a4-8fc6-08288a308178":{"__data__":"{\"id_\":\"66e5e9bc-0bad-40a4-8fc6-08288a308178\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"a0c3661f-9ce5-4b9f-a512-2b961bd865eb\",\"metadata\":{},\"hash\":\"WLsyv6eY1c5WzQ338A/Cz6bonzeAmdj8ULj3eCZ+YdI=\"}},\"hash\":\"WFE23Ugr3QO4Jh/V9OxNxRRxLiucC3s1nXSOTGaIU/U=\",\"text\":\"### Task fMRI\\n\\nConventionally, the analysis of task fMRI data consists of solving a generalized liner model (GLM) analysis. Since\\nresearchers have access to the timings of the stimuli, it is possible to model the expected BOLD response to the stimuli\\nand then fit the model to the data. For instance, the onsets of the expected neuronal activity for a given condition can\\nbe modeled as an indicator function $p(t)$ (e.g., Dirac functions for event-related designs, or box-car functions for\\nblock-designs) convolved with the HRF $h(t)$, sampled at the resolution of the TR\\n[@Friston2008DEMvariationaltreatment;@Friston1998EventRelatedfMRI;@Boynton1996LinearSystemsAnalysis;@Cohen1997ParametricAnalysisfMRI]:\\n\\n```{math}\\nx(t) = p \\\\times h(t) \\\\rightarrow x\\\\left[k\\\\right] = p \\\\times h(k \\\\cdot \\\\text{TR}). ```\\n\\nHence, the vector $\\\\mathbf{x} = \\\\left[x\\\\left[k\\\\right]\\\\right]_{k=1,\\\\dots,N} \\\\in \\\\mathbb{R}^N $ represents the regressor\\nthat models the hypothetical BOLD response for an experimental condition. Then, different regressors either modeling\\nconditions of interest or signals of non interest (e.g., noise-related signals) can be added as the columns of the\\ndesign matrix $\\\\mathbf{X} = \\\\left[\\\\mathbf{x}_1, \\\\dots, \\\\mathbf{x}_L\\\\right] \\\\in \\\\mathbb{R}^{N\\\\times L}$, where $L$ is the\\nnumber of regressors, which leads to the well-known GLM equation:\\n\\n```{math}\\n\\\\mathbf{y} = \\\\mathbf{X} \\\\mathbf{\\\\beta} + \\\\mathbf{\\\\epsilon},\\n```\\n\\nwhere the voxel timecourse $\\\\mathbf{y} \\\\in \\\\mathbb{R}^N$ is explained by a linear combination of the regressors in\\n$\\\\mathbf{X}$, weighted by the regression coefficients $\\\\mathbf{\\\\beta} \\\\in \\\\mathbb{R}^L$, and the residual error or noise\\n$\\\\mathbf{\\\\epsilon} \\\\in \\\\mathbb{R}^N$. The GLM can be solved using ordinary least squares (OLS) under the assumption that\\nthe noise is independent and identically distributed (i.i.d. ) Gaussian. Hence, the estimates of neuronal activity\\ncorresponding to the task conditions are obtained minimizing the residual sum of squares between the fitted model and\\nthe measured voxel timecourse. Usually, the number of regressors is much smaller than the number of samples, and thus\\nthe GLM is an overdetermined problem. In this case, the solution can be obtained without the need for additional\\nconstraints or assumptions [@Henson2007CHAPTER14Convolution]. It is important to note that the GLM only provides\\nestimates of the neuronal activity associated with the timings of the modelled stimuli.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"9253dc89-38a7-493a-9461-10cb50a43451":{"__data__":"{\"id_\":\"9253dc89-38a7-493a-9461-10cb50a43451\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ce912796-13ae-44a4-94de-699e3bea3feb\",\"metadata\":{},\"hash\":\"Wt2aUfNM1uFCLtPxdwGT8T2Sd9IDXs7k2t/EDoLlUqQ=\"},\"NEXT\":{\"nodeId\":\"297c9920-6931-47bd-aafa-bce3f494b7d3\",\"metadata\":{},\"hash\":\"aCF0/ER1RhQGeFsPNzN8pxX/GgWu7Pdg6l2b7E3C4vQ=\"}},\"hash\":\"HiIlQBc0LXPklCFv5Y1T/O9Z05Ntru21FUB1opazXrM=\",\"text\":\"### Resting-State fMRI\\n\\nConversely, fMRI data analysis in unconstrained conditions such as when subjects lying still in the scanner without\\nperforming any specific task, i.e. in resting-state, poses a challenge for the application of GLM-based approaches due\\nto the absence of an experimental paradigm that can be used to model the expected BOLD response. Given the increasing\\npopularity of resting-state fMRI in the past decade, various data-driven approaches have emerged to address the analysis\\nof this type of data. Seed correlation analysis is widely recognized as the predominant approach for examining resting-state fMRI data due to\\nits frequent utilization in the computation of functional connectivity (FC) patterns. It involves measuring the pairwise\\nPearson correlation between the timecourse of different voxels or regions of the brain, presenting the brain's\\ninterregional connections or edges in the form of a FC matrix. Each edge in the matrix represents the strength or\\nintensity of the functional connectivity between two regions. In fact, FC has been extensively utilized to investigate\\nthe arrangement of large-scale brain networks\\n[@Salvador2005NeurophysiologicalArchitectureFunctional;@Yeo2011organizationhumancerebral;@Margulies2016Situatingdefaultmode],\\nas well as to partition smaller brain structures like the thalamus and striatum\\n[@Martino2008FunctionalConnectivityHuman;@Yuan2015Functionaltopographythalamocortical;@Tian2020Topographicorganizationhuman]. Notably, FC exhibits subject-specific variations to such an extent that it can serve as a means of individual\\nidentification within a diverse population. Numerous studies have demonstrated the presence of distinct and reliable\\nsubject-specific features, commonly referred to as \\\"fingerprints,\\\" within the FC matrix\\n[@MirandaDominguez2014ConnectotypingModelBased;@Finn2015Functionalconnectomefingerprinting;@Finn2017Canbrainstate;@Vanderwal2017Individualdifferencesfunctional;@Waller2017Evaluatingreplicabilityspecificity;@Amico2018questidentifiabilityhuman;@PenaGomez2017SpatiotemporalNetworkMarkers;@Horien2019individualfunctionalconnectome;@Jalbrzikowski2020Functionalconnectomefingerprinting;@Jo2021Subjectidentificationusing]. In fact, these fingerprints have been associated with predictive insights into cognition\\n[@Cole2012GlobalConnectivityPrefrontal;@Rosenberg2015neuromarkersustainedattention;@Yamashita2018predictionmodelworking;@Fong2019Dynamicfunctionalconnectivity;@Rosenberg2020Functionalconnectivitypredicts;@Sripada2019Predictionneurocognitionyouth],\\npersonality traits\\n[@Adelstein2011PersonalityIsReflected;@Hsu2018Restingstatefunctional;@Nostro2018Predictingpersonalitynetwork;@Dubois2018RestingStateFunctional],\\nage\\n[@Dosenbach2010PredictionIndividualBrain;@Cabral2017Cognitiveperformancehealthy;@Liem2017Predictingbrainage;@Nielsen2018EvaluatingPredictionBrain],\\nand disease phenotype\\n[@Lynall2010FunctionalConnectivityBrain;@Plitt2015Restingstatefunctional;@Emerson2017Functionalneuroimaginghigh;@Lake2019FunctionalBrainOrganization;@Svaldi2021Optimizingdifferentialidentifiability]. Functional connectivity patterns offer a valuable insight into the connectivity among brain regions over a timecourse of\\ndata. However, they only provide a single snapshot and do not capture how this connectivity evolves over time, thereby\\nneglecting the dynamics of functional connectivity. [@Allen2012TrackingWholeBrain;@Di2020Intersubjectconsistentdynamic;@Hutchison2013Dynamicfunctionalconnectivity]. Dynamic\\nfunctional connectivity (dFC) in resting-state is commonly investigated using sliding-window approaches\\n[@Allen2012TrackingWholeBrain;@Hutchison2013Dynamicfunctionalconnectivity;@Preti2017dynamicfunctionalconnectome;@Lurie2020Questionscontroversiesstudy]. A sliding-window FC analysis yields a series of time-varying matrices, which are often effectively condensed into a few\\ndistinct brain states using clustering techniques [@Hutchison2013Dynamicfunctionalconnectivity]. In particular, it has\\nbeen shown that dFC correlates with underlying neural activity\\n[@Tagliazucchi2012Criticalitylargescale;@Thompson2013Neuralcorrelatestime;@Keilholz2014NeuralBasisTime] and behavior\\n[@Liegeois2019Restingbraindynamics].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"297c9920-6931-47bd-aafa-bce3f494b7d3":{"__data__":"{\"id_\":\"297c9920-6931-47bd-aafa-bce3f494b7d3\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ce912796-13ae-44a4-94de-699e3bea3feb\",\"metadata\":{},\"hash\":\"Wt2aUfNM1uFCLtPxdwGT8T2Sd9IDXs7k2t/EDoLlUqQ=\"},\"PREVIOUS\":{\"nodeId\":\"9253dc89-38a7-493a-9461-10cb50a43451\",\"metadata\":{},\"hash\":\"HiIlQBc0LXPklCFv5Y1T/O9Z05Ntru21FUB1opazXrM=\"},\"NEXT\":{\"nodeId\":\"339b20d8-240c-4cd4-94e9-1e08b1f4d682\",\"metadata\":{},\"hash\":\"57Nj5MIzUEvP+QX84grkBbWMTs3N0XV2QFTnmlw65MQ=\"}},\"hash\":\"aCF0/ER1RhQGeFsPNzN8pxX/GgWu7Pdg6l2b7E3C4vQ=\",\"text\":\"Furthermore, studies have demonstrated that dynamic connectivity fluctuations\\nexhibit lower variability between regions within the same functional networks, while showing higher variability between\\nregions from different networks [@Fu2017AssociationsFunctionalConnectivity]. This pattern results in an overall negative\\ncorrelation with stationary functional connectivity\\n[@Thompson2015meanvariancerelationshipreveals;@Zhang2018Testretestreliability]. However, due to the unconstrained nature\\nof resting-state fMRI, it becomes challenging to ascertain the functional significance of the obtained dynamic\\nconnectivity estimates versus their potential derivation from noise [@Lindquist2014Evaluatingdynamicbivariate]. Recently, researchers have also explored dynamic connectivity in the context of participants exposed to complex stimuli,\\nsuch as movie clips [@Di2020Intersubjectconsistentdynamic]. The utilization of movie stimuli offers the advantage of\\ncomparing the time course of dynamic connectivity across participants. If there is a high degree of inter-individual\\nsimilarity [@Hasson2004IntersubjectSynchronizationCortical;@Nastase2019Measuringsharedresponses], it may suggest that\\nthe observed dynamics of brain patterns is functionally meaningful and relevant to stimulus processing. In addition, ongoing developments in the field of dFC methods allow for their operation within individual timeframes. One such method is the use of instantaneous phase synchrony (PS), which provides a reliable measure of connectivity with\\nmaximal temporal resolution, comparable to correlation-based methods. Comparing these patterns over time can be achieved\\nby calculating the percentage of time points that exhibit significant phase synchronization throughout the entire\\nscanning duration [@Glerean2012FunctionalMagneticResonance]. Alternatively, the leading eigenvectors can be studied for\\nthis purpose [@Cabral2017Cognitiveperformancehealthy]. Another approach involves employing wavelet transform coherence\\nto explore nonstationary changes in the coupling between fMRI time series. This method calculates coherence and phase\\nlag between two time series as a function of both time and frequency. The selected time series could be either seed\\ntimecourses [@Chang2010Timefrequencydynamicsresting] or timecourses of an ICA [@Yaesoubi2015Dynamiccoherenceanalysis]. Similar to the sliding window approach, temporal dynamics can be identified through the application of clustering\\nalgorithms (e.g. k-means) [@Yaesoubi2015Dynamiccoherenceanalysis;@Cabral2017Cognitiveperformancehealthy]. Another alternative method for analyzing single timeframe resting-state fMRI data involves investigating co-activation\\npatterns (CAP)\\n[@Tagliazucchi2012Criticalitylargescale;@Liu2013Decompositionspontaneousbrain;@Chen2015Introducingcoactivation;@Liu2018Coactivationpatterns]. Unlike the phase synchrony approach, CAP analyses focus on identifying simultaneous occurrences of BOLD signal peaks or\\ntroughs in different brain regions, disregarding the phase of the signal, assuming that the relationship between the\\nBOLD signal and neural activity is attributed to these brief, transient and sparse co-activation events\\n[@Zhang2020relationshipBOLDneural]. Typically, CAP analyses employs k-means clustering to group the identified events\\ninto distinct CAPs, enabling the identification of temporal dynamics that can potentially be compared to other\\ntime-varying resting-state methods such as sliding-window correlation in dFC and PS. Still, the basic approach in CAPs\\nuses the fMRI signal as its input, which is thus subject to the temporal blurring of the hemodynamic response. This\\nphenomenon could lead to the simultaneous co-activation of multiple regions, despite their distinct initial onsets,\\npotentially indicating their association with different components [@Rangaprakash2018Hemodynamicresponsefunction]. In\\nother words, due to temporal variations in the the hemodynamic response, the BOLD signals of several brain regions might\\nexhibit simultaneous peaks despite the fact that their underlying neuronal activity might have different timings. To address this potential ambiguity, these neuronal-related events can also be identified by means of hemodynamic\\ndeconvolution approaches that remove the blurring effect of the hemodynamic response from the time series\\n[@Gaudes2013Paradigmfreemapping;@Karahanoglu2013TotalactivationfMRI;@Petridou2013PeriodsrestfMRI]. Hemodynamic\\ndeconvolution is commonly used in investigating psychophysiologic interactions (PPI) within task-based functional\\nconnectivity studies [@Gerchen2014Analyzingtaskdependent;@Gitelman2003Modelingregionalpsychophysiologic] as well as in\\nresting-state fMRI [@Di2015Characterizationsrestingstate].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"339b20d8-240c-4cd4-94e9-1e08b1f4d682":{"__data__":"{\"id_\":\"339b20d8-240c-4cd4-94e9-1e08b1f4d682\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ce912796-13ae-44a4-94de-699e3bea3feb\",\"metadata\":{},\"hash\":\"Wt2aUfNM1uFCLtPxdwGT8T2Sd9IDXs7k2t/EDoLlUqQ=\"},\"PREVIOUS\":{\"nodeId\":\"297c9920-6931-47bd-aafa-bce3f494b7d3\",\"metadata\":{},\"hash\":\"aCF0/ER1RhQGeFsPNzN8pxX/GgWu7Pdg6l2b7E3C4vQ=\"},\"NEXT\":{\"nodeId\":\"9e3d0a52-d6d8-4e01-90ea-d9dc7e3b677e\",\"metadata\":{},\"hash\":\"hhZRpu+TR+4CBdSkGEYzJdlf7hpKQTFr/0of3e3OT5w=\"}},\"hash\":\"57Nj5MIzUEvP+QX84grkBbWMTs3N0XV2QFTnmlw65MQ=\",\"text\":\"Recent deconvolution techniques, in contrast to classical PPI\\nanalysis, employ sparsity-promoting estimators that assume the dynamics of spontaneous brain activity can be\\ncharacterized by sparse BOLD events\\n[@Gaudes2013Paradigmfreemapping;@Karahanoglu2013TotalactivationfMRI;@Petridou2013PeriodsrestfMRI;@Urunuela2023HemodynamicDeconvolutionDemystified]. These approaches are akin to methods using point process analysis to examine sparse BOLD events\\n[@Tagliazucchi2012Criticalitylargescale], and will be the focus of this thesis as introduced in the next section. Mixing the ideas of hemodynamic deconvolution and co-activation patterns, @Karahanoglu2015Transientbrainactivity\\nproposed a new approach named innovation-driven co-activation patterns (iCAPs) that is based in transients (i.e. innovations) of the fMRI signal, rather than its peaks. This technique employs the hemodynamic deconvolution algorithm\\nof Total Activation [@Karahanoglu2013TotalactivationfMRI] to estimate the underlying neural activity prior to applying\\nthe CAP analysis, and therefore encode information about transient changes in the signals originating the BOLD\\ntimecourses. Evidence from the study conducted by @Karahanoglu2015Transientbrainactivity using the framework revealed\\nthat well-known resting-state networks, including the default mode network, can be subdivided into multiple subsystems\\nwith distinct temporal dynamics. This suggests the existence of functionally diverse subnetworks within these networks. Furthermore, by backprojecting iCAPs to deconvolved fMRI volumes, it becomes possible to reconstruct iCAP time courses\\nand assess temporal overlaps between different patterns [@Zoller2019RobustRecoveryTemporal]. Notably, it has been\\nobserved that, on average, 3 to 4 iCAPs overlap in time, and the associated brain activity persists for 5-10 seconds. This finding may explain the necessity of using a window length of at least 20 seconds to obtain reliable inferences\\nwhen employing a sliding window approach [@Karahanoglu2015Transientbrainactivity;@Preti2017dynamicfunctionalconnectome]. Another way to investigate functional connectivity is by identifying quasi-periodic patterns (QPP) of connectivity,\\nwhich typically persist for approximately 20 seconds in humans. A repeated-template-averaging algorithm can be employed\\nto detect these patterns in spatiotemporal segments [@Majeed2011Spatiotemporaldynamicslow]. This approach involves\\niteratively computing sliding window correlations and averaging similar segments of BOLD timepoints until convergence is\\nachieved. As a result, a spatiotemporal averaged template of BOLD dynamics is obtained. Interestingly, these templates\\noften reveal patterns that reflect global signal fluctuations, representing the average time course of the BOLD signal\\nacross the entire brain [@Yousefi2018Quasiperiodicpatterns;@Bolt2022parsimoniousdescriptionglobal]. Furthermore, these\\nQPPs have been found to correlate with local infraslow neural activity [@Thompson2014Quasiperiodicpatterns]. The\\npredominant QPP typically exhibits a sequence characterized by a transition from strong activation of the default mode\\nnetwork (DMN) and deactivation of sensory and attention networks to the opposite state, with DMN deactivation and\\nactivation of sensory and attention networks [@Abbas2019Quasiperiodicpatterns;@Yousefi2021Propagatingpatternsintrinsic]. Finally, notice that when the FC strengh between two timecourses (i.e. the edges of the FC matrix) is measured as the\\npairwise Pearson's correlation, this can be exactly defined in terms of its frame-wise contributions. Therefore, instead\\nof detecting significant instances of FC change from voxel timecourses, these can be identified when multiple\\ntimecourses exhibit extreme signal changes simultaneously (i.e. co-activation)\\n[@Esfahlani2020Highamplitudecofluctuations;@Faskowitz2020Edgecentricfunctional]. These edge-centric FC (eFC) approach\\nhas recently gained notable popularity in brain imaging and neuroscience, showing that eFC offers large replicability,\\nstability within individuals across multiple scanning sessions, and reliability across datasets\\n[@Faskowitz2020Edgecentricfunctional]. Moreover, clustering the eFC has revealed overlapping brain communities that hold\\npromise for studying cognition and behavior beyond the limitations of traditional disjoint brain parcellations. However,\\nthe main findings of the edge-centric analyses can be derived from a node-centric FC perspective nFC (i.e., the\\ncommonly-used FC matrix) under a static null hypothesis that disregards temporal correlations\\n[@Novelli2022mathematicalperspectiveedge].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"9e3d0a52-d6d8-4e01-90ea-d9dc7e3b677e":{"__data__":"{\"id_\":\"9e3d0a52-d6d8-4e01-90ea-d9dc7e3b677e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ce912796-13ae-44a4-94de-699e3bea3feb\",\"metadata\":{},\"hash\":\"Wt2aUfNM1uFCLtPxdwGT8T2Sd9IDXs7k2t/EDoLlUqQ=\"},\"PREVIOUS\":{\"nodeId\":\"339b20d8-240c-4cd4-94e9-1e08b1f4d682\",\"metadata\":{},\"hash\":\"57Nj5MIzUEvP+QX84grkBbWMTs3N0XV2QFTnmlw65MQ=\"}},\"hash\":\"hhZRpu+TR+4CBdSkGEYzJdlf7hpKQTFr/0of3e3OT5w=\",\"text\":\"Consequently, the findings obtained with  eFC-based methods can be also\\napplied to nFC-based approaches, such as (i)CAPs or hemodynamic deconvolution, providing a similar set of volumes with\\nlarge co-activations are used for subsequent analyses.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"6259768d-82b4-4965-aa7c-0b4f4419ed8f":{"__data__":"{\"id_\":\"6259768d-82b4-4965-aa7c-0b4f4419ed8f\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"172ff61a-d812-4186-9d3b-9dab07312847\",\"metadata\":{},\"hash\":\"+H4bQsE30zXuenFj38TC5tFnDH+pwYfanMH2jvHLmIM=\"}},\"hash\":\"SESsDjofl56jKnAf0V+Nb2vCZaBTvZKnsFMFk1GpGrs=\",\"text\":\"## Introduction to the Chapters and Aim of the Studies\\n\\nThe aim of this thesis is to develop novel methods for the hemodynamic deconvolution of fMRI data and apply them in\\nresting-state, naturalistic paradigms, and clinical-based studies. In {ref}`Chapter 2 <cha-synthesis-analysis>` the theoretical background of hemodynamic deconvolution is presented with a\\nfocus on the two different mathematical formulations, i.e., analysis and synthesis, and the associated algorithms: Total\\nActivation and Paradigm Free Mapping. This chapter will aim to compare the two methods (that work at the individual\\nvoxel level), assess whether they are equivalent, and how they compare with Coactivation Pattern analysis. {ref}`Chapter 3 <cha-stability>` addresses the challenge of determining adequate regularization parameters for\\nhemodynamic deconvolution. The method of stability selection is proposed as a solution to circumvent the need for manual\\nparameter selection. Furthermore, a novel metric based on the area of the stability path is introduced that quantifies\\nthe likelihood of a neuronal-related event occurring at a specific voxel and timepoint. {ref}`Chapter 4 <cha-multivariate>` presents an extension of the hemodynamic deconvolution problem to a multivariate\\nformulation, which enables the identification of neuronal-related events that are shared across multiple voxels. The\\nmethod is presented and applied to single-echo and multi-echo fMRI data, employs the stability selection method\\nintroduced in {ref}`Chapter 3 <cha-stability>` for parameter selection, and is validated with a comparison with a\\ngeneralized linear model as the ground truth. Furthermore, the performance of this novel multivariate method is compared\\nwith its univariate counterpart, as well as with another semi-blind multivariate deconvolution technique that has been\\nproposed in the literature, named Hemolearn. Building upon this multivariate formulation, {ref}`Chapter 5 <cha-multi-subject>` introduces a novel method for the\\nsimultaneous identification of the neuronal-related events in multiple subjects. The technique is presented as a new\\ntool that allows for the analysis of naturalistic fMRI data at the finest spatial and temporal resolution, unlike other\\nmethods that have been proposed in the literature so far. The method is validated in simulated and real data, and its\\nperformance is corroborated by correlating the identified neuronal-related events with different features of the movies\\nthe subjects watched during the fMRI acquisition. A novel method, presented in {ref}`Chapter 6 <cha-low-rank>`, introduces a paradigm free mapping approach that\\neffectively identifies and decouples global fluctuations in the BOLD signal during the deconvolution process. Compensating for these global events during data preprocessing is challenging, and they can be mistakenly interpreted as\\nneuronally related due to their temporal signature closely resembling the assumed HRF in the deconvolution model. Hence,\\nthis decoupling is crucial for optimizing deconvolution approaches, as the estimation accuracy can be significantly\\ncompromised by widespread signal changes caused by head jerks, hardware artifacts, or non-neuronal physiological events\\n(e.g., deep breaths).The method is validated in simulated and real data, and its performance is compared with a GLM\\nanalysis as the ground truth. Finally,  summarizes the main findings of this thesis and outlines future directions for research.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"86f8346d-a1e3-4abb-beb0-107082bad295":{"__data__":"{\"id_\":\"86f8346d-a1e3-4abb-beb0-107082bad295\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"a1e58057-2f9d-4916-8ae1-a290d7d73ca1\",\"metadata\":{},\"hash\":\"yFzOZjQUXIyF+1s3hLtQrNN8zdM/9K0POrSePyZoyoA=\"}},\"hash\":\"19261UCes6rrV//qi9/GwMW8GdeERM7pV7VRRb7LzcI=\",\"text\":\"## List of Contributions\\n\\nPart of the work described in this thesis has been published in peer-reviewed journals and presented in conferences. The\\nfollowing list summarizes the main contributions of this thesis:\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"5e60d95f-077f-45bf-8e5f-491db98529ee":{"__data__":"{\"id_\":\"5e60d95f-077f-45bf-8e5f-491db98529ee\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"609657b3-39a5-460c-909b-82477537a95a\",\"metadata\":{},\"hash\":\"ihAH/5P2m1OP7+M7gJY4PAaV9SzDyPjzKVtd9r9fo0Q=\"}},\"hash\":\"iGCdtWsdJJMYXxJKwG04XxYR9jZd/1z2ENc92QWmj3k=\",\"text\":\"### Journal and Conference Articles\\n\\n- {ref}`Chapter 2 <cha-synthesis-analysis>`: [**Uruñuela, E.**, Bolton, T. A., Van De Ville, D., & Caballero-Gaudes, C. (2023). Hemodynamic Deconvolution Demystified: Sparsity-Driven Regularization at Work. *Aperture Neuro*, vol. 3,\\n  1-25.](https://doi.org/10.52294/001c.87574)\\n- {ref}`Chapter 3 <cha-stability>`: [**Uruñuela, E.**, Jones, S., Crawford, A., Shin, W., Oh, S., Lowe, M., &\\n  Caballero-Gaudes, C. (2020, July). Stability-Based Sparse Paradigm Free Mapping Algorithm for Deconvolution of\\n  Functional MRI Data. *In 2020 42nd Annual International Conference of the IEEE Engineering in Medicine & Biology\\n  Society (EMBC) (pp. 1092-1095).*](https://doi.org/10.1109/EMBC44109.2020.9176137)\\n- {ref}`Chapter 4 <cha-multivariate>`: [**Uruñuela, E.**, Gonzalez-Castillo, J., Zheng, C., Bandettini, P., &\\n  Caballero-Gaudes, C. (2023). Whole-Brain Multivariate Hemodynamic Deconvolution for fMRI with Stability Selection. *Medical Image Analysis*, 103010.](https://doi.org/10.1016/j.media.2023.103010)\\n- {ref}`Chapter 6 <cha-low-rank>`: [**Uruñuela, E.**, Moia, S., & Caballero-Gaudes, C. (2021, April). A Low Rank and\\n  Sparse Paradigm Free Mapping Algorithm for Deconvolution of fMRI Data. *In 2021 IEEE 18th International Symposium on\\n  Biomedical Imaging (ISBI) (pp. 1726-1729)*.](https://doi.org/10.1109/ISBI48211.2021.9433821)\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"6d73770a-507d-477c-a697-519a25302981":{"__data__":"{\"id_\":\"6d73770a-507d-477c-a697-519a25302981\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"3acb696b-79bb-46ea-b79a-9da78911a0a7\",\"metadata\":{},\"hash\":\"l+zojr7b2bbNXBxO2VJpkl/hK4M7Ilq8d/flCtAgusY=\"},\"NEXT\":{\"nodeId\":\"fa5f0894-8749-48c9-8720-f31b084ac597\",\"metadata\":{},\"hash\":\"LsVvWUU6XBUTLLzUkT1X3HS7tN8aZAzFYbHdZLK28jE=\"}},\"hash\":\"pbQ9z7SS9xqZLMa5QtuYDpCuVxwqzeq8o4Kg4Xb+sBM=\",\"text\":\"### Conference Abstracts\\n\\n- **Uruñuela, E.**, Sava-Segal, C., Leung, M., Finn, E.S., Caballero-Gaudes, C. A Multi-Subject Deconvolution Algorithm\\n  for the Analysis of Naturalistic fMRI Data. *3rd Annual meeting of the Iberian Chapter of the International Society of\\n  Magnetic Resonance in Medicine (2023)*, Valladolid, Spain. - **Uruñuela, E.**, Sava-Segal, C., Leung, M., Finn, E.S., Caballero-Gaudes, C. A Multi-Subject Deconvolution Algorithm\\n  for the Analysis of Naturalistic fMRI Data. *32nd Annual Meeting of the International Society of Magnetic Resonance in\\n  Medicine (2023)*, Toronto, Canada. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. A Multi-Echo Low-Rank and Sparse Method to Estimate Neuronal Signal\\n  with Less Global Signal Bias. *2nd Annual meeting of the Iberian Chapter of the International Society of Magnetic\\n  Resonance in Medicine (2022)*, Lisbon, Portugal. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. A Multi-Echo Low-Rank and Sparse Method to Estimate Neuronal Signal\\n  with Less Global Signal Bias. *28th Annual Meeting of the Organization for Human Brain Mapping (2022)*, Glasgow, UK. - **Uruñuela, E.**, Ferrer, V., Caballero-Gaudes, C. Blind Estimation of Neuronal-Related Activity in fMRI Informed by\\n  Co-Fluctuations of Brain Regions. *28th Annual Meeting of the Organization for Human Brain Mapping (2022)*, Glasgow,\\n  UK. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. A Multi-Echo Low-Rank and Sparse Algorithm That Reduces the Bias of\\n  Global Fluctuations on the Estimation of Neuronal Signal. *31st Annual Meeting of the International Society of\\n  Magnetic Resonance in Medicine (2022)*, London, UK. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. Synthesis-Based Paradigm Free Mapping and Analysis-Based Total\\n  Activation Operate Identically. *27th Annual Meeting of the Organization for Human Brain Mapping (2021)*, Virtual. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. Simultaneous Blind Estimation of Global Fluctuations and\\n  Neuronal-Related Activity from fMRI Data. *1st Annual meeting of the Iberian Chapter of the International Society of\\n  Magnetic Resonance in Medicine (2021)*, Virtual. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. Synthesis-Based Paradigm Free Mapping and Analysis-Based Total\\n  Activation Are Identical For Temporal Deconvolution of fMRI Data. *1st Annual meeting of the Iberian Chapter of the\\n  International Society of Magnetic Resonance in Medicine (2021)*, Virtual. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. fMRI deconvolution with Synthesis-Based Paradigm Free Mapping and\\n  Analysis-Based Total Activation Operate Identically. *30th Annual Meeting of the International Society of Magnetic\\n  Resonance in Medicine (2021)*, Virtual. - **Uruñuela, E.**, Moia, S., Caballero-Gaudes, C. Low-Rank and Sparse Simultaneous Blind Estimation of Global\\n  Fluctuations and Neuronal-Related Activity from fMRI Data. *30th Annual Meeting of the International Society of\\n  Magnetic Resonance in Medicine (2021)*, Virtual. - **Uruñuela, E.**, Jones, S., Crawford, A., Shin, W., Oh, S., Lowe, M., Caballero-Gaudes, C. Improving Deconvolution of\\n  fMRI Signal with Sparse Paradigm Free Mapping Using Stability Selection. *26th Annual Meeting of the Organization for\\n  Human Brain Mapping (2020)*, Virtual. - **Uruñuela, E.**, Moia, S., Gonzalez-Castillo, J., Caballero-Gaudes, C.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"fa5f0894-8749-48c9-8720-f31b084ac597":{"__data__":"{\"id_\":\"fa5f0894-8749-48c9-8720-f31b084ac597\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"3acb696b-79bb-46ea-b79a-9da78911a0a7\",\"metadata\":{},\"hash\":\"l+zojr7b2bbNXBxO2VJpkl/hK4M7Ilq8d/flCtAgusY=\"},\"PREVIOUS\":{\"nodeId\":\"6d73770a-507d-477c-a697-519a25302981\",\"metadata\":{},\"hash\":\"pbQ9z7SS9xqZLMa5QtuYDpCuVxwqzeq8o4Kg4Xb+sBM=\"}},\"hash\":\"LsVvWUU6XBUTLLzUkT1X3HS7tN8aZAzFYbHdZLK28jE=\",\"text\":\"Deconvolution of Multi-Echo Functional MRI\\n  Data with Multivariate Multi-Echo Sparse Paradigm Free Mapping. *27th Annual Meeting of the International Society of\\n  Magnetic Resonance in Medicine (2019)*, Montreal, Canada.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d88fcd2e-4532-4bb7-a9d5-9e1da3f3f4a6":{"__data__":"{\"id_\":\"d88fcd2e-4532-4bb7-a9d5-9e1da3f3f4a6\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d74ca71f-f0ac-41b2-850b-20766e5c7e73\",\"metadata\":{},\"hash\":\"gqL1pHsXgztO2L4FOmFb5VY7kvu3VPNjInfP7cCWuu4=\"}},\"hash\":\"VqbnADNJG4W4H8JrETgKw62GrjCgR6uC8eJxq0MHdv8=\",\"text\":\"# Chapter 6: Sparse and Low-Rank Paradigm Free Mapping\\n\\nThis chapter was published as @Urunuela2021LowRankSparse. Current deconvolution algorithms for functional magnetic resonance imaging (fMRI) data are hindered\\nby widespread signal changes arising from motion or physiological processes (e.g. deep breaths)\\nthat can be interpreted incorrectly as neuronal-related hemodynamic events. This work proposes a\\nnovel deconvolution approach that simultaneously estimates global signal fluctuations and\\nneuronal-related activity with no prior information about the timings of the blood oxygenation\\nlevel-dependent (BOLD) events by means of a sparse and low rank decomposition algorithm. The\\nperformance of the proposed method is evaluated on simulated and experimental fMRI data, and\\ncompared with state-of-the-art sparsity-based deconvolution approaches and with a conventional\\nanalysis that is aware of the temporal model of the neuronal-related activity. This chapter\\ndemonstrates that the novel sparse and low-rank paradigm free mapping (SPLORA-PFM) can estimate\\nglobal signal fluctuations related to motion in the task, while estimating the neuronal-related\\nactivity with high fidelity. The open-source Python package for SPLORA is available at\\nhttps://github.com/ParadigmFreeMapping/splora. (sec-low-rank-intro)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8fe76eea-6b37-4b5f-84b2-cc06479ef076":{"__data__":"{\"id_\":\"8fe76eea-6b37-4b5f-84b2-cc06479ef076\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"65241135-4f0e-4548-8196-eba27c46a6b2\",\"metadata\":{},\"hash\":\"fevngajSZM/DWD6kzLu/i8jPXr3ZYbdUNEDNhjFMfJk=\"}},\"hash\":\"81NlhjZPRKoXTxIEZKzijQKFEu4bZ2nPngs9EDym43E=\",\"text\":\"## Introduction\\n\\nAs noted in previous chapters of this thesis, hemodynamic deconvolution algorithms of functional\\nmagnetic resonance imaging (fMRI) data aim to estimate blood oxygenation level-dependent (BOLD)\\nevents with no prior knowledge of their timing. These algorithms can be specially useful when the\\ninformation about the timing of the neuronal activity that drives the BOLD events is unknown,\\ninaccurate or insufficient (e.g., resting-state, naturalistic paradigms, clinical conditions). However, the performance of existing deconvolution approaches can be hampered considerably in\\npresence of global, widespread signal changes due to head jerks, hardware artefacts or prominent\\nnon-neuronal physiological events (e.g., deep breaths) [@Power2017Sourcesimplicationswhole]. Signal\\nartefacts due to head motion and hardware malfunction can be reduced by means of denoising\\nalgorithms, such as ICA-AROMA [@Pruim2015ICAAROMArobust] or ME-ICA\\n[@Kundu2012DifferentiatingBOLDnon], or can be compensated with a multi-echo Paradigm Free Mapping\\nformulation [@CaballeroGaudes2019deconvolutionalgorithmmulti]. However, global physiological events\\nare more difficult to compensate during data preprocessing [@Power2018RiddingfMRIdata] and can be\\nmisinterpreted as neuronally related since their temporal signature can closely resemble the\\nhemodynamic response function (HRF) assumed in the deconvolution model to describe neurovascular\\ncoupling. This chapter proposes a new Paradigm Free Mapping algorithm for spatio-temporal deconvolution of\\nfMRI data that is capable of simultaneously estimating global signal fluctuations and\\nneuronal-related activity based on a sparse and low-rank decomposition approach. The proposed\\nalgorithm extends the formulation of the multivariate-sparse Paradigm Free Mapping (Mv-SPFM)\\nintroduced in  by using a regularized estimator consisting of the same\\nstructured sparsity promoting $\\\\ell_{2,1}+\\\\ell_1$ norm but adding a low-rank-promoting nuclear-norm\\n[@Otazo2015Lowrankplus]. (sec-low-rank-lrs-pfm)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"fb01430d-83f7-4cdc-9540-5ef54d8e64d5":{"__data__":"{\"id_\":\"fb01430d-83f7-4cdc-9540-5ef54d8e64d5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"bedb7d68-e124-4d58-ba20-4ecb33ae802e\",\"metadata\":{},\"hash\":\"wWRFpkGzzwMikbAuT0Pkrht06ixqre8cklW0t2989cQ=\"}},\"hash\":\"MRwTcxxlcvA7qzsiqdcVh2jJM544nZX3g8PClBDaZ7Q=\",\"text\":\"## Sparse and Low-Rank Paradigm Free Mapping\\n\\nLet us consider that the whole-brain fMRI data $\\\\mathbf{Y} \\\\in \\\\mathbb{R}^{N \\\\times V}$ where $N$\\nis the number of volumes and $V$ is the number of voxels of the acquisition can be decomposed into\\nthree terms, i.e.,\\n\\n```{math}\\n:label: eq-2\\n\\\\mathbf{Y} = \\\\mathbf{HS} + \\\\mathbf{L} + \\\\mathbf{N},\\n```\\n\\nwhere the neuronal-related component $\\\\mathbf{H}\\\\mathbf{S}$ is the convolution\\nof voxel-specific neuronal-related signals $\\\\mathbf{S}$ with the Toeplitz matrix\\n$\\\\mathbf{H} \\\\in \\\\mathbb{R}^{N \\\\times N}$ with shifted HRFs in its columns (i.e.\\\\\\nsimilar to the formulation used for multivariate Paradigm Free Mapping\\n@Urunuela2024Wholebrainmultivariate), the global fluctuations can be captured as the sum of $P$\\nspatially widespread (i.e.\\\\ global) low-rank components\\n$\\\\mathbf{L}=\\\\sum_{p=1}^{P}\\\\mathbf{v}_p\\\\mathbf{a}_p^T$ where $\\\\mathbf{v}_p \\\\in \\\\mathbb{R}^{N \\\\times\\n1}$ and $\\\\mathbf{a}_p \\\\in \\\\mathbb{R}^{V \\\\times 1}$ denote their corresponding spatial and temporal\\nsignatures, and $\\\\mathbf{N}$ represents additional white Gaussian noise. The following multivariate regularized least-squares problem is proposed to estimate both the\\nneuronal-related signals and the global components:\\n\\n```{math}\\n:label: eq-low-rank-inverse-problem\\n\\\\mathbf{\\\\hat{L}}, \\\\mathbf{\\\\hat{S}} = \\\\arg \\\\min_{\\\\mathbf{L}, \\\\mathbf{S}} \\\\| \\\\mathbf{Y} - \\\\mathbf{HS} - \\\\mathbf{L} \\\\|_F^2 + \\\\lambda_L \\\\| \\\\mathbf{L} \\\\|_* \\n+ (1 - \\\\rho) \\\\| \\\\mathbf{D}_S \\\\mathbf{S}  \\\\|_{2,1} + \\\\rho \\\\| \\\\mathbf{D}_S \\\\mathbf{S}  \\\\|_1,\\n```\\n\\nwhere $\\\\|\\\\cdot\\\\|_F$ denotes the Frobenious norm, the $\\\\ell_{2,1}$+$\\\\ell_{1}$-norm term enforces\\ntemporal sparsity and spatial structure on the estimate of the neuronal-related activity and $\\\\rho$\\ncontrols the tradeoff between both terms\\n[@Gramfort2011FunctionalBrainImaging;@Urunuela2024Wholebrainmultivariate] and\\n$\\\\mathbf{D}_s=\\\\text{diag}\\\\left(\\\\lambda_{S_1},\\\\ldots,\\\\lambda_{S_V} \\\\right)$ is a diagonal matrix\\nwith voxel-specific non-negative regularization parameters that balances the sparsity of\\n$\\\\mathbf{S}$ and data fidelity for each voxel. In addition, the nuclear-norm $\\\\|\\\\cdot\\\\|_*$\\nencourages the estimation of low-rank components where the non-negative regularization parameter\\n$\\\\lambda_L$ controls the number of low-rank components. Here, $\\\\rho$ is empirically set to 0.8 to enforce structure in the spatial domain and maintain the\\nsparsity of the estimates. For each voxel, $\\\\lambda_{S_i}$ is set equal to the median absolute\\ndeviation estimate  of the noise standard deviation from the fine-scale wavelet coefficients of the\\nvoxel time series (Daubechies, order 3). After the singular value decomposition (SVD) of the data,\\n$\\\\lambda_L$ is set to select $P$ low-rank components corresponding to the largest eigenvalues\\nshowing a difference of at least 10% with respect to the next eigenvalue. The optimization problem in Eq. %s is solved via monotone FISTA with\\nvariable acceleration (MFISTA-VA, @Zibetti2018MonotoneFISTAvariable) as shown in . ```{figure} figures/low_rank/algorithm.png\\n:align: center\\n:label: fig-algorithm\\n\\nPseudocode for Monotone FISTA with Variable Acceleration. ```\\n\\n(sec-low-rank-methods)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"55592220-4c75-4c08-98a9-4dae1d327ce9":{"__data__":"{\"id_\":\"55592220-4c75-4c08-98a9-4dae1d327ce9\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"6b581184-1c16-406c-8fab-e57806bae0de\",\"metadata\":{},\"hash\":\"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc=\"}},\"hash\":\"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=\",\"text\":\"## Methods\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"0d28db77-596c-4f87-a5d3-d37b03e9151b":{"__data__":"{\"id_\":\"0d28db77-596c-4f87-a5d3-d37b03e9151b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"a379b718-8880-4830-ac71-199281fa17fb\",\"metadata\":{},\"hash\":\"i9XX3zNVnM4m/Oq+0xBvg+ATC+DjmoUwSooEipBOrpc=\"}},\"hash\":\"yGssy9Li9JUoBbST/tOaUNLlJ2bq22x7dUZo2V5/Pqc=\",\"text\":\"### Simulated Data\\n\\n1000 voxels were simulated including two groups of 50 voxels with a known BOLD signal, whereas the\\nremaining voxels did not contain any BOLD signal. For each voxel, different signal sources\\nrepresenting motion-related, thermal and physiological noise were added following\\n[@Gaudes2013Paradigmfreemapping], as well as two global low-rank components (see\\n A) with a random voxelwise amplitude simulating widespread signal changes due\\nto two deep breaths [@Power2018RiddingfMRIdata] and large amplitude spikes mimicking spin-history\\nartefacts due to head jerks, respectively. The performance of the proposed SPLORA-PFM algorithm was asssesed on different signal to noise\\nratio (SNR) settings and with different ratios of voxels with BOLD signals to total number of\\nvoxels (denoted as BOLD/total voxels ratio). Four different algorithms based on\\nEq. %s were evaluated depending on the regularization parameters:\\n\\n1. SPFM with no low-rank estimation and no spatial regularization (SPFM, $\\\\rho=1$, $\\\\lambda_L=0$)\\n2. MV-SPFM with no low-rank estimation (MV-SPFM, $\\\\rho = 0.8$, $\\\\lambda_L=0$)\\n3. SPLORA-PFM algorithm with only the L1-norm (LR+SPFM, $\\\\rho=1$)\\n4. SPLORA-PFM algorithm ($\\\\rho = 0.8$)\\n\\nThese were benchmarked against the original univariate SPFM algorithm with regularization parameter\\nselected according to the Bayesian Information Criterion (SPFM-BIC,\\n@Gaudes2013Paradigmfreemapping). Note that both the SPFM algorithm with $\\\\rho=1$ and $\\\\lambda_L=0$\\nand the original SPFM-BIC algorithm operate voxelwise, except the regularization parameters are\\nchosen differently. True and false positive and negative values were calculated for the ROC values comparing the\\nestimated activity-inducing signal with the simulated (binary) activity-inducing signal (ground\\ntruth) as follows: a TR was deemed as a true positive (TP) when the estimated and simulated values\\nwere both non-zero; a TR was treated as true negative (TN) when both the estimated and simulated\\nvalues were zero; false positives (FP) were given to those TRs with a non-zero estimated value when\\nthe simulated value was zero; and false negatives (FN) were considered when the estimated value was\\nzero but the simulated value was non-zero. Sensitivity and specificity values were calculated as\\n$\\\\text{TP}/(\\\\text{TP}+\\\\text{FN})$ and $\\\\text{TN}/(\\\\text{TN}+\\\\text{FP})$ respectively.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"c5f9aefb-71c2-40a4-858c-6569f523ad35":{"__data__":"{\"id_\":\"c5f9aefb-71c2-40a4-858c-6569f523ad35\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ce132559-9550-4216-b03f-07591d2eb311\",\"metadata\":{},\"hash\":\"+YPuwIve5ulu3P8/zwh+r2WBME1jHDz6Dup99tQ1Uxk=\"}},\"hash\":\"daExK2tNswZrIPAlTdv9Iq9sTSS+Cs0X5bAgBAr/SxQ=\",\"text\":\"### Experimental Data\\n\\nNine healthy subjects were scanned in a 3T Siemens Prisma MR scanner in ten sessions at the same\\nhour and day of the week. T2*-weighted multi-echo fMRI data was collected with a multiband (MB)\\nmultiecho gradient echo planar imaging sequence (340 scans, 52 slices, Partial-Fourier=6/8, voxel\\nsize=2.4x2.4x3 mm\\\\textsuperscript{3}, TR=1.5 s, TEs=10.6/28.69/46.78/64.87/82.96 ms, flip\\nangle=70$^o$, MB factor=4, GRAPPA=2). During the fMRI acquisition, subjects performed a motor task\\nconsisting of five different movements (left-hand finger tapping, right-hand finger tapping, moving\\nthe left toes, moving the right toes and moving the tongue). These conditions were randomly\\nintermixed every 16 seconds, and were only repeated once the entire set of conditions were\\npresented. For this work, only the first two sessions were selected to evaluate the algorithm. Data preprocessing was carried out with AFNI [@Cox1996AFNISoftwareAnalysis] including volume\\nrealignment, optimally combining the echo time datasets with \\\\textit{tedana}\\n[@DuPre2021TEdependentanalysis], detrending of up to 5$^{th}$-order Legendre polynomials,\\nspatial smoothing with a Gaussian kernel of 3 mm Full Width Half Maximum, and normalization to\\nsignal percentage change. Based on the simulation results, preprocessed data was analyzed with the\\nnovel SPLORA-PFM algorithm with $\\\\rho = 0.8$, and $\\\\lambda_L$ and $\\\\mathbf{D}_S$ were selected as\\ndescribed in . (sec-low-rank-results)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"1763de92-30a2-4167-8c6a-54404f1eaedc":{"__data__":"{\"id_\":\"1763de92-30a2-4167-8c6a-54404f1eaedc\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"1ac47aff-ad6b-4a9d-810d-12eebcb92784\",\"metadata\":{},\"hash\":\"0hd4ZXlA175S2Ujsp2tpzg5jr5ePTIRHIQYq3T8fNcU=\"}},\"hash\":\"8eBF2O/6sD8iwbhW/aepUHo5fMZ3Vj52CKp9asygRaQ=\",\"text\":\"## Results and Discussion\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"978fe010-876e-4615-9610-aad5d7e8b9cb":{"__data__":"{\"id_\":\"978fe010-876e-4615-9610-aad5d7e8b9cb\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"493e33a8-94ac-44fc-b6ed-1b318fdb1149\",\"metadata\":{},\"hash\":\"O3zH126dJePIuzrLQ7imVis06fpDfhCSCfTCymQCg60=\"}},\"hash\":\"u7sXxaR2E9fLneeZ4N5hTSKHyHPOVt1GwapRGUpB/aY=\",\"text\":\"### Simulated Data\\n\\n```{figure} figures/low_rank/figure_1_v6.png\\n:align: center\\n:label: fig-low-rank-1\\n\\nSimulation results. A) An example of the simulated signals for the\\ndifferent SNR conditions; B) ROC values for the estimation of\\nthe neuronal-related signal with: SPFM using BIC (SPFM BIC),\\nSPFM with no low-rank estimation and no spatial regularization (SPFM,\\n$\\\\rho=1$), MV-SPFM with no low-rank estimation (MV-SPFM, $\\\\rho = 0.8$), the\\nSPLORA-PFM algorithm with only the L1-norm (LR+SPFM, $\\\\rho=1$), and the\\nSPLORA-PFM algorithm ($\\\\rho = 0.8$). C) Estimation error of the low-rank\\ncomponents for different ratios of BOLD/total number of voxels. ```\\n\\nB depicts the receiver operating characteristic (ROC) curves with the\\nsensitivity and specificity rates for the estimation of the neuronal-related signal\\n$\\\\mathbf{\\\\hat{S}}$ for each simulation scenario. Regardless of the simulated SNR and the BOLD/total\\nvoxels ratios, the ROC values demonstrate the proposed SPLORA-PFM algorithm achieves higher\\nspecificity and sensitivity than the original SPFM method, except for the highest BOLD/total number\\nof voxels ratio and highest SNR where the multivariate nature of the model prevents the algorithm\\nfrom fitting accurately each voxel. As expected, all variations of the proposed algorithm exhibit\\nlower sensitivity as the SNR is reduced while maintaining the level of specificity. In addition,\\nC plots the error of the low-rank component estimate obtained with the\\nSPLORA-PFM algorithm for $\\\\rho = 0.8$, showing that its estimate improves with a lower BOLD/total\\nvoxels ratio.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"6f16c335-6eb6-42f5-bac1-bdf7dd0eda00":{"__data__":"{\"id_\":\"6f16c335-6eb6-42f5-bac1-bdf7dd0eda00\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"761f67a7-f823-43fa-8c21-394b29c3adaf\",\"metadata\":{},\"hash\":\"uKkTeugMt70GMTQcNuPQA483rowiQ5Y/TzvAgUgxSw8=\"},\"NEXT\":{\"nodeId\":\"d40f9e41-973c-4641-89cc-e2125d2c4193\",\"metadata\":{},\"hash\":\"h2W4l5DB1Eq4bmG62i93Hf3bka4sKkuHSEGKxzHvj88=\"}},\"hash\":\"Wjpq2m1x774ErU2vZvxt/Lk/CfD2I/p6nWt2HcfSv28=\",\"text\":\"### Experimental Data\\n\\n```{figure} figures/low_rank/figure_2_no_G.png\\n:align: center\\n:label: fig-low-rank-2\\n\\nA) Euclidean norm of the motion displacements (E-norm) (blue),\\nDVARS (black) and global (gray) signals of the fMRI data; B) Grayplots of\\ngray matter (GM) and white matter (WM) of the preprocessed fMRI\\ndata, the estimated low-rank and neuronal-related components; C) Time series\\nand F) maps of the estimated low-rank components; D) Time series and E) maps\\nof representative single-trial neuronal-related (motor) activity. The color\\nbands in the plots with the time series illustrate the timing of the\\ndifferent conditions. ```\\n\\n```{figure} figures/low_rank/figure_3.png\\n:align: center\\n:label: fig-low-rank-3\\n\\nROC values of the five conditions for the three algorithms tested:\\nSPFM, MV-SPFM and SPLORA-PFM (red, dark-purple and dark-green dots\\ncorrespond to the subject in ). ```\\n\\nA-F depict the results of the SPLORA-PFM algorithm in a representative dataset. For this subject and session, the proposed method estimated $P=3$ global low-rank components whose\\ntime series $\\\\mathbf{a}_p$ and spatial maps $\\\\mathbf{v}_p$ are shown in C and F,\\nrespectively. A shows the Euclidean norm of the motion displacements (E-norm),\\nDVARS (the spatial root mean square of the data;\\n@Smyser2011FunctionalconnectivityMRI, @Power2012Spurioussystematiccorrelations) and the average\\nglobal signal (GS) time series, whereas B displays the grayplots of the\\npreprocessed data (RAW), estimated low-rank component and estimated neuronal-related component in\\ngray matter (GM) and white matter (WM) voxels. The first low-rank component captures signal\\nfluctuations related to head movements and susceptibility artefacts during the \\\"moving the tongue\\\"\\ncondition, suggesting that the subject moved the head while performing the tongue movement task. The second low-rank component has a time series that closely follows the global signal and its\\nspatial map actually delineates major arteries and draining veins, whereas the third component is\\nclearly related to widespread physiological fluctuations. Among participants, the number of\\nestimated low-rank components ranged between 1 and 5. Furthermore, D and E illustrate the time series of the\\nestimated neuronal-related signal for a representative voxel (see cross in the first map) and the\\nmaps for several individual events of the tongue movements and right hand finger tapping\\nconditions, respectively. The SPLORA-PFM maps reveal clusters of activity in similar regions to\\nthose inferred with a traditional general linear model (GLM) analysis, which is aware of the\\ntimings of the events. The single-trial GLM activation maps are thresholded based on their\\nt-statistic at a significance threshold of $p < 0.001$. Notably, the SPLORA-PFM maps still depict\\nthe tongue areas of the motor cortex bilaterally even though the timing of the first low-rank\\ncomponent also closely followed the tongue condition. Finally,  depicts the ROC values of the MV-SPFM and SPLORA-PFM, both using\\n$\\\\rho=0.8$, and the original SPFM algorithm using the GLM maps of each event thresholded at a $p =\\n0.001$ as the ground-truth. The ROC curves of the five motor task conditions show that both the\\nMV-SPFM and the SPLORA-PFM approaches provide higher sensitivity at the cost of a reduced\\nspecificity, and that the higher complexity involved in estimating the low-rank component does not\\ndiminish the accuracy in deconvolving the neuronal-related component of the signal. This work introduced a novel formulation for the deconvolution of BOLD fMRI data using a low rank\\nand sparse algorithm that captures global fluctuations due to motion artefacts or physiological\\nsignals that typically reduce the accuracy of neuronal related estimates of currently used\\nalgorithms. The formulation described in this chapter was presented for single-echo acquisition and\\nthe spike model. However, it can be adapted straightforwardly for multi-echo\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti] or the block model\\n[@Karahanoglu2013TotalactivationfMRI;@Cherkaoui2019Sparsitybasedblind;@Urunuela2023HemodynamicDeconvolutionDemystified]\\nusing the multi-echo and innovation signals described in  and\\n respectively.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d40f9e41-973c-4641-89cc-e2125d2c4193":{"__data__":"{\"id_\":\"d40f9e41-973c-4641-89cc-e2125d2c4193\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"761f67a7-f823-43fa-8c21-394b29c3adaf\",\"metadata\":{},\"hash\":\"uKkTeugMt70GMTQcNuPQA483rowiQ5Y/TzvAgUgxSw8=\"},\"PREVIOUS\":{\"nodeId\":\"6f16c335-6eb6-42f5-bac1-bdf7dd0eda00\",\"metadata\":{},\"hash\":\"Wjpq2m1x774ErU2vZvxt/Lk/CfD2I/p6nWt2HcfSv28=\"}},\"hash\":\"h2W4l5DB1Eq4bmG62i93Hf3bka4sKkuHSEGKxzHvj88=\",\"text\":\"Likewise, the selection of the regularization\\nparameters $\\\\mathbf{D}_s$, $\\\\lambda_L$ and $\\\\rho$ was done empirically here and could be further\\noptimized using robust approaches such as stability selection\\n[@Meinshausen2010Stabilityselection;@Urunuela2020StabilityBasedSparse] as described in\\n and . Finally, future work will be directed towards\\nevaluating the performance of SPLORA-PFM on resting-state data. Specifically, these evaluations\\nwill assess its effectiveness in mitigating the influence of commonly observed global fluctuations\\non activity-inducing signal estimates, since it is expected that SPLORA-PFM will exhibit superior\\nperformance in this regard compared to its performance on task fMRI data.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"af18cf1b-643e-4692-a77b-07fee22cad09":{"__data__":"{\"id_\":\"af18cf1b-643e-4692-a77b-07fee22cad09\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"32d8be53-cb3a-4577-8d06-962088eabaec\",\"metadata\":{},\"hash\":\"KY96tJ2UXrAGbRUny4VdMYifZorgV/i7g4ubJh/Mu88=\"}},\"hash\":\"LoixsIIXfw/mdwoLIH7vW4/prRID/jLw8LUOAMYTH2U=\",\"text\":\"# Chapter 5: Multi-Subject Paradigm Free Mapping\\n\\nThis chapter is in preparation to be published and will be available as an\\ninteractive website such as this one. Functional magnetic resonance imaging (fMRI) during naturalistic paradigms has become increasingly\\npopular in cognitive neuroscience as a way to investigate cognition and behaviour within more\\necologically valid contexts. However, current methods for fMRI data analysis in naturalistic\\nparadigms are limited in how they can characterize the precise spatio-temporal dynamics of neural\\nactivity evoked by naturalistic stimuli. On the one hand, model-based approaches, such as\\ntraditional general linear model (GLM) analyses and encoding models, make strong assumptions about\\nwhat features of the stimulus might be important and when they occur, which limits an accurate\\ninterpretation of the resulting maps of blood oxygenation-level dependent (BOLD) activity. On the\\nother hand, model-free approaches, such as inter-subject correlation and event segmentation\\nalgorithms, make no assumptions about stimulus features, but necessitate combining information\\nacross multiple time points, making it difficult to trace the recovered signal back to particular\\nmoments in the stimulus. To address these limitations, this chapter introduces a novel method for\\nfMRI data analysis in naturalistic paradigms, called multi-subject Paradigm Free Mapping (msPFM). Unlike existing approaches, msPFM estimates shared and individualized neuronal-related brain\\nresponses at the finest spatial and temporal resolution available in fMRI data. The msPFM algorithm\\nimplements a multivariate regularized least-squares algorithm for hemodynamic deconvolution of fMRI\\ndata that estimates the neuronal-related BOLD activity without relying on the temporal structure of\\nthe stimuli. Its performance is demonstrated through simulations and experimental movie-watching\\ndatasets, showcasing its ability to detect moment-to-moment neuronal-related activity patterns\\nassociated with low- and mid-level features of the movie. Furthermore, msPFM reveals a spatial\\ncortical gradient of BOLD activity that aligns with previous findings obtained with event\\nsegmentation methods. It also provides an extra temporal dimension to the maps obtained with\\nintersubject correlation analyses. In summary, msPFM offers a powerful tool for exploring the\\nspatio-temporal dynamics of the rich patterns of neural activity evoked by naturalistic fMRI\\nparadigms. Researchers can access the open-source Python package for msPFM at\\nhttps://github.com/ParadigmFreeMapping/msPFM. (sec-multi-subject-introduction)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"1489c0f2-358b-485f-ad71-e3909af6231b":{"__data__":"{\"id_\":\"1489c0f2-358b-485f-ad71-e3909af6231b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"854dee56-8823-4290-9045-07c606d50d60\",\"metadata\":{},\"hash\":\"CvSlirgj4Eyf9nbfd6bjQbxMCiNr9+5zFphPfkDyEuo=\"},\"NEXT\":{\"nodeId\":\"c71b7335-ca64-4968-bc93-aea1b1364ad9\",\"metadata\":{},\"hash\":\"HpxrvLVBqv/k1Xgm3JFbISJTzlnMsFGDu7//PiH09Ic=\"}},\"hash\":\"Cfaz1taiHhRN1DznNzZvVw7RVcaviXZqlTfrwhTaxFs=\",\"text\":\"## Introduction\\n\\nThe use of movies and stories in the so-called naturalistic paradigms combined with functional\\nmagnetic resonance imaging (fMRI) has increased considerably in recent years as a replacement for\\ntask and resting state experimental paradigms to study human cognition and mapping brain function\\n[@Finn2021Isittime]. It owes its popularity not only to its similarity with freeform cognition and\\nunconstrained behaviour, but also to the fact that individual differences in functional\\nconnectivity are more stable\\n[@Vanderwal2017Individualdifferencesfunctional;@Wang2017Testretestreliability] and offer improved\\npredictions of behavior [@Finn2021Moviewatchingoutperforms]. Furthermore, naturalistic paradigms\\nhave emerged as valuable tools for investigating various neurological and developmental disorders. For example, studies utilizing movie-watching have revealed distinct functional network\\nconfigurations among individuals with autism, highlighting their idiosyncratic patterns\\n[@Bolton2018BraindynamicsASD;@Bolton2020Neuralresponsesautism]. Additionally, research has\\ndemonstrated a reduction in intersubject correlations within attention-related brain areas among\\nindividuals with attention deficit hyperactivity disorder (ADHD), indicating a desynchronization of\\nbrain activity in this diseased population [@Salmi2020ADHDdesynchronizesbrain]. Movie-watching fMRI\\nhas also been utilized to investigate the memory representations of healthy individuals during the\\nretrieval of movie scenes, which revealed a shared spatial organization among subjects exposed to\\nidentical naturalistic stimuli [@Chen2017Sharedmemoriesreveal]. Finally, naturalistic paradigms\\nhave played a crucial role in demonstrating the meaningful structure and reliability of movie scene\\nsegmentation across subjects\\n[@Raccah2022Acousticfeaturesdrive;@Speer2009ReadingStoriesActivates;@Zacks2009Usingmovementintentions}]. Notably, studies have revealed that variations in these patterns of event segmentation are\\nassociated with age, cognitive abilities\\n[@Bailey2017Attentionalfocusaffects;@Jafarpour2022Eventsegmentationreveals;@Zacks2006Eventunderstandingmemory],\\nand clinical conditions [@Zalla2004Perceptiondynamicaction]. Several techniques have been employed to analyze naturalistic fMRI data. One such technique is\\nintersubject correlation (ISC), which involves calculating the synchrony among the voxelwise\\nsignals of multiple subjects throughout the data acquisition process\\n[@Hasson2004IntersubjectSynchronizationCortical;@Wilson2007SuperiorTemporalCortex;@Nastase2019Measuringsharedresponses;@Jangraw2023Intersubjectcorrelation;@Chen2020Untanglingrelatednesscorrelations]. An extension to this approach incorporates the temporal dimension with the sliding window ISC\\nmethod (averaging ISC over a temporal window of a few volumes) or the instantaneous phase\\nsynchronization [@Glerean2012FunctionalMagneticResonance], These approaches generate voxelwise\\nmeasures of moment-to-moment synchrony [@Nummenmaa2012Emotionspromotesocial], which can then\\nbe contrasted against stimulus models, offering an intermediate approach that combines aspects of\\nstimulus-dependent and stimulus-free analyses. However, the degree of synchrony is calculated\\nduring the entire acquisition or within the win dow duration, i.e. spanning over multiple TRs. Intra and inter-subject correlation of functional connectivity\\n[@Vanderwal2017Individualdifferencesfunctional] and the intersubject correlation of dynamic\\nconnectivity [@Di2020Intersubjectconsistentdynamic] offer additional approaches for\\ninvestigating naturalistic fMRI data that examine the interplay between brain regions and the\\nconsistent patterns of connectivity across individuals. Alternatively, the detection of event\\nsegmentation boundaries has also been a major focus in the development of data analysis techniques\\nfor naturalistic paradigms. Currently, two main state-of-the-art techniques are mostly used to\\nblindly identify temporal boundaries within a sequence of events without prior knowledge: hidden\\nMarkov models (HMM) [@Baldassano2017DiscoveringEventStructure] and greedy state boundary\\nsearch (GSBS) [@Geerligs2021Detectingneuralstate]. Finally, another strategy involves\\nconstructing encoding models that utilize representations extracted from neural network language\\nmodels to forecast BOLD responses to natural language stimuli\\n[@Jain2020Interpretablemultitimescale], as well as the use of deep neural network models using\\nhuman visual areas to learn non-hierarchical representations [@StYves2023Brainoptimizeddeep]. However, the aforementioned methods have several limitations. First, ISC reveals widespread\\nsynchronization across individuals without specific associations with events of particular\\ncognitive functions throughout a scan.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"c71b7335-ca64-4968-bc93-aea1b1364ad9":{"__data__":"{\"id_\":\"c71b7335-ca64-4968-bc93-aea1b1364ad9\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"854dee56-8823-4290-9045-07c606d50d60\",\"metadata\":{},\"hash\":\"CvSlirgj4Eyf9nbfd6bjQbxMCiNr9+5zFphPfkDyEuo=\"},\"PREVIOUS\":{\"nodeId\":\"1489c0f2-358b-485f-ad71-e3909af6231b\",\"metadata\":{},\"hash\":\"Cfaz1taiHhRN1DznNzZvVw7RVcaviXZqlTfrwhTaxFs=\"}},\"hash\":\"HpxrvLVBqv/k1Xgm3JFbISJTzlnMsFGDu7//PiH09Ic=\",\"text\":\"Although sliding-window ISC can enhance temporal resolution\\nfor characterizing such events, it should be noted that this technique does not offer the utmost\\nlevel of temporal precision. Second, the HMM and GSBS operate at the ROI level, and hence provide a\\nlow spatial resolution that does not allow the discovery of precise, individualized spatial\\npatterns. More importantly, all these techniques summarize the within-region fMRI signal into\\nstates or connectivity patterns that are sustained over several TRs, and therefore, they do not\\ncapture temporal dynamics at the fastest temporal resolution available in the data, i.e., at the TR\\nlevel. In summary, these methods rule out the precision mapping of idiosyncratic spatio-temporal\\npatterns evoked by naturalistic stimuli. One possible approach to address this issue is to employ\\ndata-driven techniques that operate at the TR and voxel level. Hemodynamic deconvolution is a\\nmethod that falls under this category [@Gaudes2010Detectioncharacterizationsingle;@Karahanoglu2013TotalactivationfMRI;@Urunuela2023HemodynamicDeconvolutionDemystified]. It has the\\nability to estimate neuronal-related activity without relying on the temporal information of the\\nexperimental paradigm, and as a result, it proves to be particularly valuable when dealing with\\nnaturalistic stimuli. Here, we introduce a novel method for the analysis of naturalistic fMRI data called multi-subject\\nParadigm Free Mapping (msPFM) that overcomes the limitations mentioned above. msPFM solves a\\nmultivariate regularized least-squares problem for hemodynamic deconvolution of the fMRI signal\\nacross subjects to blindly estimate the shared and individualized neuronal-related activity without\\nrequiring any temporal model of the stimulus. Unlike previous methods for naturalistic fMRI data,\\nthis formulation allows the msPFM algorithm to operate at the fastest temporal resolution (TR), and\\nthe highest spatial resolution (voxel). We introduce msPFM and evaluate the method in simulations\\nand two experimental datasets with movie-watching paradigms to showcase its potential to elucidate\\nmoment-to-moment spatio-temporal neural activity patterns evoked by naturalistic paradigms and\\nassess their ability to map low- and mid-level movie features. The datasets, *Iteration* and\\n*Sherlock*, differed in terms of the studied low- and mid-level features, subject counts (43\\nvs 16), and data type (multi-echo vs single-echo).\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"cd52993c-2cb5-455f-b8ea-ca0547df580f":{"__data__":"{\"id_\":\"cd52993c-2cb5-455f-b8ea-ca0547df580f\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"b9c588f3-4f07-4603-aad2-b90963ffd8f9\",\"metadata\":{},\"hash\":\"CWLW9YkKD2pIPbI3smXuqsr5kd+zJrCU9Fitj3D5P2w=\"}},\"hash\":\"BVvznk9hXxkFxx3yD1xUbgFuW7b5TVA9/P83FYcjX9E=\",\"text\":\"## Multi-subject Paradigm Free Mapping\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"2b51d23b-253a-46d3-9318-1abd813c30a5":{"__data__":"{\"id_\":\"2b51d23b-253a-46d3-9318-1abd813c30a5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"1c8353c4-295a-47bf-ad1b-edec66ae48e3\",\"metadata\":{},\"hash\":\"Fn3FexxH+1f3Av26pgHdUs/qd+WyUlRyx+R0v6D5CvQ=\"},\"NEXT\":{\"nodeId\":\"f2b0fe1f-0ab2-4ef6-a853-9d2182bab392\",\"metadata\":{},\"hash\":\"yqk2Ig48eEBtdGHuFTFcyaYT/z2cFfAwH5OJpUVB/yo=\"}},\"hash\":\"1PHKY+pRnbV+y1XyiZWY1SkHwyb++55UlmQtsXDanFs=\",\"text\":\"### Signal Model\\n\\nIn gradient-echo fMRI acquisitions, the time series of a voxel $v$ normalized to signal percentage\\nchange can be approximated with the following linear relationship with the echo time (TE)\\n[@Kundu2017MultiechofMRI]:\\n\\n```{math}\\ny(v,TE_k, t) \\\\approx \\\\Delta \\\\rho(v,t) - TE_k \\\\Delta R_2^*(v,t) + \\\\epsilon(v,t),\\n```\\n\\nwhere $\\\\Delta R_2^*(v,t)$ represents BOLD-like changes, $\\\\Delta \\\\rho(v,t)$ describes changes in the\\nnet magnetization, and $\\\\epsilon(v,t)$ is a random noise term. Changes in the net magnetization\\n$\\\\Delta \\\\rho(v,t)$ are mostly due to motion- and hardware-related artefacts, which can be reduced\\nin preprocessing by using denoising tools such as ICA-AROMA [@Pruim2015ICAAROMArobust] for\\nsingle-echo acquisitions or ME-ICA [@Kundu2012DifferentiatingBOLDnon;@Kundu2017MultiechofMRI] for\\nmulti-echo acquisitions. Hereinafter, the term $\\\\Delta \\\\rho(v,t)$ can be neglected for a simpler\\nnotation. Following the same notation described in previous chapters, let us also consider that changes in\\n$R_2^*(v,t)$ that are related to neuronal activity will follow a linear time-invariant model that\\nis defined as the convolution of the activity-inducing signal $s(v,t)$ with the hemodynamic\\nresponse $h(v,t)$ [@Boynton1996LinearSystemsAnalysis;@Glover1999DeconvolutionImpulseResponse]. Considering the signal is sampled at every TR, the previous signal model can be written in discrete\\nmatrix form as $\\\\mathbf{y}_{v} = -TE_ k \\\\mathbf{H} \\\\mathbf{s}_{v} + \\\\boldsymbol{\\\\epsilon}_{v}$,\\nwhere $\\\\mathbf{H} \\\\in \\\\mathbb{R}^{N \\\\times N}$ is the Toeplitz convolution matrix with shifted\\nversions of the hemodynamic response function (HRF)\\n[@Gitelman2003Modelingregionalpsychophysiologic;@Gaudes2013Paradigmfreemapping], $\\\\mathbf{y}_v$,\\n$\\\\mathbf{s}_v$, $\\\\boldsymbol{\\\\epsilon}_{v} \\\\in \\\\mathbb{R}^{N}$, and $N$ is the number of scans\\n(i.e. TRs). Without loss of generalization, we assume that the HRF model is the same across\\nvoxels. As described in , the activity-inducing\\nsignal $\\\\mathbf{s}_{v}$ can also be written in terms of the innovation signal\\n$\\\\mathbf{u}_v$ as $\\\\mathbf{s}_{v} = \\\\mathbf{Lu}_{v}$, where the matrix\\n$\\\\mathbf{L} \\\\in \\\\mathbb{R}^{N \\\\times N}$ is the first-order integration operator\\n[@Cherkaoui2019Sparsitybasedblind;@Urunuela2020StabilityBasedSparse;@Urunuela2023HemodynamicDeconvolutionDemystified]. Hence, the signal model for a given $TE_k$ (i.e. single-echo) can be written as\\nfollows:\\n\\n```{math}\\n:label: eq-signal-model-single-echo\\n\\\\mathbf{y}_{v,k} = - TE_{k} \\\\mathbf{HL} \\\\mathbf{u}_{v} + \\\\boldsymbol{\\\\epsilon}_v,\\n```\\n\\nwhich can be extended for a multi-echo acquisition by concatenating the time\\nseries of each echo ($k=1,\\\\ldots,K$) in a single vector:\\n\\n```{math}\\n:label: eq-signal-model-multi-echo\\n\\\\left[\\\\begin{array}{c} \\\\mathbf{y}_{v,1} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    \\\\mathbf{y}_{v,K}\\n\\\\end{array}\\\\right]\\n=\\n\\\\left[\\\\begin{array}{c} -\\\\mathrm{TE}_{1} \\\\mathbf{HL} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    -\\\\mathrm{TE}_{K} \\\\mathbf{HL}\\n\\\\end{array}\\\\right]\\n\\\\mathbf{u}_v\\n+\\n\\\\left[\\\\begin{array}{c} \\\\boldsymbol{\\\\epsilon}_{v,1} \\\\\\\\\\n    \\\\vdots  \\\\\\\\\\n    \\\\boldsymbol{\\\\epsilon}_{v,K}\\n\\\\end{array}\\\\right].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"f2b0fe1f-0ab2-4ef6-a853-9d2182bab392":{"__data__":"{\"id_\":\"f2b0fe1f-0ab2-4ef6-a853-9d2182bab392\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"1c8353c4-295a-47bf-ad1b-edec66ae48e3\",\"metadata\":{},\"hash\":\"Fn3FexxH+1f3Av26pgHdUs/qd+WyUlRyx+R0v6D5CvQ=\"},\"PREVIOUS\":{\"nodeId\":\"2b51d23b-253a-46d3-9318-1abd813c30a5\",\"metadata\":{},\"hash\":\"1PHKY+pRnbV+y1XyiZWY1SkHwyb++55UlmQtsXDanFs=\"}},\"hash\":\"yqk2Ig48eEBtdGHuFTFcyaYT/z2cFfAwH5OJpUVB/yo=\",\"text\":\"```\\n\\nAssuming that data from multiple subjects ($s=1,\\\\ldots,S$) are aligned to a\\ncommon space, the multivariate multi-echo formulation introduced by\\n@Urunuela2024Wholebrainmultivariate] (see [) is\\nadapted to simultaneously estimate shared and individualized voxelwise\\nactivity-inducing signal in multiple subjects. This method, referred to as\\nmulti-subject Paradigm Free Mapping (msPFM), therefore proposes to concatenate the\\nvoxelwise fMRI signal of multiple subjects into $\\\\mathbf{Y}_v \\\\in \\\\mathbb{R}^{K\\n\\\\cdot N S}$. Hence, for a given voxel $v$ or ROI the signal model of msPFM can\\nbe written as follows:\\n\\n```{math}\\n:label: eq-signal-model-multi-subject\\n\\\\left[\\\\begin{array}{ccc} \\\\mathbf{y}_{v,1,1} & \\\\cdots & \\\\mathbf{y}_{v,S,1} \\\\\\\\\\n    \\\\vdots & \\\\ddots & \\\\vdots \\\\\\\\\\n    \\\\mathbf{y}_{v,1,K} & \\\\cdots & \\\\mathbf{y}_{v,S,K}\\n\\\\end{array}\\\\right]\\n=\\n\\\\left[\\\\begin{array}{c} -\\\\mathrm{TE}_{1} \\\\mathbf{HL} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    -\\\\mathrm{TE}_{K} \\\\mathbf{HL}\\n\\\\end{array}\\\\right]\\n\\\\left[\\\\begin{array}{ccc}\\n    \\\\mathbf{u}_{v,1} & \\\\dots & \\\\mathbf{u}_{v,S}\\n\\\\end{array}\\\\right]\\n+\\n\\\\left[\\\\begin{array}{ccc} \\\\boldsymbol{\\\\epsilon}_{v,1,1} & \\\\dots & \\\\boldsymbol{\\\\epsilon}_{v,S,1} \\\\\\\\\\n    \\\\vdots & \\\\ddots & \\\\vdots \\\\\\\\\\n    \\\\boldsymbol{\\\\epsilon}_{v,1,K} & \\\\dots & \\\\boldsymbol{\\\\epsilon}_{v,S,K}\\n\\\\end{array}\\\\right],\\n```\\n\\nwhich can be simplified as $\\\\overline{\\\\mathbf{Y}}=\\\\overline{\\\\mathbf{H}}\\\\mathbf{U}_v + \\\\mathbf{E}$. (sec-inverse-problem-mspfm)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d0f7870f-90fa-4c8f-83fa-74ba2fb04333":{"__data__":"{\"id_\":\"d0f7870f-90fa-4c8f-83fa-74ba2fb04333\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"af4b9470-0392-4d93-8b8d-3b7cc96f4a1a\",\"metadata\":{},\"hash\":\"8w5f8nz3Z6t9TksgqLps+AjjyvCFozhSXJ1PPW5EhEI=\"}},\"hash\":\"eUMR6k+gVm/cY/J+Bs8Psb/MnTBJ7uE2PiH2HPU/TRs=\",\"text\":\"### Inverse Problem\\n\\nAssuming the noise follows a Normal distribution, the innovation signals for all subjects can be\\nestimated by solving a multivariate ordinary least squares problem. However, due to high\\ncollinearity of the Toeplitz convolution matrix $\\\\mathbf{H}$, the estimates will exhibit a large\\nvariance in temporal space. Furthermore, in this multi-subject setting where subjects are exposed\\nto the same naturalistic stimuli, certain amount of synchronization of the neuronal activity across\\nsubjects can be presumed at given instances. Based on these priors, the estimation of the\\ninnovation signal $\\\\mathbf{U}_v$ can be solved with the following regularized multivariate least\\nsquares problem:\\n\\n```{math}\\n:label: eq-inverse-problem-multi-subject\\n\\\\mathbf{U}_v = \\\\arg \\\\min_{\\\\mathbf{U}_v} \\\\| \\\\overline{\\\\mathbf{Y}}_v - \\\\overline{\\\\mathbf{H}} \\\\mathbf{U}_v \\\\|_2^2 + \\\\rho\\n\\\\| \\\\mathbf{D}_v \\\\mathbf{U}_v \\\\|_{1} + (1 - \\\\rho) \\\\| \\\\mathbf{D}_v \\\\mathbf{U}_v \\\\|_{2,1}. ```\\n\\nHere, the regularization term $\\\\| \\\\mathbf{D}_v \\\\mathbf{U}_v \\\\|_{1}$ promotes\\nsparsity of the innovation signals across time and subjects, treating each estimate independently. On the other hand, the mixed-norm regularization term $\\\\| \\\\mathbf{D}_v \\\\mathbf{U}_v \\\\|_{2,1}$\\npromotes the co-activation of the innovation signals across all subjects simultaneously\\n[@Gramfort2011FunctionalBrainImaging;@Urunuela2024Wholebrainmultivariate]. The parameter\\n$\\\\rho$ controls the balance between the two regularization terms, and $\\\\mathbf{D}_v =\\n\\\\text{diag}(\\\\lambda_{v,1}, \\\\dots, \\\\lambda_{v,S}) \\\\in \\\\mathbb{R}^{S \\\\times S}$ is a diagonal matrix\\nwith subject-specific and region-specific regularization parameters $\\\\lambda_{v,s}$, which allows\\nadjusting to the level of noise in each subject's data and region. Here, the msPFM algorithm is\\ndescribed for multi-echo fMRI data, but note that it can easily be adapted for single-echo data\\n(see @Gaudes2013Paradigmfreemapping). As it has been discussed in previous chapters, the selection of the regularization parameters\\n$\\\\lambda_{v,s}$ is critical to obtain accurate estimates of the innovation signal $\\\\mathbf{U}$. Here, for each region, a subject-specific regularization parameter $\\\\lambda_{v,s} = 30 \\\\sigma_s$\\nwas chosen for each subject $s$, where $\\\\sigma_s$ is a pre-estimated noise level of the data fit\\nand the pre-estimated noise level is derived from the median absolute deviation of fine-scale\\nwavelet coefficients (Daubechies, order 3) of each subject. In addition, the parameter $\\\\rho$ was\\nset to 0.8 to balance the sparsity of the innovation signals (i.e. capturing the idiosyncrasies of\\neach subject and moment) and the grouping of synchronous co-activations across subjects (i.e. shared neuronal responses across subject at a given time). Both the $\\\\lambda$ and $\\\\rho$ parameters\\nwere set based on simulations. Relevantly, notice that msPFM estimates a 4D dataset of the innovation signal $\\\\mathbf{U}_v \\\\in\\n\\\\mathbb{R}^{T \\\\times S}$ for every subject. That is, unlike a GLM method that calculates activation\\nmaps for each onset in the paradigm, msPFM estimates activity maps for each TR. In fact, the\\ninnovation signal estimated by msPFM can easily be converted into the activity-inducing signal with\\nan integration operator, and convolved with the HRF to obtain a denoised reconstruction of the\\ndata. (sec-multi-subject-methods)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a23f1bb6-aa0d-4101-8e35-985f6cd54af0":{"__data__":"{\"id_\":\"a23f1bb6-aa0d-4101-8e35-985f6cd54af0\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"cbd8f608-891e-4328-8965-55ab0ce50082\",\"metadata\":{},\"hash\":\"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc=\"}},\"hash\":\"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=\",\"text\":\"## Methods\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"35c4eaad-e8fb-4242-a96f-2ec2b1faffb2":{"__data__":"{\"id_\":\"35c4eaad-e8fb-4242-a96f-2ec2b1faffb2\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"0a1ce044-7590-45d8-95d9-aa2229ef4348\",\"metadata\":{},\"hash\":\"wkTwiW8XRxkFsuyHTuc8fZf44DcxebEDhRHnmkK23Yg=\"}},\"hash\":\"jyqp6q9fFbhm2SQZJaa2ew96B1MZswnQZ+73FFUmrwU=\",\"text\":\"### Simulations\\n\\nWe generated a voxel time-series for subjects divided into three groups (groups 1-3) with similar,\\nyet different BOLD patterns to simulate group responses and idiosyncrasies as shown in\\n and . We also generated two time-series with\\nno BOLD responses (group 4) as a time-series were msPFM should not find any activity. The\\ntime-series included Gaussian noise to simulate the effect of noise in fMRI data, and were\\nnormalized to percent signal change. Two scenarios were simulated to study the effect of how the relative number of subjects in each\\ngroup affects the estimation of the innovation signal in the other subjects: (1) the groups\\ncontained a different ratio of subjects per group: group 1 contained 35 subjects, group 2 contained\\n15 subjects, and group 3 contained 5 subjects (see ); and (2) the same\\nratio of subjects per group is preserved: groups 1, 2 and 3 contain the same amount of subjects\\n(20) as shown in . The data for both scenarios were analyzed with the msPFM algorithm, where $\\\\lambda_s$ for each\\nsubject was carefully chosen as $\\\\lambda_s = 30 \\\\sigma_s$, as described in detail in\\n The parameter $\\\\rho$ was set to 0.8. A Jupyter Notebook with all\\nthe simulated scenarios is available at https://github.com/eurunuela/msPFM_paper.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"33b56345-89b5-40ba-8099-8c8bbee87565":{"__data__":"{\"id_\":\"33b56345-89b5-40ba-8099-8c8bbee87565\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"a5d127c1-a9ed-4030-9c9a-42639f5473e2\",\"metadata\":{},\"hash\":\"glTf5IBDhM9AOcTIuErndV4Lkvc9CF/QidwoDcyo6CY=\"}},\"hash\":\"xKv5/b2VLGzWPHtdtH2n17kqcR5YcWQPGZ+dSwgDnms=\",\"text\":\"### Experimental Data: MR Acquisition and Preprocessing\\n\\nThe performance of the proposed msPFM approach is illustrated in two\\nnaturalistic movie-watching datasets acquired with different MRI parameters and\\nwith different cognitive characteristics: The Iteration dataset and the Sherlock\\ndataset. These datasets were chosen due to their diffferent characteristics, as\\nthey would allow to validate the proposed msPFM method in a broader manner. In\\nparticular, *Iteration* offers 43 subjects and multi-echo data as opposed\\nto *Sherlock*'s 16 subjects and single-echo data. However,\\n*Sherlock* has been widely used by the naturalistic fMRI community and\\nthus is well known. In addition, *Sherlock* contains a higher number of\\ncharacters compared with the single character in *Iteration* (a second\\none appears at the very end), which implies that there is a higher amount of\\nspeech present in *Sherlock*. Finally, the movies are also different in\\nterms of their visuals, with *Iteration* mostly having a bright\\nbackground, while *Sherlock* contains more variety in terms of\\nbrightness. (the-iteration-dataset)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d2e6fc6d-3528-48ca-ae36-de4888be8c35":{"__data__":"{\"id_\":\"d2e6fc6d-3528-48ca-ae36-de4888be8c35\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"30aafcee-e279-4452-8e95-a194a034f230\",\"metadata\":{},\"hash\":\"5OcbZoouJ0Zl4HJzpnGO5MtiMxfE2TzxXcdADWL4yZA=\"},\"NEXT\":{\"nodeId\":\"e3b1c099-ccfb-4e33-a3be-a8dc2f687fa4\",\"metadata\":{},\"hash\":\"gPHFLyFOvfoHezeTFfaw/R6NZoPCdab6wEWnfrj8LcM=\"}},\"hash\":\"6VvLlt1d7Psj7+t7eIQvo0MZ+o5moOI8CKnj3EmWRt0=\",\"text\":\"#### The Iteration Dataset\\n\\n48 participants were used in this study (all native English speakers; 27F, median age 24.5, range =\\n(19,64)) from the National Institutes of Health (NIH). See\\n@SavaSegal2022Individualvariabilityneural for full procedural detail but in brief: subjects\\nwatched four movies (ranging from 7:27-12:27 min each) and subsequently completed a task battery\\ndesigned to probe their interpretations and reactions to the movie, including the following: (i) a\\n3-min free recall/appraisal task in which subjects spoke freely about their memories and\\nimpressions of the movie, during which their speech was captured with a noise-canceling microphone;\\n(ii) multiple-choice comprehension questions designed to ensure they had been paying attention;\\n(iii) multiple-choice and Likert-style items assessing reactions to various characters and to the\\nmovie overall. The movie order was pseudorandomized for each subject such that order was\\ncounterbalanced at the group level. From the four movies, we selected the one with the clearest\\nevent boundaries or scene cuts. MRI data were collected using a 3T Siemens Prisma scanner with a 64-channel head coil in 43\\nsubjects (all native English speakers; 27F, median age 24.5, range= (19,64)) while they watched a\\nmovie (called Iteration; https://youtu.be/c53fGdK84rc - 12:27\\nmin:sec) at the National Institutes of Health (NIH). All subjects provided informed written consent\\nprior to the start of the study in accordance with experimental procedures approved by the\\nInstitutional Review Board of the NIH. Functional images were acquired using a T2*-weighted\\nmultiband multi-echo echo-planar imaging (EPI) pulse sequence (TR = 1000 ms, echo times (TE) =\\n[13.6, 31.86, 50.12 ms], flip angle = 60 deg, field of view = 216 x 216 mm, voxel resolution = 3.0\\nmm isotropic, number of slices = 52 (whole-brain coverage), multiband acceleration factor = 4, with\\ninterleaved acquisition). Anatomical images were acquired using a T1-weighted MPRAGE pulse sequence\\n(TR = 2530 ms, TE = 3.30 ms, flip angle = 7 deg, field of view = 256 x 256 mm, voxel resolution =\\n1.0 mm isotropic). For more details on the data and experimental design, we refer the reader to\\n[@SavaSegal2022Individualvariabilityneural]. The raw data are available at\\nhttps://openneuro.org/datasets/ds004516/. Following the conversion of the original DICOM images to NIFTI format, we used AFNI\\n[@Cox1996AFNISoftwareAnalysis] to preprocess MRI data. The preprocessing pipeline was\\ngenerated with AFNI's *afni_proc* function and edited to use tedana\\n[@TedanaCommunity2022MEICA/tedana0.0.12;@DuPre2021TEdependentanalysis] for multi-echo\\nindependent component analysis (ME-ICA) denoising. Preprocessing included the following steps:\\ndespiking, volume realignment, affine coregistration with the subject-specific anatomical\\nT1-weighted image, nonlinear warping to the MNI152\\\\_2009 template, multi-echo ICA decomposition\\nwith tedana [@TedanaCommunity2022MEICA/tedana0.0.12;@DuPre2021TEdependentanalysis], manual\\nclassification of ME-ICA components with Rica [@Urunuela2023MEICA/ricav1.0.17], nuisance\\nregression of the components classified as noise, spatial smoothing with an isotropic gaussian\\nkernel with full-width half-maximum of 4 mm, detrending of up to 6th order polynomials, nuisance\\nregression of each subject's six motion time series, their derivatives, and linear polynomial\\nbaselines for each of the functional runs, and normalization to percent signal change. Nuisance\\nregression steps were perfomed together in as single step before normalizing to percent signal\\nchange. Finally, the preprocessed data was then analyzed with a shared response model\\n[@Chen2015ReducedDimensionfMRI] in BrainIAK [@Kumar2020BrainIAKBrainImaging] to account\\nfor different functional topographies across individuals. First, the model was fit to capture\\nreliable whole-brain responses to the movie across subjects in a lower dimensional feature (or\\ncomponent) space of 50 features. Then, the individual voxelwise time courses for each participant\\nwere reconstructed using this model.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e3b1c099-ccfb-4e33-a3be-a8dc2f687fa4":{"__data__":"{\"id_\":\"e3b1c099-ccfb-4e33-a3be-a8dc2f687fa4\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"30aafcee-e279-4452-8e95-a194a034f230\",\"metadata\":{},\"hash\":\"5OcbZoouJ0Zl4HJzpnGO5MtiMxfE2TzxXcdADWL4yZA=\"},\"PREVIOUS\":{\"nodeId\":\"d2e6fc6d-3528-48ca-ae36-de4888be8c35\",\"metadata\":{},\"hash\":\"6VvLlt1d7Psj7+t7eIQvo0MZ+o5moOI8CKnj3EmWRt0=\"}},\"hash\":\"gPHFLyFOvfoHezeTFfaw/R6NZoPCdab6wEWnfrj8LcM=\",\"text\":\"Then, the individual voxelwise time courses for each participant\\nwere reconstructed using this model. This procedure serves as an additional denoising step and\\nmakes spatiotemporal patterns more consistent across subjects. For computational reasons, all\\nanalyses were conducted on the average time-series of the 1000 cortical ROIs of the Schaefer atlas\\n[@Schaefer2017LocalGlobalParcellation]. (the-sherlock-dataset)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b4346177-7e28-4258-bbf4-e5cf5cbcfc0e":{"__data__":"{\"id_\":\"b4346177-7e28-4258-bbf4-e5cf5cbcfc0e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"80aa3952-d000-4091-b8f9-a75b716c9313\",\"metadata\":{},\"hash\":\"HdHtPd4921rNLiQEM8KOeJM60gqUEDaYQNijtj6DAb8=\"}},\"hash\":\"bI+y40zNngXtTRYY1xBF4q/FQPykBj/DnZbiwzZ1py4=\",\"text\":\"#### The Sherlock Dataset\\n\\n16 participants from the Sherlock dataset in [@Chen2017Sharedmemoriesreveal] were used for\\nthis study. See the original manuscript for full procedural details, but in brief: participants\\nwatched a 48-min segment of the BBC television series Sherlock and subsequently verbally recalled\\nthe narrative of the show aloud while undergoing fMRI data acquisition. During the recall task\\nparticipants were instructed to talk for a minimum of 10 minutes, and were allowed to talk for as\\nlong as they wished. Experimenters manually ended the scanning run during the recall task based on\\nverbal indication from participants. MRI data were collected on a 3T Siemens Skyra scanner with a 20-channel head coil. Functional\\nimages were acquired using a T2*-weighted echo-planar imaging (EPI) pulse sequence (TR = 1500 ms,\\nTE = 28 ms, flip angle = 64 deg, field of view = 192 $\\\\times$ 192 mm\\\\textsuperscript{2}, in-plane\\nresolution = 3.0 $\\\\times$ 3.0 mm\\\\textsuperscript{2}, slice thickness = 4 mm, number of slices = 27\\n(whole-brain coverage) with ascending interleaved acquisition). Reported analyses come from a\\nviewing run of 23 minutes. The raw data were available at\\nhttps://openneuro.org/datasets/ds001132/versions/1.0.0. The Sherlock data was preprocessed using fMRIPrep [@Esteban2018fMRIPreprobustpreprocessing]\\nwith the ICA AROMA option [@Pruim2015ICAAROMArobust]. The preprocessing also included spatial\\nsmoothing with a gaussian kernel of fwhm=6mm, and voxelwise nuisance regression of the 6\\nrealignment parameters, their squares, their derivatives, and squared derivatives. Finally, we\\nperformed a detrending step using a 6th order polynomial to remove slow drifts in the data and\\nnormalized the data to percent signal change. Similar to The~Iteration~dataset, the preprocessed\\ndata was then applied the shared response model [@Chen2015ReducedDimensionfMRI] in BrainIAK\\n[@Kumar2020BrainIAKBrainImaging], and analyses were conducted using the average time-series of\\nthe 1000 ROIs from the Schaefer atlas [@Schaefer2017LocalGlobalParcellation].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"1aa643f1-9534-4f0f-9d1e-c9b98d58759c":{"__data__":"{\"id_\":\"1aa643f1-9534-4f0f-9d1e-c9b98d58759c\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"aae33b37-e476-4ad4-accf-6093dc28f5a8\",\"metadata\":{},\"hash\":\"Sp3JfCcIxkYNd6ISvkmt3PFJLt4IB3lM2Qm7upM9XNI=\"}},\"hash\":\"x2rwR4hPZM7mcXc/iKQFD03Ll+CiUdLYrHSTWPKhon0=\",\"text\":\"### msPFM and Post Analyses\\n\\nThe msPFM algorithm was employed to estimate the activity-inducing signal for each subject and\\nparcel in the Schaefer 1000-ROI atlas. While msPFM allows for a voxelwise analysis, 1000 ROIs were\\nemployed in the analysis for computational efficiency and to address the voxel mismatch issue\\ncaused by variations in anatomical structures across subjects. The regularization parameters\\n$\\\\lambda$ and $\\\\rho$ were selected as described in the simulations section above. The double-gamma\\nSPM HRF was employed via nilearn's first level GLM module.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"ef7b5041-4987-485b-b020-9fdd888135f6":{"__data__":"{\"id_\":\"ef7b5041-4987-485b-b020-9fdd888135f6\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"825f45c1-0a73-43a7-bc29-be2c02c265ff\",\"metadata\":{},\"hash\":\"ennoaHvBRcXj+3t5gFDyvycVaYNusw9+Kz5EKvjrYS8=\"}},\"hash\":\"+Zglw/PxfECEIfcVcAmE0zdxD2jjtHSv9LTotZKUdUY=\",\"text\":\"#### Population Synchrony\\n\\nIn order to summarize the estimated activity-inducing signal across subjects and to compute metrics\\nthat allow us to validate our method, the positive population synchrony was calculated, denoted as\\nPopSync+. This metric quantifies the number of subjects that show positive neuronal-related\\nactivity at each TR, i.e., the number of subjects that activate together in response to the\\nstimuli. This metric was calculated for each ROI, thus obtaining a 4D map of positive population\\nsynchrony. Note that unlike other methods that have been used in the literature to quantify\\npopulation synchrony, this method provides a continuous measure at the TR level, rather than a\\nvalue per temporal window, which allows us to perform a more fine-grained analysis of the\\npopulation synchrony.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"987a4b27-83b4-4081-8e7f-cee338338530":{"__data__":"{\"id_\":\"987a4b27-83b4-4081-8e7f-cee338338530\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9dbf95de-1c54-4eaa-92a3-09a295a26eef\",\"metadata\":{},\"hash\":\"zxlH7FNPZRTHtIYNsNxUUuIQj/+0TvCr42ICcYQcOlg=\"}},\"hash\":\"X9WbFeARVi5Xw5TrusAzWe+uLVWYtLyVykdSPDsI9fU=\",\"text\":\"#### Event Rate and Inter-Subject Correlation\\n\\nRecent studies have used hidden Markov model (HMM) algorithms to automatically segment brain\\nactivity during the experimental acquisition into a sequence of events (a.k.a. event segmentation). A cortical gradient of segmentation rate has been reported such that primary sensory regions\\nsegment (transition between events) more quickly, while higher-order association regions segment\\nmore slowly [@Baldassano2017DiscoveringEventStructure;@Geerligs2022partiallynestedcortical];\\nthis principle has been related to temporal receptive windows and intrinsic timescales of brain\\nregions [@Murray2014hierarchyintrinsictimescales;@Hasson2008HierarchyTemporalReceptive]. Conversely, these findings suggest a lower occurrence in higher-order association areas that are\\nknown to be sensitive to narrative information over longer timescales\\n[@Lerner2011TopographicMappingHierarchy;@Honey2012SlowCorticalDynamics]. The aim here was to\\ndetermine if msPFM recovers this same cortical gradient. To this end, the msPFM-based event rate\\nwas calculated for each parcel, defined as the number of activity-inducing signal events per\\nminute, using the PopSync+ time series. Only events in the activity-inducing signal that elicited a\\npositive BOLD response were used; i.e., events were defined as instances where the\\nactivity-inducing signal remained non-zero for at least 5 TRs. Another known feature of brain activity during naturalistic stimulation is that synchrony of\\nactivity time courses across subjects, known as inter-subject correlation (ISC)\\n[@Hasson2004IntersubjectSynchronizationCortical;@Nastase2019Measuringsharedresponses;@Finn2020Idiosynchronysharedresponses],\\nalso roughly follows a sensory-association gradient, such that subjects are more similar to one\\nanother (i.e., more synchronized) in primary visual and auditory regions, while activity becomes\\nmore idiosyncratic in higher-order regions. An ISC-like metric was defined from msPFM estimates by\\nquantifying the median correlation across subjects of the estimated activity-inducing signal in\\neach parcel. Then, this was compared to a \\\"classic\\\" ISC approach, in which the median correlation\\nacross subjects of average raw BOLD signal was quantified in each parcel.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"0be053d7-647b-4647-851b-41911b4bd5eb":{"__data__":"{\"id_\":\"0be053d7-647b-4647-851b-41911b4bd5eb\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d53c6fc9-e958-4173-88f5-81034b658154\",\"metadata\":{},\"hash\":\"Ntwm8d7KSGKBxeGDY2dAV8H4qATp3jXozLQV7WGV9iA=\"}},\"hash\":\"kbJ978EYJ8IABMVgW03UJqpGiNlRa6C1j5Bpm5mP71I=\",\"text\":\"#### Correlation Between Population Synchrony and Movie Features\\n\\nIn order to confirm that the multi-subject Paradigm Free Mapping method can detect brain activity\\npatterns related to sensory stimuli, the correlation between the population synchrony and the\\nfollowing low-level features was calculated: changes in luminance (i.e., the derivative of the\\nluminance), and changes in audio (i.e., the derivative of the audio envelope). The low-level\\nfeatures were extracted from the movies employing a Python package named `pliers`. More\\nprecisely, the `BrightnessExtractor` and `RMSExtractor` functions were used\\nrespectively. The correlation between the population synchrony and the low-level features was\\ncalculated for each ROI, thus obtaining a 3D dataset of correlation values. The study of the relationship between the brain activity and the naturalistic stimuli was extended\\nto mid-level features. For instance, naturalistic stimuli where subjects see faces, buildings and\\nhand-related movements evoke brain activity patterns in the fusiform gyrus\\n[@Epstein1998corticalrepresentationlocal;@Haxby2000distributedhumanneural], the collateral sulcus\\n[@Aguirre1998AreaHumanVentral;@Epstein1998corticalrepresentationlocal], and the middle postcentral\\nsulcus [@Hasson2004IntersubjectSynchronizationCortical] respectively. In this study, the primary\\nfocus was to examine the relationship between population synchrony and speech, the presence of\\nhands, and the presence of faces in the movies. To extract the relevant information, the\\n`ClarifaiAPIVideoExtractor` and `FaceRecognitionFaceLocationsExtractor` functions provided by the\\n`pliers` library we utilized. These functions allow to accurately determine the timing of speech\\nand hand movements, as well as detect the presence of faces in the movie footage. (sec-multi-subject-results)\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b7aae4bd-67bc-4126-8e52-b219f9713b9a":{"__data__":"{\"id_\":\"b7aae4bd-67bc-4126-8e52-b219f9713b9a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"abfe51f8-0ba7-491c-afb7-931e54311ce9\",\"metadata\":{},\"hash\":\"5MjMdYVz44nAtdgw1Tc1js0J0kbpBHn2jJD+bWalnhQ=\"}},\"hash\":\"tMAGSBMSL4zTsnzsCudVr/eOzw1MULUmrdohLb0Qk6U=\",\"text\":\"## Results\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"5c866b32-24d8-49d1-8f0a-2b08cf7b46fc":{"__data__":"{\"id_\":\"5c866b32-24d8-49d1-8f0a-2b08cf7b46fc\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"e734a186-9266-4ad4-95a4-fcf369aa7cd1\",\"metadata\":{},\"hash\":\"SVQgqDhSrPBV0aflPwl8I2Apc3ebvLc6VcF8D9J0+Ck=\"}},\"hash\":\"r3xLLAbcM3T/ZCY6ycZBe5pzDAuS4t8PQz1p03PJeFI=\",\"text\":\"### Simulations\\n\\n```{figure} figures/multi_subject/sim_diff_ratio.png\\n:align: center\\n:label: fig-simulations-diff\\n\\nResults of running msPFM on simulated data for a ratio of subjects\\nper group of 35, 15, and 5 subjects respectively (groups are separated by a\\ndashed line). The first two heatmaps represent the simulated BOLD and\\nactivity-inducing signals for all the simulated subjects. The third and\\nfourth heatmaps represent the estimated activity-inducing and innovation\\nsignals for all the simulated subjects. The time courses below depict the\\nsimulated BOLD (black) and activity-inducing (blue) signals for a subject in\\neach group and the estimated activity-inducing signal is shown in red. ```\\n\\n```{figure} figures/multi_subject/sim_same_ratio.png\\n:align: center\\n:label: fig-simulations-same\\n\\nResults of running msPFM on simulated data for a ratio of subjects\\nper group of 20, 20, and 20 subjects respectively (groups are separated by a\\ndashed line). The first two heatmaps represent the simulated BOLD and\\nactivity-inducing signals for all the simulated subjects. The third and\\nfourth heatmaps represent the estimated activity-inducing and innovation\\nsignals for all the simulated subjects. The time courses below depict the\\nsimulated BOLD (black) and activity-inducing (blue) signals for a subject in\\neach group and the estimated activity-inducing signal is shown in red. ```\\n\\nBenchmarking msPFM on simulated data where the ground truth is known enables to assess whether it\\ncan effectively identify shared neuronal responses across subjects, while accommodating individual\\ndifferences in response to naturalistic stimuli. The two simulation scenarios described in\\n were employed here. Visual inspection of the results, as presented in the bottom two heatmaps and the red time courses\\non  and , revealed that the activity-inducing\\nsignal estimated by msPFM closely resembled the ground truth. This was true for both scenarios,\\nwith an unequal and an equal number of subjects per group. msPFM demonstrates proficiency in\\nestimating prolonged activity-inducing signals owing to the adequacy of using a model that\\nestimates the innovations, albeit with relatively lower accuracy in capturing shorter, transient\\nactivations (we refer the reader to [@Urunuela2023HemodynamicDeconvolutionDemystified] for an\\nin-depth comparison between models based on the activity-inducing signal --the spike model-- or the\\ninnovations --the block model). Furthermore, the influence of the $\\\\ell_{2,1}$-norm (see\\nEq. %s is conspicuous in the estimation of group four, which\\nlacks simulated activity-signal. In this case, artifacts originating from the estimates of the\\nremaining groups are noticeable, yet these artifacts are relatively minor compared to the estimated\\nactivity-inducing signals of the other groups. In addition, the estimated signals for these\\nsubjects never return to zero, making it unlikely that they represent any neuronal-related activity\\nand easily identifiable as artefacts. These results are consistent for both scenarios. Hence, based\\non the simulations, msPFM can pinpoint events that trigger shared and individualized neuronal\\nresponses without knowing their timings.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b03c03aa-6bef-463a-895b-1de05fe938e5":{"__data__":"{\"id_\":\"b03c03aa-6bef-463a-895b-1de05fe938e5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"67ac050e-3c1b-474a-ade2-3fd9b6d14beb\",\"metadata\":{},\"hash\":\"hjCGf2fF6bkVPSXi2VPkDgE6TAXXAVv7TiuKqqpXwdY=\"}},\"hash\":\"z/qjrjrewoEMaTT5oYVkmaeQ8rpd/pn6wdM54yrJDAE=\",\"text\":\"### PopSync+ Proof of Concept: Individual and Group Responses to Naturalistic Stimuli\\n\\n```{figure} figures/multi_subject/time_speech.png\\n:align: center\\n:label: fig-time-series-speech\\n\\nTime series of the estimated activity-inducing signal for each\\nsubject in the left middle temporal gyrus (Brodman 21 area) for the\\n*Iteration* (top) and *Sherlock* (bottom) datasets. The black\\nlines represent the speech events in the movie. The red lines represent the\\nPopSync+, i.e., the sum across subjects of the activity-inducing signal that\\nevokes a positive BOLD response in each parcel. Representative instances of the\\nmovies and their respective Speech and PopSync+ TRs are shown for both\\ndatasets. ```\\n\\n```{figure} figures/multi_subject/time_luminance.png\\n:align: center\\n:label: fig-time-series-luminance\\n\\nTime series of the estimated activity-inducing signal for each\\nsubject in V1 for the *Iteration* (top) and *Sherlock* (bottom)\\ndatasets. The black lines represent the changes in luminance in the movie. The\\nred lines represent the PopSync+, i.e., the sum across subjects of the\\nactivity-inducing signal that evokes a positive BOLD response in each parcel. Representative instances of the movies and their changes in luminance and\\nPopSync+ TRs are shown for both datasets. ```\\n\\n and  show a proof of concept of the\\nPopSync+ metrics and the individual differences in the estimated activity-inducing signal. In fact,\\nthe thinner time series in both datasets clearly demonstrate the presence of individual differences\\nin the msPFM estimates of each subject, ehich are consistly observed in the two examples of the\\nleft middle temporal gyrus (Brodman area 21) and the V1 visual area. Notably, the PopSync+ time\\nseries (depicted in red) displays a pronounced alignment with speech events occurring in the movies\\n(depicted in black). This alignment is particularly prominent in the context of *Sherlock*, wherein\\nthe episode encompasses a notably higher frequency of speech events compared to *Iteration*. In the\\ncase of the latter, msPFM not only captures the speech events but also identifies additional neural\\ndynamics during non-speech periods in this ROI. illustrates the\\nsynchrony between changes in the luminance of the movies and the PopSync+ in V1. Specifically, a\\nstronger alignment is observed in the case of *Iteration*, where the changes in luminance exhibit\\ngreater extremes compared to the case of *Sherlock*, which is also reflected in the estimated\\nneuronal response in V1 and hence the PopSync+ measure.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d55d596e-d7ee-47f1-8ac9-d7ea07b441ab":{"__data__":"{\"id_\":\"d55d596e-d7ee-47f1-8ac9-d7ea07b441ab\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9cdf290e-9390-4255-a0a4-c16b22b1544b\",\"metadata\":{},\"hash\":\"FDFO8gljr72SNIzMXWRqqzXp4gqRgFYdCRj64t64iUw=\"}},\"hash\":\"USM5vhmI36bZgrwops+cYihByYg/sEVT0nh8l5hp8gQ=\",\"text\":\"### Comparison with Hidden Markov Models and Inter-Subject Correlation\\n\\n```{figure} figures/multi_subject/event_rate.png\\n:align: center\\n:label: fig-event-rate\\n\\nEvent rate for the *Iteration* (left) and *Sherlock*\\n(right) datasets. The event rate maps obtained with the HMM (top) and msPFM\\nalgorithms (bottom) are compared. The bottom row shows the differences in values\\nbetween msPFM and the HMM approach. ```\\n\\n```{figure} figures/multi_subject/inter_subject.png\\n:align: center\\n:label: fig-isc\\n\\nInter-subject correlation for the *Iteration* (left) and\\n*Sherlock* (right) datasets. The inter-subject correlation obtained with\\nmsPFM (bottom) is compared with the inter-subject correlation obtained with the\\nclassic approach (top). The bottom row shows the differences in values between\\nmsPFM and the classical ISC approach. ```\\n\\nAs shown in , the event rates of both HMM and msPFM for the *Iteration*\\ndataset show a posterior-to-anterior cortical gradient with a higher frequency of events in\\nposterior, sensory regions and slower rates in anterior, higher-order regions. This gradient is\\nconsistent with previous findings in the literature [@SavaSegal2022Individualvariabilityneural]. However, the scatter plots in the bottom row illustrate that the difference in event rates between\\nposterior and anterior regions is less pronounced in the case of msPFM as compared with the HMM. This discrepancy can be attributed to the divergent definitions of what an event is for the two\\nmethods. The HMM approach identifies states that are expected to persist for a specific number of\\ntime points, while the msPFM algorithm captures \\\"punctate\\\" events that can be directly associated\\nwith individual moments in the stimulus. As a consequence, the msPFM algorithm is expected to\\ndetect a greater number of events, particularly in anterior regions. In the context of the\\n*Sherlock* dataset, it is worth noting that the event rate is noticeably lower when calculated with\\nHMM, and consequently, the cortical gradient is less apparent. On the other hand, the msPFM event\\nrate demonstrates values similar to *Iteration* and reveals a more distinct cortical gradient. When\\nit comes to the inter-subject correlation, the two maps and their values were remarkably similar as\\nshown in , indicating that msPFM is able to recover this same sensory-association\\ngradient, with subjects being more synchronized with one another lower-order regions, while being\\nmore idiosyncratic in higher-order regions.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e4734498-b7d7-4d03-a3a5-886d448a7bdd":{"__data__":"{\"id_\":\"e4734498-b7d7-4d03-a3a5-886d448a7bdd\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"68b21055-1e08-49cd-a3fe-d83908b8de55\",\"metadata\":{},\"hash\":\"ZOcCV805mHI1K7PP9Gfki7XMIEv408xp/0Ec6qU3Dg8=\"},\"NEXT\":{\"nodeId\":\"a16b0ab5-16bc-4a6a-8a4e-959dcb8f4c33\",\"metadata\":{},\"hash\":\"TR+BZ5Kzy9UsvgNF23LXb6aY1diFvsrIOdvt1c1V6FI=\"}},\"hash\":\"G0kF+i/MoPEjSBcqfEIqtQUXgjW7+YJ01/JfeVIJHSo=\",\"text\":\"### Benchmark Against Low- and Mid-Level Movie Features\\n\\n```{figure} figures/multi_subject/low_order_luminance.png\\n:align: center\\n:label: fig-low-order-luminance\\n\\nCorrelation between the PopSync+ and low-level features of the\\nmovie with luminance on the left and its derivative on the right. Significant regions are highlighted by a black contour, while\\nnon-significant regions are displayed with increasing transparency as the\\ncorrelation values are further from the significance threshold. The\\ncorrelation maps are shown for the *Iteration* (top) and\\n*Sherlock* (bottom) datasets. The time courses below depict the\\nluminance (lighter color) and its derivate (darker color) for\\n*Iteration* (blue) and *Sherlock* (red). ```\\n\\n```{figure} figures/multi_subject/low_order_audio.png\\n:align: center\\n:label: fig-low-order-audio\\n\\nCorrelation between the PopSync+ and low-level features of the\\nmovie with luminance and its derivative on the left, and the audio envelope\\nand its derivative on the right. Significant regions are highlighted by a\\nblack contour, while non-significant regions are displayed with increasing\\ntransparency as the correlation values are further from the significance\\nthreshold. The correlation maps are shown for the *Iteration* (top)\\nand *Sherlock* (bottom) datasets. The time courses of the audio\\nenvelope (lighter color) and its derivate (darker color) are shown in blue\\nfor *Iteration* and in red for *Sherlock*. ```\\n\\nThe results of the correlation analysis with the low- and mid-level movie features are shown in\\n, ,  and\\n respectively. In terms of luminance, our observations reveal contrasting patterns between *Sherlock* and\\n*Iteration* in regions of the visual cortex. While *Sherlock* demonstrates a positive\\ncorrelation, indicating a relationship between luminance and brain activity, *Iteration*\\nexhibits a negative correlation in the same regions. Conversely, when examining changes in\\nluminance (i.e., the derivative of the luminance time course), both datasets display a positive\\ncorrelation within the visual cortex. These findings can be interpreted as a consequence of the\\nluminance adaptation in *Iteration*. The movie predominantly features very bright scenes,\\noccasionally transitioning to dark moments as shown in the blue time courses at the bottom left of\\n. In contrast, *Sherlock* contains more diverse scenes in\\nmultiple locations, thereby exhibiting a greater range of luminance with both the luminance and its\\nderivative being very similar (see red time courses in the bottom left of\\n). The audio envelope analysis reveals a noteworthy positive correlation within regions of the\\nauditory cortex for both datasets, with a more pronounced correlation observed in\\n*Iteration*. Examination of audio envelope variations, i.e., the derivate of the audio\\nenvelope, further demonstrates a robust positive correlation within the auditory cortex for both\\ndatasets. In this case, both the audio envelope and its derivate showed a very similar pattern (see\\nred and blue time courses in the bottom right of ). This underscores the\\nability of msPFM to accurately capture the intricate neural dynamics associated with the auditory\\ncomponent of the movies. ```{figure} figures/multi_subject/mid_order_speech_hands.png\\n:align: center\\n:label: fig-mid-order-speech-hands\\n\\nCorrelation between the PopSync+ and mid-level features of the movie\\nwith the presence of speech on the left and hands on the right. Significant\\nregions are highlighted by a black contour, while non-significant regions are\\ndisplayed with increasing transparency as the correlation values are further\\nfrom the significance threshold. The correlation maps are shown for the\\n*Iteration* (top) and *Sherlock* (bottom) datasets. The time\\ncourses below depict the presence of speech (lighter color) and hands (darker\\ncolor) for *Iteration* in blue and *Sherlock* in red. ```\\n\\n```{figure} figures/multi_subject/mid_order_faces.png\\n:align: center\\n:label: fig-mid-order-faces\\n\\nCorrelation between the PopSync+ and mid-level features of the movie\\nwith the presence of faces on the left and its derivative on the right. Significant regions are highlighted by a black contour, while non-significant\\nregions are displayed with increasing transparency as the correlation values are\\nfurther from the significance threshold. The correlation maps are shown for the\\n*Iteration* (top) and *Sherlock* (bottom) datasets.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a16b0ab5-16bc-4a6a-8a4e-959dcb8f4c33":{"__data__":"{\"id_\":\"a16b0ab5-16bc-4a6a-8a4e-959dcb8f4c33\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"68b21055-1e08-49cd-a3fe-d83908b8de55\",\"metadata\":{},\"hash\":\"ZOcCV805mHI1K7PP9Gfki7XMIEv408xp/0Ec6qU3Dg8=\"},\"PREVIOUS\":{\"nodeId\":\"e4734498-b7d7-4d03-a3a5-886d448a7bdd\",\"metadata\":{},\"hash\":\"G0kF+i/MoPEjSBcqfEIqtQUXgjW7+YJ01/JfeVIJHSo=\"}},\"hash\":\"TR+BZ5Kzy9UsvgNF23LXb6aY1diFvsrIOdvt1c1V6FI=\",\"text\":\"The time\\ncourses of the presence of faces (lighter color) and its derivate (darker color)\\nare shown in blue for *Iteration* and red for *Sherlock*. ```\\n\\nNext, mid-level movie features were examined, including the presence of speech as well as hands and\\nfaces onscreen. Significantly, it can be observed that msPFM adeptly captures the intricate neural\\ndynamics linked to speech in both datasets, revealing large correlations in expected areas of the\\nsuperior temporal gyrus, Heschl's gyrus, middle temporal and inferior frontal gyrus, all of them\\nbilaterally. These maps demonstrate the adaptability of msPFM to capture varying amounts of speech\\npresent in the respective movies. This adaptability is particularly pronounced in the context of\\n*Iteration*, characterized by a scarcity of speech compared to *Sherlock*---a movie\\nabundant in speech- as shown in the time courses in the bottom left of\\n. Notwithstanding this discrepancy, msPFM reliably captures the\\nneural dynamics associated with speech in language-related areas, reaffirming its efficacy. Furthermore, positive correlation between the msPFM-estimated activity-inducing signal and the\\npresence of hands in the movies can also be observed in bilateral sensorimotor regions around the\\ncentral sulcus. In the context of *Iteration*, the correlation was observed prominently\\nwithin regions of the somatosensory cortex (i.e. postcentral gyrus) and supplementary motor areas,\\nwhile *Sherlock* exhibited correlation within more anterior regions in the motor cortex\\n(i.e. precentral gyri). These findings could potentially be explained by the contrasting\\ncomposition of *Iteration* and *Sherlock*. While *Iteration* predominantly\\nincorporates hands in relation to other objects or the main character's actions (see the high\\nfrequency in the blue time course at the bottom left of ), it\\nfeatures fewer hands-only shots. On the other hand, *Sherlock* exhibits a higher frequency\\nof hands-only shots (though few across the entire movie as shown in red in the bottom left time\\ncourse in ), which may account for the aforementioned findings. Finally, as shown in , correlation between the PopSync+ time-series and\\nthe presence of faces was found in the *Iteration* movie in the left middle temporal gyrus,\\na region associated with facial familiarity [@Zhen2013HierarchicalBrainNetwork], and the\\nposterior superior temporal sulcus, a region associated with the processing of gaze and expression\\n[@Baseler2012NeuralResponsesExpression]. This finding aligns with the movie's nature, as\\n*Iteration* predominantly features a single character and contains several headshots where\\nviewers have their eyes locked on the character's eyes and can see her facial expression. No\\nsignificant or substantial correlation between the PopSync+ measure and the presence of faces was\\nfound in the movie in the *Sherlock* dataset. However, when focusing on changes in faces\\nspecifically within the *Sherlock* dataset, a positive correlation was observed in the\\nfusiform gyrus, a region associated with face recognition\\n[@Kanwisher1997FusiformFaceArea;@Kanwisher2006fusiformfacearea;@Rossion2003functionallydefinedright]\\nInterestingly, this correlation with changes in faces was not as strong when examining changes in\\nfaces for *Iteration*. These contrasting findings may be attributed to the distinctive\\ncharacteristics of the movies. In *Sherlock*, which showcases multiple characters and their\\nfacial expressions during dialogue, the adaptation or identification of faces may play a role (see\\nlong periods of changing faces in the red time courses at the bottom of\\n). On the contrary, *Iteration* primarily focuses on a single\\ncharacter, suggesting an fMRI adaptation effect in fusiform face areas, i.e. a lower response to an\\nidentically repeated face than to new faces\\n[@Gauthier2001developmentfaceexpertise;@Yovel2004FacePerception;@Avidan2010Corticalnetworksmediating;@Eger2005Familiarityenhancesinvariance;@Pourtois2005Twoelectrophysiologicalstages;@Rotshtein2004MorphingMarilynMaggie]. Overall, these analyses showcase the potential of msPFM in capturing the activity linked to lower-\\nand mid-level stimulus features within anticipated brain regions and timeframes, even without prior\\nknowledge of event timings and regardless of the stimulus itself. Furthermore, these findings\\nhighlight the ability of msPFM to identify additional stimulus-specific regions associated with the\\nintricate and distinctive content inherent to each stimulus. (sec-multi-subject-discussion)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"f100b6c7-e228-4b94-87c7-75401fda1da3":{"__data__":"{\"id_\":\"f100b6c7-e228-4b94-87c7-75401fda1da3\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ed0c81f8-7407-4511-9e8c-816f3aa141a1\",\"metadata\":{},\"hash\":\"YLRhQFu7cR5tymCeP9+W4VuDdvuG4W35PZZSFr5ifC8=\"},\"NEXT\":{\"nodeId\":\"595b862f-40cf-476e-8d4e-6685bbedc28a\",\"metadata\":{},\"hash\":\"H1nJnrC3o9/8Wu0/3k0pmHueGJakoYQoPxGU4qaaSfo=\"}},\"hash\":\"oopSO0lIQU7RvS/PeI+Izwk6XVWSARP6Z3VCUQT405I=\",\"text\":\"## Discussion\\n\\nThe potential of multi-subject Paradigm Free Mapping (msPFM) to detect and elucidate\\nmoment-to-moment spatio-temporal neural activity patterns evoked by naturalistic stimuli has been\\nshowcased using simulations and two experimental datasets. While previous investigations have\\nemployed alternative approaches, such as hidden Markov models (HMM)\\n[@Baldassano2017DiscoveringEventStructure], greedy state boundary search (GSBS)\\n[@Geerligs2021Detectingneuralstate], inter-subject correlation\\n[@Nastase2019Measuringsharedresponses] or dynamic functional connectivity\\n[@Di2020Intersubjectconsistentdynamic], these methods operate on a limited number of regions of\\ninterest (ROIs) and condense the temporal dynamics of the BOLD signal into states or connectivity\\npatterns that encompass a time period exceeding the acquired data's temporal resolution. Consequently, the results shown here highlight the unparalleled potential of msPFM to operate at\\nthe utmost temporal and spatial precision achievable. Importantly, msPFM was validated by comparing it against other common algorithms used to assess\\nnaturalistic fMRI data, such as Hidden Markov Models (HMM) and intersubject correlation (ISC). First, the event-rate analysis shown in  revealed a distinct cortical\\ngradient, characterized by faster event rates in posterior sensory regions and slower rates in\\nanterior higher-order regions. These results align with previous findings on neural event\\nboundaries across subjects and the segmentation of events using HMM\\n[@Baldassano2017DiscoveringEventStructure;@SavaSegal2022Individualvariabilityneural], which\\ncould support the idea that the brain's cortical organization is arranged hierarchically, with\\nsensory inputs passing through unimodal areas and being abstracted into broader conceptual and\\ncognitive representations in transmodal areas\\n[@Bernhardt2022Gradientsbrainorganization;@Margulies2016Situatingdefaultmode;@Samara2023Corticalgradientsnaturalistic]. However, msPFM offers several advantages over the HMM-based approach. First, the HMM method\\nrequires specifying a desired number of events ($k$) for each region. While there are data-driven\\nways to estimate an appropriate value for $k$ at the group level, these require additional\\ncomputational time and power, and are not straightforward to implement for individual subjects. In\\ncontrast, msPFM does not require pre-specifying any value of $k$, and instead recovers individual\\nneuronal-related events at both the group and individual level. Furthermore, the HMM model assumes\\nthat each \\\"state\\\" exhibits a unique neural activity signature that changes at state boundaries,\\nwhich may not hold true universally, as certain brain regions could potentially revert to previous\\nor new states inside this perdiod. In contrast, msPFM applies no restriction on the number and\\nduration of the neural activity patterns that can be detected, thereby providing a more\\ncomprehensive representation of the brain's spatio-temporal dynamics. The crucial distinction is\\nthat the HMM approach identifies events or states that persist for a specific duration, whereas the\\nmsPFM technique retrieves discrete instances of neuronal-related BOLD activity, which can be\\ndirectly associated with individual moments in the stimulus. Another important distinction is the\\ncomputational cost needed to analyse data with each of the two techniques. In fact, while finding\\nthe appropiate number of events with HMM can take $>24$h at the single-subject level with 1000 ROIs\\nusing a high performance computing server with up to 512GB of RAM available, finding estimates of\\nthe activity-inducing signal and counting the number of events with msPFM only took between 5 and\\n10 minutes. Furthermore, techniques like HMM and inter-subject correlation are not specifically designed to\\ndetect activity evoked by the stimulus in different brain regions, but rather to identify regions\\nthat encode stimulus-related information consistently across multiple individuals\\n[@Nastase2019Measuringsharedresponses]. In contrast, msPFM can detect moment-to-moment neuronal\\nresonses not only shared across subject, but also distinguish patterns occurring in individual\\nsubjects. By correlating the recovered population synchrony with features of the movies,\\n, ,  and\\n show that msPFM is able to detect neuronal activity driven by both low-\\nand mid-level features of the stimulus in both primary sensory and higher-order brain regions.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"595b862f-40cf-476e-8d4e-6685bbedc28a":{"__data__":"{\"id_\":\"595b862f-40cf-476e-8d4e-6685bbedc28a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ed0c81f8-7407-4511-9e8c-816f3aa141a1\",\"metadata\":{},\"hash\":\"YLRhQFu7cR5tymCeP9+W4VuDdvuG4W35PZZSFr5ifC8=\"},\"PREVIOUS\":{\"nodeId\":\"f100b6c7-e228-4b94-87c7-75401fda1da3\",\"metadata\":{},\"hash\":\"oopSO0lIQU7RvS/PeI+Izwk6XVWSARP6Z3VCUQT405I=\"}},\"hash\":\"H1nJnrC3o9/8Wu0/3k0pmHueGJakoYQoPxGU4qaaSfo=\",\"text\":\"Particularly, fMRI adaptation to the stimulus [@GrillSpector2001fMRadaptationtool] may be present\\nin some features such as luminance, with the visual cortex mostly showing activity in response to\\nchanges in the luminance in *Iteration* probably due to the increased contrast associated with\\nthese changes [@Goodyear1998EffectLuminanceContrast]; or the presence of faces, with *Iteration*\\nhaving a single character and no reliable face-related activity in the fusiform gyrus as opposed to\\n*Sherlock* and the many characters in the clip, where the fusiform gyrus showed correlation with\\nchanges in faces\\n[@Kanwisher1997FusiformFaceArea;@Kanwisher2006fusiformfacearea;@Rossion2003functionallydefinedright]. The case of *Sherlock* is particularly challenging because faces are always closely followed by\\nspeech, which is a stronger effect and can hide the response to the presence of faces\\n[@Vega2022Neuroscoutunifiedplatform]. While this study introduces a novel approach for analyzing naturalistic fMRI data, there is\\npotential for further enhancements. Adopting a data-driven strategy like stability selection\\n[@Meinshausen2010Stabilityselection;@Urunuela2024Wholebrainmultivariate] could eliminate the\\nneed for manually selecting the regularization parameter. By adopting such an approach, not only\\nwould the method's robustness be enhanced, but it would also enable estimation of the probability\\nof neuronal-related events at each TR, subject, and voxel or ROI. Additionally, the utilization of\\noptimal transport methods could further refine the spatial differentiation of shared and\\nindividualized patterns by improving its robustness against anatomical (spatial) and hemodynamic\\n(temporal) variability between subjects [@Janati2020MultisubjectMEG/EEG]. Nevertheless, the\\ncurrent methodology adequately demonstrates the potential of msPFM-alike approaches in\\ninvestigating the brain's spatio-temporal dynamics during naturalistic stimuli. For instance, msPFM\\noffers a valuable approach to unraveling the precise neural mechanisms involved in event\\nsegmentation. It can be employed independently or in conjunction with other techniques such as HMM\\nor GSBS to gain an understanding of the timescale for memory encoding, as well as the continuous\\nupdating or encoding of memory fragments following the completion of an event\\n[@Baldassano2017DiscoveringEventStructure;@Silva2019RapidMemoryReactivation]. Moreover, novel\\nresearch utilizing msPFM could be aimed at comprehending how the human brain comprehends these\\ncomplex multiplexed signals and understanding the specific features of the stimulus that elicit\\nresponses in the human brain. Finally, the proposed method has the potential to elucidate the\\nconnection between individual differences in these responses and subsequent memory formation or\\nappraisal of the stimulus. (sec-multi-subject-github)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"0cee4698-d90d-4880-896f-2354846c34c2":{"__data__":"{\"id_\":\"0cee4698-d90d-4880-896f-2354846c34c2\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d694b5b3-b872-47f3-8d98-ae0af440a12e\",\"metadata\":{},\"hash\":\"lipTw/MWblyS8uuaf5aXOa6TSia8Y5SzD37uJR7zCc0=\"}},\"hash\":\"UVdkl9SmhynUaFMTbsn7xsn65uGlZWNhz6drVxvrQ+4=\",\"text\":\"## Code and data availability\\n\\nThe code and materials used to generate the figures in this work can be found in the following\\nGitHub repository:\\nhttps://github.com/eurunuela/msPFM_paper. The *msPFM* Python package is available in the following GitHub repository:\\nhttps://github.com/ParadigmFreeMapping/msPFM.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"831c960a-f494-4d1b-8bb0-ce976a3e5707":{"__data__":"{\"id_\":\"831c960a-f494-4d1b-8bb0-ce976a3e5707\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ba4a2f7f-a52c-4add-923c-9ab1ad613223\",\"metadata\":{},\"hash\":\"k8M92SPDPv43aOvD9dH1trNrNGhUGZejAXSOOX7aM0c=\"}},\"hash\":\"WUtZlt/Fosdfb9dPE1czl3sZFeOCOQbmGjiadOK7068=\",\"text\":\"# Chapter 4: Whole-Brain Multivariate Deconvolution for Multi-Echo Functional MRI\\n\\nThis chapter was published as @Urunuela2024Wholebrainmultivariate. This chapter proposes a novel hemodynamic deconvolution algorithm, multivariate sparse paradigm\\nfree mapping (Mv-SPFM), that operates at the whole brain level and adds spatial information via a\\nmixed-norm regularization term over all voxels. Additionally, Mv-SPFM employs the stability\\nselection procedure that removes the need to select regularization parameters and also lets us\\nobtain an estimate of the true probability of having a neuronal-related BOLD event at each voxel\\nand time-point based on the area under the curve (AUC) of the stability paths. Besides, its\\nformulation is adapted for multi-echo fMRI acquisitions (MvME-SPFM), which allows us to better\\nisolate fluctuations of BOLD origin on the basis of their linear dependence with the echo time (TE)\\nand to assign physiologically interpretable units (i.e., changes in the apparent transverse\\nrelaxation $\\\\Delta R_2^*$) to the resulting deconvolved events. Remarkably, Mv-SPFM also achieves\\ncomparable performance when using a conventional single-echo formulation. The MV-SPFM algorithm\\noutperforms previous hemodynamic deconvolution approaches, showing higher spatial and temporal\\nagreement with the activation maps and BOLD signals obtained with a standard model-based linear\\nregression approach. Furthermore, owing to the stability selection, the proposed algorithm provides\\nmore reliable estimates of neuronal-related activity for the study of the dynamics of brain\\nactivity when no information about the timings of the BOLD events is available. This algorithm is\\npublicly available as part of the *splora* Python package at\\nhttps://github.com/ParadigmFreeMapping/splora. (sec-multivariate-introduction)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"32e2bd1e-1101-4660-9bb8-44c04cd54c0d":{"__data__":"{\"id_\":\"32e2bd1e-1101-4660-9bb8-44c04cd54c0d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"c782893e-78de-4a88-837b-55dff5d9bb5d\",\"metadata\":{},\"hash\":\"0cAIcfJfnLZTTSNDSr9rGe/t+SkSisVGxetVrHZjXcA=\"}},\"hash\":\"wa6Xy2qp1xq+GhT/wICu4qAcdWVMOGX13HIt97OWGCk=\",\"text\":\"## Introduction\\n\\nConventionally, the analysis of functional MRI (fMRI) data relies on available information about\\nthe experimental paradigm to establish hypothesized models of brain activity. However, this\\ninformation can be inaccurate, incomplete or unavailable in multiple scenarios such as\\nresting-state, naturalistic paradigms or clinical conditions. In these cases, blind estimates of\\nneuronal-related activity can be obtained with paradigm-free analysis methods such as hemodynamic\\ndeconvolution. Yet, current formulations of the hemodynamic deconvolution problem have three\\nimportant limitations: 1) their efficacy strongly depends on the appropriate selection of\\nregularization parameters, 2) being univariate, they do not take advantage of the information\\npresent across the brain, and 3) they do not provide any measure of statistical certainty\\nassociated with each detected event. Wouldn't it be nice to have a probability of having an event at each time-point and for each voxel? Despite the range of deconvolution methods that have been developed, few capitalize on the various\\nproperties of fMRI data, such as the advantages of multi-echo fMRI for denoising fMRI data\\n[@Bright2013Removingmotionphysiological;@Kundu2017MultiechofMRI], or the use of tissue-based or\\nparcellation-based information to improve the accuracy of the estimates of neuronal activity. Recent exceptions include deconvolution algorithms that incorporate a multivariate formulation to\\nperform spatio-temporal deconvolution\\n[@Bolton2019StructurallyInformedDeconvolution;@Urunuela2021LowRankSparse;@Costantini2022Anisotropic4DFiltering;@Cherkaoui2021Multivariatesemiblind],\\nthus addressing the second limitation stated in the previous paragraph. In addition, one\\ndeconvolution algorithm has been presented that exploits the mono-exponential decay model of the\\nmulti-echo fMRI signal: multi-echo sparse Paradigm Free Mapping (ME-SPFM)\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti]. Furthermore, approaches have been developed to\\ndeal with the third limitation stated above and estimate the likelihood of having a neuronal event\\nat each time-point and for each voxel by means of logistic regression\\n[@Bush2013Decodingneuralevents;@Bush2015ImprovingprecisionfMRI] or Gaussian mixture models\\n[@Pidnebesna2019EstimatingSparseNeuronal]. However, wouldn't it be desirable to have an algorithm\\nthat addresses all three limitations mentioned above? Specifically, it would be beneficial to\\nobtain a measure of the probability of each voxel containing a neuronal event at each time-point\\nusing regularized estimators, while also leveraging the spatio-temporal information and physical\\nproperties of the fMRI signal for estimating the activity-inducing signal. This chapter proposes a novel approach for the hemodynamic deconvolution of fMRI data that operates\\nat the whole-brain level (i.e., multivariate formulation) to incorporate spatial information\\nthrough a mixed-norm regularization term. Furthermore, this work proposes a stability selection\\nprocedure [@Meinshausen2010Stabilityselection] that makes the estimation of the neuronal\\nactivity more robust to the selection of the regularization parameters, while providing the\\nlikelihood of having a neuronal-related event at each time-point and for each voxel. Using\\nmulti-echo fMRI data acquired from 10 healthy subjects (16 datasets) this chapter demonstrates that\\nthe proposed multivariate multi-echo Paradigm Free Mapping (MvME-SPFM) algorithm not only provides\\nmore robust estimates of the neuronal activity, but also yields a measure of the probability of\\neach voxel containing a neuronal event at each time-point. Moreover, MvME-SPFM returns quantitative\\nestimates of $\\\\Delta R_2^*$ in interpretable units (s$^{-1}$), which is relevant for functional\\nanalysis across different acquisition methods and field strengths. The chapter is structured as\\nfollows: the multivariate signal model and the multivariate multi-echo PFM algorithm are introduced\\nin ;  describes the data used and the\\nanalysis performed to evaluate this novel algorithm; the results of applying this new algorithm on\\nexperimental fMRI data are presented and compared to the previous PFM algorithms in\\n; finally, the findings are discussed in\\n. (sec-multivariate-theory)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b7816421-55a9-41ec-83e6-542dd4267a8b":{"__data__":"{\"id_\":\"b7816421-55a9-41ec-83e6-542dd4267a8b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"79e4ce61-65d2-4972-84fc-dc3c7fc52098\",\"metadata\":{},\"hash\":\"a3uNR4IxiJhsOBHDXYzYdYr5ulaLJQP3pIcuIGwCGaY=\"}},\"hash\":\"GPqctFcVZk33yASfhVQo1PnkE1p1Hh/dSCaUw7BxYX0=\",\"text\":\"## Theory\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8f073552-7405-42af-8c55-ee15c6b7df3e":{"__data__":"{\"id_\":\"8f073552-7405-42af-8c55-ee15c6b7df3e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"e9648ef8-bad2-4433-a267-81248878b5f0\",\"metadata\":{},\"hash\":\"XXnV7nMDNteWVMSeZRJqToM1cl7KakbI12maQbNuhxE=\"},\"NEXT\":{\"nodeId\":\"5eb85e29-31a3-413b-b473-0bb2b9c1f38b\",\"metadata\":{},\"hash\":\"g9FD0Jj+dqzjIfNRjArz8OF3QFeWesemjhvBk3U5vv0=\"}},\"hash\":\"Gdt0yHLvvGamCD2xvme5hRKBnJALbnw0XtRMVFiUPSI=\",\"text\":\"### Signal Model for Whole-Brain Deconvolution\\n\\n introduced that the BOLD fMRI signal model of a particular voxel can\\nbe written in matrix notation as:\\n\\n```{math}\\n:label: eq-signal-model\\n\\\\mathbf{y} = \\\\mathbf{H}\\\\Delta\\\\mathbf{s} + \\\\mathbf{e}\\n```\\n\\nwhere, assuming zero-boundary conditions, the variables $\\\\mathbf{y}$, $\\\\Delta \\\\mathbf{s}$,\\n$\\\\mathbf{e} \\\\in \\\\mathbb{R}^N$ are the voxel's time-series, the activity-inducing signal changes and\\nthe noise term, respectively, and $\\\\mathbf{H} \\\\in \\\\mathbb{R}^{N \\\\times N}$ is the Toeplitz\\nconvolution matrix defined by the HRF\\n[@Gitelman2003Modelingregionalpsychophysiologic;@Gaudes2013Paradigmfreemapping]. Hereinafter in\\nthe chapter, the noise term is assumed to be an additive white Gaussian noise (i.e., uncorrelated). Furthermore, the $\\\\Delta \\\\mathbf{s}$ can be defined in a finer temporal resolution (i.e.,\\nincreasing its dimension by a factor $\\\\alpha>1$ such that $\\\\Delta \\\\mathbf{s} \\\\in \\\\mathbb{R}^{\\\\alpha\\nN}$) so that it can describe activity-inducing signal changes that are asynchronous to the TR of\\nthe data. Though in such scenario, the convolution matrix becomes non-Toeplitz (i.e. $\\\\mathbf{H}\\n\\\\in \\\\mathbb{R}^{N \\\\times \\\\alpha N}$) [@Ciuciu2003Unsupervisedrobustnonparametric]. The previous signal model is applicable for single-echo and multi-echo fMRI data. In the particular\\ncase of multi-echo fMRI acquired with a gradient-echo sequence, the voxel's time-series in terms of\\nthe signal percentage change has a linear relationship with the echo time (TE) as\\n$y(\\\\mathrm{TE}_k,n) \\\\approx \\\\Delta \\\\rho(n) - \\\\mathrm{TE}_k \\\\Delta R_2^*(n)$, where $\\\\Delta\\nR_2^*(n)$ denotes the BOLD-like signal changes and $\\\\Delta \\\\rho(n)$ corresponds to changes in the\\nnet magnetization, for instance due to head motion [@Kundu2017MultiechofMRI]. The signal\\nchanges associated to fluctuations in the net magnetization can be effectively reduced in\\npreprocessing, for example using multi-echo independent component analysis\\n[@Kundu2012DifferentiatingBOLDnon;@CaballeroGaudes2019deconvolutionalgorithmmulti], and are\\nneglected hereinafter. Hence, considering that neuronal-related signal changes $\\\\Delta\\\\mathbf{s}$\\nproduce a change in $\\\\Delta R_2^*$, the signal model in Eq. %s can be adapted\\nto contain the signal acquired at all $K$ echo-times (TE) via concatenation:\\n\\n```{math}\\n:label: eq-univariate-multi-echo-model\\n\\\\left[\\\\begin{array}{c} \\\\mathbf{y}_{1} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    \\\\mathbf{y}_{K}\\n\\\\end{array}\\\\right]\\n=\\n-\\\\left[\\\\begin{array}{c} \\\\mathrm{TE}_{1} \\\\mathbf{H} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    \\\\mathrm{TE}_{K} \\\\mathbf{H}\\n\\\\end{array}\\\\right]\\n\\\\Delta \\\\mathbf{s},\\n```\\n\\nwhich can be simplified into $\\\\bar{\\\\mathbf{y}}=-\\\\overline{\\\\mathbf{H}} \\\\Delta \\\\mathbf{s}$, where\\n$\\\\bar{\\\\mathbf{y}} \\\\in \\\\mathbb{R}^{KN}$, $\\\\Delta \\\\mathbf{s} \\\\in \\\\mathbb{R}^{N}$ and\\n$\\\\overline{\\\\mathbf{H}} \\\\in \\\\mathbb{R}^{KN \\\\times N}$. Assuming that the shape of the hemodynamic response can be similarly modeled across all brain\\nvoxels, the previous voxel-wise (i.e., univariate) model in\\nEq.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"5eb85e29-31a3-413b-b473-0bb2b9c1f38b":{"__data__":"{\"id_\":\"5eb85e29-31a3-413b-b473-0bb2b9c1f38b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"e9648ef8-bad2-4433-a267-81248878b5f0\",\"metadata\":{},\"hash\":\"XXnV7nMDNteWVMSeZRJqToM1cl7KakbI12maQbNuhxE=\"},\"PREVIOUS\":{\"nodeId\":\"8f073552-7405-42af-8c55-ee15c6b7df3e\",\"metadata\":{},\"hash\":\"Gdt0yHLvvGamCD2xvme5hRKBnJALbnw0XtRMVFiUPSI=\"}},\"hash\":\"g9FD0Jj+dqzjIfNRjArz8OF3QFeWesemjhvBk3U5vv0=\",\"text\":\"%s can be extended straightforwardly to a multivariate\\nformulation that considers all the voxels $V$ of the brain:\\n\\n```{math}\\n:label: eq-multivariate-multi-echo-model\\n\\\\begin{bmatrix} \\\\mathbf{y}_{1,1} & \\\\cdots & \\\\mathbf{y}_{1,V} \\\\\\\\\\n    \\\\vdots & \\\\ddots & \\\\vdots \\\\\\\\\\n    \\\\mathbf{y}_{K,1} & \\\\cdots & \\\\mathbf{y}_{K,V}\\n\\\\end{bmatrix}\\n=\\n-\\n\\\\begin{bmatrix}\\n    \\\\mathrm{TE}_{1} \\\\mathbf{H} \\\\\\\\\\n    \\\\vdots \\\\\\\\\\n    \\\\mathrm{TE}_{K} \\\\mathbf{H}\\n\\\\end{bmatrix}\\n\\\\begin{bmatrix}\\n    \\\\Delta \\\\mathbf{s}_1 & \\\\cdots & \\\\Delta \\\\mathbf{s}_V \\\\\\\\\\n\\\\end{bmatrix},\\n```\\n\\nwhich can be simplified into $\\\\bar{\\\\mathbf{Y}} = - \\\\bar{\\\\mathbf{H}} \\\\Delta \\\\mathbf{S}$, where\\n$\\\\bar{\\\\mathbf{Y}} \\\\in \\\\mathbb{R}^{KN \\\\times V}$, $\\\\bar{\\\\mathbf{H}} \\\\in \\\\mathbb{R}^{KN \\\\times N}$\\nand $\\\\Delta\\\\mathbf{S} \\\\in \\\\mathbb{R}^{N \\\\times V}$.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"fd7d0c7d-0312-484e-ad99-2eb8a4a062b2":{"__data__":"{\"id_\":\"fd7d0c7d-0312-484e-ad99-2eb8a4a062b2\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141\",\"metadata\":{},\"hash\":\"YRHg+4pG8MUCNTPj1FTyGkMeq7DOSp7PflqqeIvNwEk=\"},\"NEXT\":{\"nodeId\":\"4698fcf2-0439-43a2-bedb-c6a16605f613\",\"metadata\":{},\"hash\":\"ExW7Ycm2qPFUNu4G98X55O70mJVhYDOZCJybryJnTfQ=\"}},\"hash\":\"UxDiMHbtL4dVWWQ+8jXEmK16mkii6pwmKnWcyAgaCAQ=\",\"text\":\"## Solving the Optimization Problem for Whole-Brain Deconvolution\\n\\nAs described in , an estimate of the activity that induces the BOLD\\nresponse $\\\\hat{\\\\mathbf{s}}$ can be obtained by solving an ordinary least-squares problem such as:\\n\\n```{math}\\n:label: eq-univariate-multi-echo-inverse-problem\\n\\\\Delta \\\\hat{\\\\mathbf{s}} = \\\\arg \\\\min_{\\\\mathbf{s}} \\\\frac{1}{2} \\\\| \\\\bar{\\\\mathbf{y}} - \\\\bar{\\\\mathbf{H}} \\\\Delta \\\\mathbf{s} \\\\|_2^2 +\\n\\\\lambda \\\\| \\\\Delta \\\\mathbf{s} \\\\|_1,\\n```\\n\\nwhere $\\\\lambda$ is the regularization parameter that regulates the level of sparsity of the\\nestimates given the $\\\\ell_1$-norm, which is defined as $\\\\| \\\\Delta \\\\mathbf{s} \\\\|_1 =\\n\\\\Sigma_{n=1}^{N} | \\\\Delta \\\\mathbf{s}_n |$. The inverse problem in Eq. %s can be directly adapted\\nto be solved at the whole-brain using the multivariate formulation in\\nEq. %s. More interestingly though, solving the inverse problem\\nat the whole-brain level opens up many possibilities in the form of additional regularization terms\\nto take advantage of the spatial information for an informed estimation of the activity-inducing\\nsignal $\\\\Delta\\\\hat{\\\\mathbf{S}}$. For instance, mixed-norms in the form of $\\\\ell_{p,q}$ can be\\nemployed to separate coefficients into groups that are blind to each other, while the coefficients\\nwithin a group are treated together [@Kowalski2009Sparseregressionusing]. Hence,\\nregularization terms based on mixed-norms can promote spatio-temporal structures that are observed\\nin fMRI signals. Here, an $\\\\ell_{2,1} + \\\\ell_1$ mixed-norm regularization term\\n[@Gramfort2011FunctionalBrainImaging] is added to the multivariate convex problem to promote\\nthe co-activation of the activity-inducing signal $\\\\Delta\\\\hat{\\\\mathbf{S}}$ considering the\\ncoefficients of the voxels of the brain ($V$) at time $n$ as one group:\\n\\n```{math}\\n:label: eq-multivariate-multi-echo-inverse-problem\\n\\\\Delta \\\\hat{\\\\mathbf{S}} = \\\\arg \\\\min_{\\\\mathbf{S}} \\\\frac{1}{2} \\\\| \\\\bar{\\\\mathbf{Y}} - \\\\bar{\\\\mathbf{H}}\\n\\\\Delta \\\\mathbf{S} \\\\|_2^2 + \\\\lambda \\\\rho \\\\| \\\\Delta \\\\mathbf{S} \\\\|_1 + \\\\lambda (1 - \\\\rho) \\\\| \\\\Delta \\\\mathbf{S} \\\\|_{2,1},\\n```\\n\\nwhere $\\\\ell_{2,1}$-norm is defined as $\\\\| \\\\Delta \\\\mathbf{S} \\\\|_{2,1} = \\\\Sigma_{n=1}^{N} \\\\sqrt{\\n\\\\Sigma_{v=1}^{V} \\\\Delta \\\\mathbf{S}_{n,v}^2} $, and $0<\\\\rho<1$ is a parameter that controls the\\ntradeoff between the sparsity introduced by the $\\\\ell_1$-norm and the grouping of voxels promoted\\nby the $\\\\ell_{2,1}$-norm so that the estimation of one voxel coefficient at time $n$ is influenced\\nby the estimates of the rest of the brain voxels at the same time. Note that when $\\\\rho=1$\\nEq. %s is the whole-brain equivalent of\\nEq. %s. Additionally, it is worth noting that\\nmixed-norm regularization, such as group LASSO, has been previously used in MEG/EEG studies\\n[@Gramfort2011FunctionalBrainImaging]. However, in those cases, the spatial and temporal\\ndimensions were swapped compared to Eq. %s.On the\\nother hand, the regularization parameter $\\\\lambda$ can be adapted voxel-wise in order to account\\nfor differences in the signal-to-noise ratio across voxels.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"4698fcf2-0439-43a2-bedb-c6a16605f613":{"__data__":"{\"id_\":\"4698fcf2-0439-43a2-bedb-c6a16605f613\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141\",\"metadata\":{},\"hash\":\"YRHg+4pG8MUCNTPj1FTyGkMeq7DOSp7PflqqeIvNwEk=\"},\"PREVIOUS\":{\"nodeId\":\"fd7d0c7d-0312-484e-ad99-2eb8a4a062b2\",\"metadata\":{},\"hash\":\"UxDiMHbtL4dVWWQ+8jXEmK16mkii6pwmKnWcyAgaCAQ=\"}},\"hash\":\"ExW7Ycm2qPFUNu4G98X55O70mJVhYDOZCJybryJnTfQ=\",\"text\":\"Consequently, the multivariate\\ndeconvolution problem can be written as:\\n\\n```{math}\\n:label: eq-multivariate-multi-echo-inverse-problem2\\n\\\\Delta \\\\hat{\\\\mathbf{S}} = \\\\arg \\\\min_{\\\\mathbf{S}} \\\\frac{1}{2} \\\\| \\\\bar{\\\\mathbf{Y}} - \\\\bar{\\\\mathbf{H}}\\n\\\\Delta \\\\mathbf{S} \\\\|_2^2 + \\\\rho \\\\| \\\\mathbf{D} \\\\Delta \\\\mathbf{S} \\\\|_1 + (1 - \\\\rho) \\\\| \\\\mathbf{D} \\\\Delta \\\\mathbf{S} \\\\|_{2,1},\\n```\\n\\nwhere $\\\\mathbf{D} = \\\\text{diag}\\\\left(\\\\lambda_1, \\\\dots, \\\\lambda_V \\\\right) \\\\in \\\\mathbb{R}^{V \\\\times\\nV}$ is a diagonal matrix with the voxel-specific values of $\\\\lambda$. In practice, a criterion must\\nbe used to select the voxel-specific $\\\\lambda$s. Instead, the use of stability selection to avoid\\nthis critical choice is proposed (see ). Therefore, given the convex nature of the inverse problem in\\nEq. %s, estimates of $\\\\Delta \\\\hat{\\\\mathbf{S}}$ can\\nbe calculated using the fast iterative shrinkage-thresholding algorithm (FISTA)\\n[@Beck2009FastIterativeShrinkage] with the following proximity operator for $\\\\ell_1 +\\n\\\\ell_{2,1}$:\\n\\n```{math}\\n:label: eq-multivariate-multi-echo-proximal-operator\\nS_{n,v} = \\\\frac{Z_{n,v}}{|Z_{n,v}|} \\\\left( |Z_{n,v}| - \\\\lambda_v \\\\rho \\\\right)^+ \\\\left( 1 -\\n\\\\frac{\\\\lambda_v (1 - \\\\rho)}{\\\\sqrt{ \\\\sum_v \\\\left( |Z_{n,v}| - \\\\lambda_v \\\\rho \\\\right)^{+^2} }} \\\\right)^+,\\n```\\n\\nwhere $\\\\Delta \\\\mathbf{S} = \\\\text{prox}_{\\\\lambda \\\\left(\\\\rho \\\\| \\\\cdot \\\\|_1 + \\\\left( 1 - \\\\rho \\\\right)\\n\\\\| \\\\cdot \\\\|_{2,1} \\\\right)}\\\\left(\\\\mathbf{Z} \\\\right) \\\\in \\\\mathbb{R}^{N \\\\times V}$, $\\\\left( x\\n\\\\right)^+ = \\\\max \\\\left( x,0 \\\\right)$ for $x \\\\in \\\\mathbb{R}$, and $\\\\frac{0}{0}=0$ by convention. (sec-multivariate-methods)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a4d77385-a1e8-4eee-91f8-cbf5b52182ad":{"__data__":"{\"id_\":\"a4d77385-a1e8-4eee-91f8-cbf5b52182ad\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"e7951e12-0ba0-45db-9bae-b1d24dd657d8\",\"metadata\":{},\"hash\":\"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc=\"}},\"hash\":\"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=\",\"text\":\"## Methods\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"990fc85c-c433-4d66-b836-9768a580afe5":{"__data__":"{\"id_\":\"990fc85c-c433-4d66-b836-9768a580afe5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"b0f10ec1-a0f9-446d-b37d-c23ca090023f\",\"metadata\":{},\"hash\":\"39S3VKOiYQV2Ce5xG0hugLjpyRzC4QOlnp0mDsO3yqQ=\"}},\"hash\":\"BbTYmODmqHS0mjxKNcmlb8RiMMemW9TB/cMbK8ZwNkU=\",\"text\":\"### fMRI Data Acquisition and Preprocessing\\n\\nThe evaluation of the proposed MvME-SPFM was performed on ME-fMRI data acquired in 10 subjects\\nusing a multi-task rapid event-related paradigm. Six subjects performed two functional runs, the\\nother 4 subjects only performed 1 run due to scanning time constraints (i.e., a total of 16\\ndatasets). All participants gave informed consent in compliance with the NIH Combined Neuroscience\\nInternational Review Board-approved protocol 93-M-1070 in Bethesda, MD. A thorough description of\\nthe MRI acquisition protocols and experimental tasks in the experimental design can be found in\\n[@GonzalezCastillo2016Evaluationmultiecho], only those details that are relevant to this\\nanalysis are given here. MRI data was acquired on a General Electric 3T 750 MRI scanner with a 32-channel receive-only head\\ncoil (General Electric, Waukesha, WI). Functional scans were acquired with a ME gradient-recalled\\nechoplanar imaging (GRE-EPI) sequence (flip angle = $70^\\\\circ$ for 9 subjects, flip angle =\\n$60^\\\\circ$ for 1 subject, TEs = 16.3/32.2/48.1 ms, TR = 2 s, 30 axial slices, slice thickness = 4\\nmm, in-plane resolution = $3\\\\times3$ mm$^2$, FOV 192 mm, acceleration factor 2, number of\\nacquisitions = 220). Functional data was acquired with ascending sequential slice acquisitions,\\nexcept in one subject where the acquisitions were interleaved. In addition, high resolution\\nT1-weighted MPRAGE and proton density images were acquired per subject for anatomical alignment and\\nvisualization purposes (176 axial slices, voxel size = $1\\\\times1\\\\times1$ mm$^3$, image matrix =\\n$256\\\\times256$). Each run of data acquisition consisted of 6 trials with 5 different tasks each: biological motion\\nobservation (BMOT), finger tapping (FTAP), passive viewing of houses (HOUS), listening to music\\n(MUSI), and sentence reading (READ). The reader is referred to that paper for details on the\\npreprocessing steps, and comparison with alternative single-echo models for deconvolution. This\\ndata had previously been employed, preprocessed and ME-ICA denoised for the evaluation of the\\nME-SPFM algorithm in [@CaballeroGaudes2019deconvolutionalgorithmmulti]. (sec-multivariate-stability-selection)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"12b261eb-72fd-4a12-a7dc-569a8c4914e3":{"__data__":"{\"id_\":\"12b261eb-72fd-4a12-a7dc-569a8c4914e3\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d3314be8-9071-4d3d-9790-8056c9f6153b\",\"metadata\":{},\"hash\":\"sO/8qAdT0jnimLC+eyO54kmMVPWv2iBO2gn1sn/2luY=\"},\"NEXT\":{\"nodeId\":\"a7718991-2b84-48cc-ae13-53637b9e560e\",\"metadata\":{},\"hash\":\"w4ao4/WNmXsdEuE2iZ7FQwxgFWm0/IVbpgX8mGQnnuY=\"}},\"hash\":\"dwdLStwfp7w/HBzB5q5RB/zkC0RsRJn43/KrnUTaX+U=\",\"text\":\"### Stability Selection of the Regularization Parameter $\\\\lambda$\\n\\nThe choice of the regularization parameter $\\\\lambda$ is crucial to obtain accurate estimates of\\n$\\\\Delta \\\\hat{\\\\mathbf{S}}$. Although the value of $\\\\lambda$ of each voxel could be fixed ad-hoc,\\nprevious work has opted for the use of model selection criteria, such as the Bayesian Information\\nCriterion (BIC), on the regularization path [@CaballeroGaudes2019deconvolutionalgorithmmulti],\\ncomputed by means of the least angle regression (LARS) algorithm\\n[@Efron2004Leastangleregression]. Even though the use of BIC performed well for ME-SPFM\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti] and its single-echo counterpart (SPFM)\\n[@Gaudes2013Paradigmfreemapping], due to its high specificity, it can be problematic for\\ncertain voxels where the BIC curve might present multiple local minima or even fail to present a\\nclear minima for the evaluated range of $\\\\lambda$. This chapter proposes a more robust procedure to address this shortcoming for selecting $\\\\lambda$\\nwith the usage of the stability selection method [@Meinshausen2010Stabilityselection]\\ndescribed in . Moreover, the stability selection procedure presented here\\nyields the probability to have a non-zero coefficient in the activity-inducing signal at each\\ntime-point. Specifically, our implementation of the stability selection procedure generates $T=30$\\nsurrogates of each voxel timecourse by randomly subsampling 60\\\\% of the time-points (a more\\ncomputationally expensive version was also tested with $T=100$ surrogates that yielded very similar\\nresults). The convolution matrix $\\\\mathbf{H}$ is subsampled accordingly. The surrogate data is then\\nanalyzed with the inverse problem in Eq. %s for a\\nvoxel-specific range of $\\\\lambda$ values using the fast iterative shrinkage thresholding algorithm\\n(FISTA). Here, 30 values of $\\\\lambda$ are spaced logarithmically between 5% and 95% of the\\nvoxel-specific maximum $\\\\lambda$ possible to more accurately sample the lower range. Then, the\\nratio (probability) of surrogates where the estimated coefficient at each time-point is non-zero is\\ncalculated for each time-point and value of $\\\\lambda$. As illustrated in\\n, these probabilities build the so-called stability paths, which\\nresemble the well-known regularization paths of conventional regularized estimators (e.g., LASSO,\\nRidge Regression) that plot the amplitude of the coefficients for each $\\\\lambda$. Unlike the original stability selection procedure, which sets a given probability threshold to\\nselect the final set of non-zero coefficients [@Meinshausen2010Stabilityselection], the area\\nunder the curve (AUC) of the stability path of each time-point is calculated as an index of\\nconfidence of having a non-zero coefficient across the evaluated range of $\\\\lambda$. As a result,\\nthe AUC timecourse provides a measure of the probability of having neuronal-related activity at\\neach time-point and voxel. Next, the AUC time-series are thresholded according to the histogram of\\nAUC values in a region of non-interest (hereinafter, denoted as the null AUC histogram) to yield a\\nsparse representation of the signal. Alternatively, a null distribution of AUC values could be\\ngenerated from surrogate data [@Liegeois2021Interpretingnullmodels]. Accordingly, when\\nemploying stability selection, the individual voxels' estimates might not be equivalent to the\\nvoxels' estimates in any single one of the whole-brain models that can be formulated with a given\\nvalue of $\\\\lambda$ in Eq. %s or $\\\\mathbf{D}$ in\\nEq. %s), but are rather obtained by computing\\narea-under-the-curve (AUC) values for neuronal-related events. Finally, a fitting step is applied to each voxel by defining a reduced convolution model with the\\nselected non-zero coefficients and fitting it by means of a conventional orthogonal least squares\\nestimator. This step reduces the bias towards zero imposed by the sparsity-promoting regularization\\nterms, and thus obtains more realistic estimates of the neuronal-related signal (here, in terms of\\n$\\\\Delta R_2^*$) [@CaballeroGaudes2019deconvolutionalgorithmmulti]. ```{figure} figures/multivariate/reg_and_stab_paths.jpg\\n:align: center\\n:label: fig-reg-and-stab-paths\\n\\nExample of the regularization path and the stability path for a voxel timeseries with $\\\\rho=1$. On the left, the regularization\\npath shows the amplitude of each coefficient estimate $\\\\Delta \\\\hat{\\\\mathbf{S}}$ (one per TR).\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a7718991-2b84-48cc-ae13-53637b9e560e":{"__data__":"{\"id_\":\"a7718991-2b84-48cc-ae13-53637b9e560e\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d3314be8-9071-4d3d-9790-8056c9f6153b\",\"metadata\":{},\"hash\":\"sO/8qAdT0jnimLC+eyO54kmMVPWv2iBO2gn1sn/2luY=\"},\"PREVIOUS\":{\"nodeId\":\"12b261eb-72fd-4a12-a7dc-569a8c4914e3\",\"metadata\":{},\"hash\":\"dwdLStwfp7w/HBzB5q5RB/zkC0RsRJn43/KrnUTaX+U=\"}},\"hash\":\"w4ao4/WNmXsdEuE2iZ7FQwxgFWm0/IVbpgX8mGQnnuY=\",\"text\":\"At first, all the\\ncoefficients are zero and successively they become non-zero as $\\\\lambda$ decreases towards zero, which corresponds\\nto the orthogonal least squares solution (i.e., no regularization). On the right, the corresponding stability path\\nplots the probablity that each coefficient estimate (i.e., each TR) is non-zero for each value of $\\\\lambda$ based on\\nthe stability selection procedure. Note that both paths can have a different maximum value of $\\\\lambda$ given the\\nsubsampling step in the stability selection. Lines in the stability path correspond to different TRs of a single\\nvoxel. The darker lines denote the coefficient estimates corresponding to the TRs during the task-related events. ```\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"67c3f24e-e9cb-4c27-bc0f-cb9196234308":{"__data__":"{\"id_\":\"67c3f24e-e9cb-4c27-bc0f-cb9196234308\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"c34b7369-b1a5-4522-b1e5-ec923a9a15d1\",\"metadata\":{},\"hash\":\"v8u1JrZPomW+U/T6GrINBQXrYIUqZAx4Li85qzm4NwI=\"}},\"hash\":\"FTI7maZ86xtrKGVnTGfsM3BzwypFcFLBMy2kmbgW+Yg=\",\"text\":\"### Balancing the Spatial Regularization\\n\\nThe $\\\\ell_{2,1}$-norm regularization term in Eq. %s\\npromotes structured spatio-temporal sparsity in the sense that the estimates of all brain voxels at\\na given time-point are treated as a group and this term forms a constraint on the number of groups\\nwith at least one non-zero estimate to model the data. Assuming that $\\\\rho=0$, either the value of\\nall the voxel estimates at one time point can be non-zero or all of them are nulled. Hence, this\\nregularization term considers spatial information from all brain voxels for the deconvolution since\\nthe value of a given voxel coefficient also depends on the rest of the voxels. To illustrate the effect of the corresponding regularization parameter $\\\\rho$, this chapter solves\\nthe multivariate regularization problem in Eq. %s\\nusing stability selection for $\\\\rho=1$, $\\\\rho=0.5$ and $\\\\rho=0$.; i.e., applying the\\nsparsity-promoting $\\\\ell_1$-norm only, equally weighting the sparsity and spatial regularizations,\\nand employing the $\\\\ell_{2,1}$-norm spatial regularization only, respectively.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"bbe3846e-9bdd-40c0-aed1-5b4099b5ca73":{"__data__":"{\"id_\":\"bbe3846e-9bdd-40c0-aed1-5b4099b5ca73\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ff6b3cbe-3a9c-4b8f-ad55-6b602d7f5ca5\",\"metadata\":{},\"hash\":\"0JlEl7Iq6ILZRSm+PgVvxrcWQy8K7aWm+ulSIDkVaRQ=\"}},\"hash\":\"8+NK5GAwPN2PiNJnYR2d9XmdAvGDwqJJpx4ahY3kv4w=\",\"text\":\"### Comparison with Conventional Timing-Based GLM Analyses\\n\\nTo evaluate how the multivariate formulation combined with stability selection improves the\\naccuracy of the estimates of $\\\\Delta \\\\hat{\\\\mathbf{S}}$ compared with its univariate counterpart\\nME-SPFM using the BIC for voxel-wise selection of $\\\\lambda$\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti], the spatial sensitivity, specificity and\\noverlap (using a Dice coefficient metric) of the MvME-SPFM activation maps were calculated using\\nthe trial-level GLM-based activation maps ($p \\\\leq 0.05$) as the ground truth. These analyses were\\ncomputed with the independently modulated (IM) option of the *3dDeconvolve* program in AFNI that\\nimplements an orthogonal least squares estimation for each trial, thus also assuming uncorrelated\\nnoise as in our model. Single trial GLM maps (GLM-IM) were obtained from the optimally combined and\\nME-ICA denoised data, and only negative $\\\\Delta R_2^*$ (i.e., $\\\\Delta \\\\hat{\\\\mathbf{S}} < 0$ that\\ngenerate a positive BOLD response) were considered for the computation of the Dice coefficients. For the MvME-SPFM, the following two strategies for thresholding the AUC timeseries were considered\\nin order to define the corresponding activation maps:\\n\\n- **Static thresholding (ST):** The estimates of $\\\\Delta \\\\hat{\\\\mathbf{S}}$ obtained with the novel\\n  MvME-SPFM technique that utilizes stability selection, where the AUC threshold was chosen as the\\n  95th percentile of the histogram of AUC in deep white matter voxels (i.e., a fixed, static\\n  threshold), which were labeled after tissue segmentation of the T1-weighted anatomical MRI using\\n  *3dSeg* in AFNI, and eroding 4 voxels of the resulting white matter tissue mask at anatomical\\n  resolution. - **Time-dependent thresholding (TD):** The estimates of $\\\\Delta \\\\hat{\\\\mathbf{S}}$ obtained with\\n  the novel MvME-SPFM technique with stability selection, where the AUC threshold varies temporally\\n  according to the 95th percentile of the null histogram of AUC at each time-point. This\\n  implementation was based on the hypothesis that a time-dependent threshold would be able to\\n  better control for widespread spurious deconvolved changes in $\\\\Delta \\\\hat{\\\\mathbf{S}}$, for\\n  instance due to head motion or deep breaths. Note the ST and TD thresholding strategies can be applied in the analysis of single-echo and\\nmulti-echo fMRI data.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"3cbcf0fc-2dd1-4f0e-b9a3-7e99a4ee774d":{"__data__":"{\"id_\":\"3cbcf0fc-2dd1-4f0e-b9a3-7e99a4ee774d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"056fbeae-0b50-4e2c-963b-f1113c2162b4\",\"metadata\":{},\"hash\":\"iD1nkQXLNFBQLolGGkQI9pYqc96QvaU/PBD4/8CS17o=\"}},\"hash\":\"Ek2L5FDqqNJiqjUjftu2DBUnjYhS+msDvoQL3WFZBsQ=\",\"text\":\"### Comparison with Another State-of-the-Art Multivariate Deconvolution Method\\n\\nIn order to evaluate how the MvME-SPFM algorithm compares with another state-of-the-art\\nmultivariate deconvolution method, Hemolearn [@Cherkaoui2021Multivariatesemiblind] was chosen,\\na recently proposed multivariate semi-blind deconvolution method that can estimate the HRF and the\\nneuronal signal in a paradigm-free setting and that has been shown to faithfully capture intrinsic\\nfunctional connectivity networks at the subject level. This technique introduces a low-rank\\nconstraint to learn both $K$ temporal atoms (with $K \\\\ll P$) and their corresponding spatial maps,\\nwhich encode various functional networks, each of them with their specific neural activation\\nprofile. Hence, HemoLearn models the brain activity as a linear combination between the neural\\nactivations $Z = \\\\left( z_k \\\\right)_{k=1}^K \\\\in \\\\mathbb{R}^{K \\\\times T}$ and the spatial patterns\\n$U = \\\\left( u_k \\\\right)_{k=1}^K \\\\in \\\\mathbb{R}^{K \\\\times P}$, where $T$ is the total number of TRs\\nin the data and $P$ is the number of voxels. The BOLD fMRI signal model is then given by the\\nconvolution between an estimated regional HRF and the activation as:\\n\\n```{math}\\n\\\\mathbf{Y} = \\\\left( \\\\sum_{m=1}^M \\\\mathbf{H_m} \\\\right) * \\\\left( \\\\sum_{k=1}^K \\\\mathbf{u_k}^T \\\\mathbf{z_k} \\\\right) + \\\\mathbf{E}\\n```\\n\\nThus, the minimization problem proposed by HemoLearn can be described as:\\n\\n```{math}\\n\\\\arg \\\\min_{\\\\mathbf{U}, \\\\mathbf{Z}} = \\\\frac{1}{2} \\\\| \\\\mathbf{Y} - \\\\left( \\\\sum_{m=1}^M \\\\mathbf{H_m}\\n    \\\\right) * \\\\left( \\\\sum_{k=1}^K \\\\mathbf{u_k}^T \\\\mathbf{z_k} \\\\right) \\\\|_F^2 + \\\\lambda \\\\sum_{k=1}^K \\\\| \\\\nabla\\n\\\\mathbf{z_k} \\\\|_1\\n```\\n\\nThe practical implementation of Hemolearn --which is available at\\nhttps://hemolearn.github.io/-- requires the specification of the\\nnumber of components to be estimated, which has no standard procedure to be determined. Here, the\\nanalysis was performed with a range of components from 5 to 40. With the aim of making the\\ncomparison as fair as possible, the component that maximized the correlation between the estimated\\nactivity map and the session-level GLM-based activation map was selected for each condition in the\\ntask. The selected component time-series were compared with the corresponding $\\\\Delta\\n\\\\hat{\\\\mathbf{S}}$ obtained with MvME-SPFM using stability selection and the time-dependent\\nthresholding (TD), and the selected component activity maps with the corresponding trial-level\\nMvME-SPFM activity maps obtained with the same thresholding strategy. (sec-multivariate-results)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"1f8e91ca-f934-4c30-8e4e-78b6db485f8a":{"__data__":"{\"id_\":\"1f8e91ca-f934-4c30-8e4e-78b6db485f8a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"NEXT\":{\"nodeId\":\"84cdcbc8-23c0-4b20-891a-96060fe56b2c\",\"metadata\":{},\"hash\":\"b4difR9uOqjZJHUr7arLUd8MwXH2w+y35qlPavSncvI=\"}},\"hash\":\"cofH3QW8dh4bdfPsmuFGnin+v4dAlgK2+XXxC63GsgU=\",\"text\":\"## Results\\n\\nThe output of deconvolution algorithms such as ME-SPFM and the proposed MvME-SPFM is a 4D dataset\\nthat matches the dimensions (both spatial and temporal) of the input data, i.e., it is a movie of\\nthe estimated $\\\\Delta R_2^*$ maps. In addition, the use of stability selection generates the area\\nunder the curve (AUC) 4D output dataset, which indicates the probability of having a\\nneuronal-related event at each time-point for every voxel in the brain. depicts the area under the curve (AUC) time-series and maps obtained with stability\\nselection for $\\\\rho=0.5$ in representative voxels of each task in the paradigm (indicated with a\\ncross in the maps), where the AUC maps correspond to single time-points signaled by the blue\\narrows. The AUC time-series of the ST and TD thresholding approaches are shown on top of the\\noriginal AUC time-series. The AUC maps depict spatial patterns of $\\\\Delta R_2^*$ where regions that\\nare typically involved in the tasks show higher probabilities of having neuronal-related activity\\ncompared with other brain regions. ```{figure} figures/multivariate/auc.jpg\\n:align: center\\n:label: fig-auc\\n\\n**Left:** Original (blue), ST thresholded (orange) and TD thresholded (green) AUC time-series for a\\nrepresentative voxel for each task in the paradigm ($\\\\rho=0.5$). Note that the three time-series are overlaid; i.e.,\\nthe static and time-dependent time-courses are thresholded versions of the original AUC. Gray blocks depict the\\nonset and duration of each trial. **Right:** AUC maps at the time-points signaled by the blue arrows. ```\\n\\n displays the comparison of the $\\\\Delta R_2^*$ maps obtained by solving\\nthe inverse problem in Eq. %s with a fixed\\nselection of $\\\\lambda$ (1$^{st}$ row) and with the use of stability selection (2$^{nd}$, 3$^{rd}$\\nand 4$^{th}$ rows) for $\\\\rho = \\\\{0, 0.5, 1\\\\}$. The $\\\\Delta R_2^*$ maps obtained with a fixed\\nselection of $\\\\lambda$ equal to the noise estimate of the first echo volume (1$^{st}$ row) are very\\nsensitive to the selection of $\\\\rho$. Similar observations were obtained with other values of\\n$\\\\lambda$. With a selection of $\\\\rho = 1$, only the $\\\\ell_1$-norm regularization term is applied,\\nwhich produces $\\\\Delta R_2^*$ maps with few non-zero coefficients. With $\\\\rho = 0$, only the\\n$\\\\ell_{2,1}$-norm spatial regularization is applied, which yields a $\\\\Delta R_2^*$ map that covers\\nthe entire brain and does not exhibit a spatial pattern in concordance with the task. However, a\\nselection of $\\\\rho = 0.5$ yields a $\\\\Delta R_2^*$ map that is more similar to the activity maps\\noften observed when participants are asked to look at the image of a house, depicting negative\\n$\\\\Delta R_2^*$ in bilateral fusiform regions. In contrast, the use of stability selection yields\\nAUC maps (row 2) and the corresponding $\\\\Delta R_2^*$ maps after each thresholding strategy (rows\\n3-4) reveal activation patterns concordant with those often seen for viewing houses regardless of\\nthe selection of $\\\\rho$. In other words, the $\\\\Delta R_2^*$ maps obtained with stability selection\\nare less sensitive to the selection of $\\\\rho$ while obviating the need to choose $\\\\lambda$. In\\nfact, the spatial correlations between the AUC maps for each pair of $\\\\rho$'s were nearly equal to\\n1 for all time points (average correlations are 0.97 between $\\\\rho=\\\\{0,0.5\\\\}$, 0.98 between\\n$\\\\rho=\\\\{0,1\\\\}$, and 0.97 between $\\\\rho=\\\\{0.5,1\\\\}$). In addition, it can be seen that using a TD\\nthreshold yields BOLD signal changes that are more confined to the expected areas in bilateral\\nfusiform cortices than the ST threshold. Due to the high similarity of the AUC maps for any value\\nof $\\\\rho$, only the results for $\\\\rho=0.5$ are discussed hereinafter.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"84cdcbc8-23c0-4b20-891a-96060fe56b2c":{"__data__":"{\"id_\":\"84cdcbc8-23c0-4b20-891a-96060fe56b2c\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"PREVIOUS\":{\"nodeId\":\"1f8e91ca-f934-4c30-8e4e-78b6db485f8a\",\"metadata\":{},\"hash\":\"cofH3QW8dh4bdfPsmuFGnin+v4dAlgK2+XXxC63GsgU=\"},\"NEXT\":{\"nodeId\":\"69f390a1-0de1-4fe9-aabe-4290a2c86c6b\",\"metadata\":{},\"hash\":\"24h/cmux5QI3iGDwqUhU5HlDzPPYTmSRCw2Y7UOynqo=\"}},\"hash\":\"b4difR9uOqjZJHUr7arLUd8MwXH2w+y35qlPavSncvI=\",\"text\":\"```{figure} figures/multivariate/rho_comparison.jpg\\n:align: center\\n:label: fig-rho-comparison\\n\\nComparison of the $\\\\Delta R_2^*$ maps obtained with a fixed selection of $\\\\lambda$ (row 1) and the use of\\nstability selection (rows 2-4: AUC, stability selection with static thresholding (ST), and stability selection with\\ntime-dependent thresholding (TD)) for $\\\\rho = 0$ (column 1), $\\\\rho = 0.5$ (column 2), and $\\\\rho = 1$ (column 3). These maps correspond to a single-trial event of the house-viewing task (HOUS). ```\\n\\n provides an in-depth view of how the time-dependent thresholding operates when\\nmotion- and respiration-related artifacts are present in the data. The grayplot\\n@Power2017simpleusefulway] in [A clearly shows bands spanning throughout\\nthe entire brain that illustrate significant changes in the amplitude of the signal. The source of\\nthese signal changes can be attributed to head motion events (see Euclidean norm in\\nC) and deep breaths (see arrows for respiration volume signal\\n@Chang2009Influenceheartrate] in [D). The respiration-related events cause\\na drop in the global signal (see B) seconds after the peak in the respiration\\nvolume signal. Interestingly, our results show a decrease in the equivalent ST percentile that\\ncorresponds to the 95th TD threshold (E) at the instances of these large\\nrespiratory-related events. This decrease can also be observed in the corresponding AUC value of\\nthe TD thresholding strategy as shown in F. The distributions of AUC values at\\nthe time-points with respiratory- and motion-related artifacts have a shorter tail than the\\ndistribution of the AUC values at the time-points where subjects performed the task. Hence, in\\nthese events the TD thresholding strategy is able to adjust the threshold so that the final\\nestimates of $\\\\Delta R_2^*$ specifically capture task-activated voxels while excluding voxels that\\nare affected by artifacts. The higher specificity of the TD thresholding strategy can be clearly\\nseen in the ROC values shown in H-L. The use of stability selection with the TD\\nthreshold yields more specific estimates of $\\\\Delta R_2^*$ than with ST thresholding or the\\noriginal ME-SPFM method, while the sensitivity is slightly reduced. On the other hand, the use of\\nstability selection with a ST threshold improves the sensitivity of the $\\\\Delta R_2^*$ estimates\\ncompared to the original ME-SPFM technique while preserving its specificity. ```{figure} figures/multivariate/artifacts.jpg\\n:align: center\\n:label: fig-artifacts\\n\\nRepresentative subject with motion and respiration artifacts. **A:** Grayplot of the second echo\\nvolume. The grayplot is divided into 4 sections: gray matter (GM), white matter (WM), cerebrospinal fluid (CSF), and\\ndeep white matter (DWM). **B:** Time-series of the global signal calculated in the whole brain (WB, blue) and\\nthe deep white matter (DWM, green). **C:** Euclidean norm (e-norm) of the temporal derivative of the realignment parameters. **D:** respiration volume signal. **E:** AUC percentile corresponding to the time-dependent threshold (lines at 95th\\nand 99th percentiles are shown for reference). **F:** AUC values corresponding to the time-dependent threshold\\nare shown in blue. The horizontal dashed lines indicate the 95th (orange) and 99th (green) percentiles corresponding to\\nST thresholding. Gray bars in **B-F** indicate the onset and duration of each trial in the paradigm, with their\\nrespective initials on top. Blue arrows point out two respiration-related events, green arrows point out two\\nmotion-related events, and the orange arrow points out a finger-tapping event. **G:** Probability density\\nfunctions (estimated by kernel density estimate) of the AUC values corresponding to the instances of the two\\nrespiratory-related events (blue lines), a representative time-point of one finger-tapping trial (orange line), the\\ntwo largest peaks in the e-norm trace (green lines), and the overall AUC distribution (black). The corresponding\\ncoloured vertical dashed lines indicate the AUC value for the 95th percentile of the TD thresholding approach, along\\nwith the 95th and 99th AUC values of ST thresholding.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"69f390a1-0de1-4fe9-aabe-4290a2c86c6b":{"__data__":"{\"id_\":\"69f390a1-0de1-4fe9-aabe-4290a2c86c6b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"PREVIOUS\":{\"nodeId\":\"84cdcbc8-23c0-4b20-891a-96060fe56b2c\",\"metadata\":{},\"hash\":\"b4difR9uOqjZJHUr7arLUd8MwXH2w+y35qlPavSncvI=\"},\"NEXT\":{\"nodeId\":\"2a47a8cc-a22f-4bd9-8406-46f3b5d33c65\",\"metadata\":{},\"hash\":\"iMUZBLeUh2Vpoaw9z7/xS3jxUrOD6cGpa6UsATlopw8=\"}},\"hash\":\"24h/cmux5QI3iGDwqUhU5HlDzPPYTmSRCw2Y7UOynqo=\",\"text\":\"**H-L:** Receiver operating characteristic (ROC) values\\nfor the original ME-SPFM (orange), and proposed MvME-SPFM technique with the use of stability selection with the ST\\n(light blue) and TD (dark blue) thresholding approaches for this dataset. The ROC plots depict the sensitivity and\\nspecificity of the methods at correctly estimating the activity maps that correspond to the 6 trials of each task in\\nthe paradigm. ```\\n\\n depicts the time-series of the estimated $\\\\Delta R_2^*$ and denoised\\nBOLD, i.e., $\\\\Delta R_2^*$ convolved with the HRF, for a representative voxel of each task for the\\nsubject depicted in  and  and compared to a reference\\nvoxel in the lateral ventricles. The location of the voxels is shown in the corresponding maps in\\n. The ST thresholding approach detects $\\\\Delta R_2^*$ events of the\\nactivity-inducing signal that correctly match the timings of the stimuli (i.e., high temporal\\nsensitivity), but also shows events that occur in the resting state and do not coincide with any\\nactivity-evoking trial. Based on comparison with the events detected in the time series extracted\\nfrom the lateral ventricles, it can be conjectured that some of these events might be due to\\nartifactual and physiological fluctuations that remain in the signal after preprocessing. On the\\nother hand, $\\\\Delta R_2^*$ values estimated with the TD thresholding approach match the timings of\\nthe stimuli almost perfectly with few missed trials (high temporal specificity). This is supported\\nby the few $\\\\Delta R_2^*$ events obtained for the reference voxel in the ventricles. Likewise, the\\ndenoised BOLD time-series obtained with the TD thresholding approach clearly describes signal\\nchanges associated with the trials, whereas the denoised BOLD time-series estimated with the ST\\nthresholding strategy fits the original data very closely, which could be interpreted as a\\nsignature of overfitting. ```{figure} figures/multivariate/dr2_time_series.png\\n:align: center\\n:label: fig-dr2-time-series\\n\\nComparison of the estimated $\\\\Delta R_2^*$ (blue) and denoised BOLD (orange), i.e., $\\\\Delta R_2^*$\\nconvolved with the HRF, time-series when employing the ST (left) and TD (right) thresholding approches, for\\nrepresentative voxels of each task (rows) as well as one voxel from the lateral ventricle for reference. The\\nestimates shown here were obtained with $\\\\rho=0.5$. The preprocessed time series is shown in black. The gray bars\\nindicate the onset and duration of each trial for each task of the experimental paradigm. ```\\n\\n illustrates the activation maps of representative single-trial events of\\neach task for the same subject depicted in . The activation maps of the\\nproposed MvME-SPFM formulation were compared using the two thresholding approaches with the\\nactivation maps obtained with a single-trial GLM and the previous ME-SPFM approach. While all PFM\\nmethods exhibit activation maps that highly resemble those obtained with the single-trial GLM\\nanalysis, differences between the methods can be observed. For instance, although the use of\\nstability selection with a ST thresholding approach yields maps with clusters of activation of\\ncomparable size and location to those found with ME-SPFM, in certain noisy trials (e.g., see\\nHOUS-Trial 1), the ST-thresholding MvME-SPFM maps can yield reduced spatial specificity, probably\\nrelated to spurious, scattered changes in $R_2^*$. Across all tasks, the maps obtained with TD\\nthresholding exhibit a notably larger resemblance to the single-trial GLM, showing higher spatial\\nspecificity and lower sensitivity compared to the other two PFM methods. To further evaluate the proposed MvME-SPFM, the motor task of a single subject (*100206*)\\nextracted from the Human Connectome Project (HCP) dataset [@VanEssen2013WUMinnHuman] was\\nanalyzed. The data was 3 min 24 s long (after removing the first 10 seconds for steady\\nmagnetization) with a TR of 0.72 s, a multi-band factor of 8 and a spatial resolution of\\n$2\\\\times2\\\\times2$ mm$^3$. The images were already preprocessed using a standard HCP pipeline\\nincluding realignment, coregistration, spatial normalization and smoothing. The task was composed\\nof 5 blocks of 12 s each, preceded by a 3 s cue indicating the task to be performed by the\\nparticipant.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"2a47a8cc-a22f-4bd9-8406-46f3b5d33c65":{"__data__":"{\"id_\":\"2a47a8cc-a22f-4bd9-8406-46f3b5d33c65\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"PREVIOUS\":{\"nodeId\":\"69f390a1-0de1-4fe9-aabe-4290a2c86c6b\",\"metadata\":{},\"hash\":\"24h/cmux5QI3iGDwqUhU5HlDzPPYTmSRCw2Y7UOynqo=\"},\"NEXT\":{\"nodeId\":\"8f27a129-737e-4d77-8f08-086acde73e6b\",\"metadata\":{},\"hash\":\"oBb38VGSmShU9z6nlx6YCe/oiO+TAvaOB31UFLYSpYA=\"}},\"hash\":\"iMUZBLeUh2Vpoaw9z7/xS3jxUrOD6cGpa6UsATlopw8=\",\"text\":\"The conditions in each 5-second block were: left hand finger tapping, right hand\\nfinger tapping, left foot movement, right foot movement, and tongue movement. The process was\\nrepeated once more, resulting in a total of 10 blocks. We adjusted the signal model in\\nEq. %s to be used with single-echo data as described in\\n[@Gaudes2013Paradigmfreemapping;@Urunuela2023HemodynamicDeconvolutionDemystified]. The accurate performance of the proposed MvME-SPFM method observed in the multi-echo fMRI data is\\nconsistent with the results found in the single-echo data from the Human Connectome Project. depicts the single-trial activity maps obtained with a GLM and the proposed\\napproach with stability selection and both ST and TD thresholding. In general, the activity maps\\nobtained with the proposed method are highly comparable to the single-trial GLM activation maps. Importantly, the proposed method showed a larger sensitivity to detect the activity evoked by the\\nmotor task for certain trials than the timing-aware GLM analysis. For instance, the Mv-SPFM\\nactivation maps of the second trial for the left hand finger tapping condition shows more BOLD\\nactivity in motor regions of the right precental gyrus, which is barely seen in the corresponding\\nsingle-trial GLM map. ```{figure} figures/multivariate/hcp_motor.jpg\\n:align: center\\n:label: fig-hcp-motor\\n\\nSingle-trial activity maps estimated for the single-echo motor task data from the Human Connectome\\nProject.Row 1 depicts the activation maps obtained with a single-trial GLM ($p \\\\leq 0.05$), row 2 depicts the maps\\ndetected with the novel Mv-SPFM technique with stability selection, $\\\\rho=0.5$ and a static threshold (ST), and row\\n3 illustrates the results using a time-dependent threshold (TD). The activity maps corresponding to the first trial\\nare shown on top, and the activity maps corresponding to the second trial are shown on the bottom. ```\\n\\n```{figure} figures/multivariate/activity_maps.jpg\\n:align: center\\n:label: fig-activity-maps\\n\\nComparison of single-trial activation maps obtained with a GLM (row 1) thresholded at $p \\\\leq 0.05$, the\\noriginal ME-SPFM formulation with a fixed selection of $\\\\lambda$ (row 2), the novel MvME-SPFM technique with\\nstability selection, $\\\\rho=0.5$ and a static threshold (ST, row 3), and using a time-dependent threshold (TD, row\\n4). A representative trial is shown for each task. All the maps correspond to the same subject and run shown in\\n. ```\\n\\nAs illustrated in , the Dice coefficient between the estimated single-trial $\\\\Delta\\nR_2^*$ activity maps and the reference GLM activity maps ($p \\\\leq 0.05$) demonstrates only a slight\\nimprovement over the original ME-SPFM formulation when employing an ST thresholding approach with\\nthe novel MvME-SPFM technique. In contrast, the Dice coefficients obtained with TD thresholding\\nshow a very notable increase of nearly 50% in the median of the distribution of Dice coefficients\\ncompared with the original ME-SPFM approach. Similarly, the sensitivity and specificity\\ndistributions of ST thresholding demonstrate a slight improvement with respect to the original\\nME-SPFM formulation. On the other hand, the use of TD thresholding offers nearly perfect\\nspecificity ($\\\\geq 95\\\\%$) at the cost of reduced sensitivity across all experimental conditions. Hence, increasing the specificity of the $\\\\Delta R_2^*$ maps is more beneficial for increasing the\\nconcordance with the GLM maps than increasing the sensitivity. The receiver operating characteristic (ROC) values in  corroborate the previous\\nobservations regardless of the value of $\\\\rho$ used in the MvME-SPFM method. The estimates obtained\\nwith the ST threshold reveal an overall higher sensitivity and a slightly higher specificity\\ncompared to the original ME-SPFM technique. In contrast, the ROC values for the TD thresholding\\napproach show a clear improvement in specificity but lower sensitivity. These findings are in line\\nwith the results shown in ,  and\\n, as the Dice and ROC values certify that the use of stability selection\\nyields robust activation maps regardless of the selection of the spatial regularization term $\\\\rho$\\nand obviating the need to choose the temporal regularization parameter $\\\\lambda$. An interactive\\nversion of  and  is available in the following GitHub repository:\\nhttps://github.com/eurunuela/MvMEPFM_figures.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8f27a129-737e-4d77-8f08-086acde73e6b":{"__data__":"{\"id_\":\"8f27a129-737e-4d77-8f08-086acde73e6b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"PREVIOUS\":{\"nodeId\":\"2a47a8cc-a22f-4bd9-8406-46f3b5d33c65\",\"metadata\":{},\"hash\":\"iMUZBLeUh2Vpoaw9z7/xS3jxUrOD6cGpa6UsATlopw8=\"},\"NEXT\":{\"nodeId\":\"8a64e5aa-7cdb-4833-96f8-c656e5386747\",\"metadata\":{},\"hash\":\"o2hwArxsRJwxhhr0fG4I5K6DuHcasdBaai3TjZLAo/4=\"}},\"hash\":\"oBb38VGSmShU9z6nlx6YCe/oiO+TAvaOB31UFLYSpYA=\",\"text\":\"```{figure} figures/multivariate/dice.png\\n:align: center\\n:label: fig-dice\\n\\nDice coefficient (i.e., spatial overlap), sensitivity and specificity coefficients of the single-trial activation maps\\nfor each of the experimental conditions obtained with ME-SPFM, MvME-SPFM with stability selection and a static\\nthresholding approach (ST), and MvME-SPFM with stability selection and a time-dependent thresholding approach (TD). These metrics were obtained with a selection of $\\\\rho = 0.5$. Reference activation maps were obtained with a single\\ntrial GLM analysis and thresholded at uncorrected $p \\\\leq 0.05$. The density plot shows the shape of the\\ndistribution of the Dice coefficients, and the box plot depicts the median with a solid line, with each box spanning\\nfrom quartile 1 to quartile 3. The whiskers extend to 1.5 times the interquartile range. ```\\n\\n```{figure} figures/multivariate/roc.jpg\\n:align: center\\n:label: fig-roc\\n\\nReceiver operating characteristic (ROC) values with the sensitivity and specificity of each single trial's activation map for\\nall conditions and the reference map obtained with a single-trial GLM. Different colors are used for the different\\nanalyses: the original ME-SPFM, and the novel MvME-SPFM approach using stability selection with the spatial\\nregularization parameter set to $\\\\rho=0.5$ and the two different thresholding methods: static (ST) and\\ntime-dependent (TD). In each analysis each dot represents a single trial, depicting all trials across all datasets,\\nand the centroids across all the single trials are also shown for the three analyses. ```\\n\\nThese findings are further corroborated by the average activity maps across trials, sessions and\\nsubjects for each condition in the task shown in . The maps obtained with the\\nnovel MvME-SPFM technique with stability selection and TD thresholding show a high resemblance to\\nthe average of the single-trial GLM activation maps (*3dDeconvolve* with independently-modulation\\n(IM) option in AFNI, thresholded at $p<0.05$). Interestingly, the MvME-SPFM approach seems to offer\\nimproved detection of neuronal-related activity than the GLM approach for certain conditions, for\\nexample, in the voxels of the left inferior frontal gyrus (i.e., Broca's region) and left posterior\\nsuperior temporal gyrus (i.e., Wernicke's region) for the reading condition, where the GLM maps\\nshow a smaller cluster of activation. ```{figure} figures/multivariate/group_avg.jpg\\n:align: center\\n:label: fig-group-avg\\n\\nAverage activity maps across trials, sessions and subjects for each condition in the task obtained with (top) a single-trial\\nGLM analysis (independently modulated, IM) and the proposed MvME-SPFM algorithm with stability selection, $\\\\rho=0.5$\\nand a time-dependent threshold (TD). ```\\n\\n shows the comparison with the HemoLearn algorithm\\n[@Cherkaoui2021Multivariatesemiblind]. Panels A and B illustrate the difficulty of selecting a\\nsuitable number of components $K$ for Hemolearn since the number of components giving the highest\\ncorrelation to the session-level GLM was different for each condition. The timecourses of the\\nestimated activity-inducing signal in C show that Hemolearn struggles to capture the timings of the\\ntask in all conditions, while the MvME-SPFM technique with stability selection and TD thresholding\\nis able to capture the expected activity-inducing signal with barely missing any of the events in\\nthe task. These observations are also visible in the activity maps shown in D, where the activity\\nmaps obtained with the MvME-SPFM technique with stability selection and TD thresholding are\\ncomparable to those obtained with the GLM (see ), while the maps of the\\nHemolearn components that had the highest correlation with the session-level GLM maps do not show a\\nclear activity pattern related to the task. ```{figure} figures/multivariate/hemolearn_comparison.jpg\\n:align: center\\n:label: fig-hemolearn-comparison\\n\\nComparison of the activity maps obtained with the novel MvME-SPFM technique with stability selection,\\n$\\\\rho=0.5$ and a time-dependent threshold (TD) with Hemolearn. Session 1 of subject P3SBJ01 was used for this\\ncomparison.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8a64e5aa-7cdb-4833-96f8-c656e5386747":{"__data__":"{\"id_\":\"8a64e5aa-7cdb-4833-96f8-c656e5386747\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9c0127d3-de93-4837-9237-bcdd4df71912\",\"metadata\":{},\"hash\":\"7ZXFWRO+Darw5kDOUnXLNJn9iSjVBBjzJ+swSoh5f5U=\"},\"PREVIOUS\":{\"nodeId\":\"8f27a129-737e-4d77-8f08-086acde73e6b\",\"metadata\":{},\"hash\":\"oBb38VGSmShU9z6nlx6YCe/oiO+TAvaOB31UFLYSpYA=\"}},\"hash\":\"o2hwArxsRJwxhhr0fG4I5K6DuHcasdBaai3TjZLAo/4=\",\"text\":\"Session 1 of subject P3SBJ01 was used for this\\ncomparison. A and B show the highest correlation to the session-level GLM regressor and activity map respectively\\nobtained by Hemolearn for each condition in the task (FTAP in red, HOUS in dark blue, BMOT in green, READ in yellow,\\nand MUSI in purple) and the range of K components explored ($K=5\\\\dots40$). C illustrates the timecourses of\\nMvME-SPFM (blue, $\\\\Delta R_2^*$) and Hemolearn-estimated (orange, percent signal change) activity-inducing signal in\\na representative voxel for each condition. The gray bars show the onset and duration of each trial within a condition,\\nand the measured fMRI signal is shown in percent signal change (PSC) in black. D compares the trial-level activity maps\\nestimated with MvME-SPFM with the Hemolearn activity map with the highest correlation with the session-level GLM map across the\\nexplored range of K components. Every row in C and D correspond to the different conditions in the task. ```\\n\\n(sec-multivariate-discussion)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"4e7e5b26-21dd-4870-940d-03f46bfd7f1c":{"__data__":"{\"id_\":\"4e7e5b26-21dd-4870-940d-03f46bfd7f1c\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"58e19fb5-c662-45f8-82c3-b5b8a1080fca\",\"metadata\":{},\"hash\":\"Fto7XNRIo+AK5GRcsAoeFw01upvN8x+liK9EEXMqDBs=\"},\"NEXT\":{\"nodeId\":\"38f54452-39bb-471e-b62a-2e4e16dd1e1b\",\"metadata\":{},\"hash\":\"Or+3bOwKgzA5FG5LuoLdUoPvMRPUZClvb0GJybz1yXk=\"}},\"hash\":\"W9KHBlnSo44klg/1ltqKAQH/39gyVBCkW/nudd5dRV8=\",\"text\":\"## Discussion and Conclusion\\n\\nThe proposed whole-brain (i.e., multivariate) formulation for hemodynamic deconvolution of\\nmulti-echo fMRI data with the use of stability selection achieved a closer agreement with the\\nactivation maps obtained with a single-trial GLM analysis than the original ME-SPFM method\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti] and other state-of-the-art multivariate\\ndeconvolution method like Hemolearn [@Cherkaoui2021Multivariatesemiblind], while obviating the\\nneed to select the temporal regularization parameter $\\\\lambda$ (as shown in\\n and ). Furthermore, this chapter demonstrated that the performance of the proposed method was robust not\\nonly for the analysis of multi-echo data, but also when analyzing single-echo data, as demonstrated\\nin . In addition, our results illustrated that the stability selection procedure\\nalso offers robustness against the choice of the spatial regularization parameter $\\\\rho$, as the\\nAUC maps for different selections of $\\\\rho$ were practically identical, as shown in\\n. Hence, although stability selection could be employed with a double\\nselection of the regularization parameters $\\\\lambda$ and $\\\\rho$, this can be avoided for\\ncomputational reasons with little influence in the results. In any case, extending the proposed\\nstability selection technique to other formulations of the hemodynamic deconvolution problem, such\\nas the voxel-wise (i.e., univariate) single-echo\\n[@Gaudes2013Paradigmfreemapping;@Urunuela2020StabilityBasedSparse] described in\\n and , univariate multi-echo\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti], or low-rank and sparse formulations\\n@Urunuela2021LowRankSparse;@Cherkaoui2021Multivariatesemiblind] described in [, is\\nrelatively straightforward. One of the most interesting features of the proposed stability selection procedure is the\\nestimation of the area under the curve (AUC) measure, which provides a new perspective for\\nexploring fMRI data: a 4D movie with the probability of each voxel and time point containing a\\nneuronal-related event. Therefore, the AUC time-series and maps provide complementary information\\nto the estimates of $\\\\Delta R_2^*$, and serve as a reliability measure. Even though the AUC\\nmeasures were employed here to produce the final estimates of the activity-inducing signal, they\\ncould also be exploited on their own. For instance, they could be exploited to constrain functional\\nconnectivity analysis\\n[@Tagliazucchi2016VoxelWiseFunctional;@Faskowitz2020Edgecentricfunctional] to voxels and\\ninstants with a high probability of containing a neuronal-related event. Furthermore, the stability\\nselection and the AUC metric can also be interpreted from a machine learning perspective, where the\\noutputs from a collection of lasso learners are combined with an ensemble regression approach. Alternatively, the stability selection procedure could also be linked to Bayesian approaches where\\nthe prior is given by the range of values of the regularization term $\\\\lambda$ and the total\\nposterior probability of the neuronal event is calculated as the integration of the stability\\npaths, i.e., the AUC (see discussion in @Meinshausen2010Stabilityselection). Although the estimation of the AUC eliminates the need to select the spatial and temporal\\nregularization parameters $\\\\lambda$ and $\\\\rho$, it requires the use of a thresholding approach\\ngiven the nature of the AUC measure, which cannot be equal to zero by definition. This chapter\\nadopted two data-driven thresholding strategies, static (ST) and time-dependent (TD), based on the\\nAUC values of a region where no BOLD signal changes related to neuronal activity are assumed to\\noccur (e.g., deep white matter voxels). The use of a static AUC thresholding approach yielded\\nhigher sensitivity than the original ME-SPFM method\\n[@CaballeroGaudes2019deconvolutionalgorithmmulti] while maintaining the specificity as\\ndemonstrated in . Notably, this improvement was seen in all trials with the exception\\nof one outlier run, regardless of the choice of the spatial regularization parameter $\\\\rho$. Nevertheless, the use of a time-dependent thresholding approach may be even justified by the\\nincreased specificity and nearly perfect retrieval of the activity-inducing signal (row 3 in\\n) when motion- and respiration-related artifacts are visible in the data\\n(see arrows in ). However, the application of the time-dependent threshold may\\nreduce sensitivity at the single-trial level in some cases.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"38f54452-39bb-471e-b62a-2e4e16dd1e1b":{"__data__":"{\"id_\":\"38f54452-39bb-471e-b62a-2e4e16dd1e1b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"58e19fb5-c662-45f8-82c3-b5b8a1080fca\",\"metadata\":{},\"hash\":\"Fto7XNRIo+AK5GRcsAoeFw01upvN8x+liK9EEXMqDBs=\"},\"PREVIOUS\":{\"nodeId\":\"4e7e5b26-21dd-4870-940d-03f46bfd7f1c\",\"metadata\":{},\"hash\":\"W9KHBlnSo44klg/1ltqKAQH/39gyVBCkW/nudd5dRV8=\"}},\"hash\":\"Or+3bOwKgzA5FG5LuoLdUoPvMRPUZClvb0GJybz1yXk=\",\"text\":\"Hence, the results shown in\\n encourage the use of the static thresholding approach as an exploratory step before\\nemploying the time-dependent threshold. Other thresholding criteria could involve the comparison of\\nAUC values obtained from surrogate (null) data [@Liegeois2021Interpretingnullmodels] with the\\nAUC values obtained with the original data. Furthermore, the extension of the original ME-SPFM algorithm from a voxel-wise to a whole-brain\\n(i.e., multivariate) regularized problem paves the way for more refined formulations that exploit\\nthe spatial characteristics and information available in fMRI and complementary imaging data into\\nthe spatial regularization term in order to improve the estimation of $\\\\Delta R_2^*$. For instance,\\nthe spatial regularization could be constrained within brain regions delineated by commonly used\\nparcellations (e.g., the Schaefer-Yeo atlas) [@Karahanoglu2013TotalactivationfMRI] or within\\nneighbouring gray matter voxels [@Farouj2017Regularizedspatiotemporaldeconvolution]. Other\\nmixed-norm regularization terms could also be investigated in future work to account for\\nalternative models of spatially varying noise SNR, e.g., the octagonal shrinkage and clustering\\nalgorithm for regression (OSCAR) [@Gueddari2021CalibrationLessMulti], which employs a $\\\\ell_1$\\nplus a pairwise $\\\\ell_{\\\\infty}$-norm between voxels instead of a global $\\\\ell_2$-norm to account\\nfor spatially varying SNR across voxels. Moreover, the multivariate formulation could exploit\\ncomplimentary multimodal information such as structural connectivity from diffusion-based MRI data\\n[@Bolton2019StructurallyInformedDeconvolution]. In addition, the proposed formulation can be\\neasily adapted to model the changes in neuronal activity in terms of its innovations, which can be\\nmore appropiate to capture sustained BOLD events as described in  (see\\nalso @Urunuela2023HemodynamicDeconvolutionDemystified). One limitation of the proposed MvME-SPFM technique is the assumption of a particular shape of the\\nhemodynamic response to construct the HRF matrix for deconvolution in\\nEq. %s. The proposed model does not account for the\\nvariability in the temporal characteristics of the HRF across the brain, which originates from\\ndifferences in stimulus intensity and patterns, short inter-event intervals, or differences in the\\nHRF shape between resting-state and task-based paradigms\\n[@Yesilyurt2008DynamicsnonlinearitiesBOLD;@Sadaghiani2009Neuralactivityinduced;@Chen2021Investigatingmechanismsfast;@Polimeni2021Imagingfasterneural]. To resolve this issue, given that the performance of MvME-SPFM is not time-locked to the trials,\\nthe current formulation could be extended to account for variability in the onset of the\\nactivity-inducing signal, as well as to introduce flexibility in the model, by employing multiple\\nbasis functions [@Gaudes2012Structuredsparsedeconvolution]. Furthermore, our method could be\\neasily employed independently within parcels of any commonly-used atlases with a pre-estimated,\\nlocalized HRF. Finally, the computational demands involved in the stability selection procedure,\\nwhich solves the regularization problem in Eq. %s\\nfor a range of $\\\\lambda$ values on a number of subsampled surrogate datasets, are higher than\\nsolving the regularization path and finding an adequate solution via model selection criteria as in\\nME-SPFM [@CaballeroGaudes2019deconvolutionalgorithmmulti]. At the moment of writing, the\\nmethod took approximately 10 hours to run on a high-performance computing cluster parallelizing the\\nstability selection procedure so that each surrogate dataset was processed in a different core. (sec-multivariate-github)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e2fffa70-813d-4951-a43a-8bb5540a0514":{"__data__":"{\"id_\":\"e2fffa70-813d-4951-a43a-8bb5540a0514\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"237e2c81-d9e3-4d82-a415-a925a3130cd5\",\"metadata\":{},\"hash\":\"zsbchlpNGei2faVOYxDwXHhn9D2kbgOopyoiim7EbaI=\"}},\"hash\":\"xP06SOGplDB4W7h4IlHrn1f6Kd6My8pyyYDNQsjKm/w=\",\"text\":\"## Code and data availability\\n\\nThe code and materials used to generate the figures in this work can be found in the following\\nGitHub repository:\\nhttps://github.com/eurunuela/MvMEPFM_figures. The Python package is available as part of *splora* in the following GitHub repository:\\nhttps://github.com/ParadigmFreeMapping/splora.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"4d6f32c2-be80-4abf-861c-0b0249caa2f0":{"__data__":"{\"id_\":\"4d6f32c2-be80-4abf-861c-0b0249caa2f0\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"f75748c9-ed3a-415e-a2ea-c4776cafc6e1\",\"metadata\":{},\"hash\":\"rmh7A50kQp5pV44/tH4u3/MCfP/lWbA1yX8rqZZ5UeQ=\"}},\"hash\":\"U3wZtkDUnb2Q0WHNXm6Nh0QOROF2iztqZQ/lUuvYnR8=\",\"text\":\"# Chapter 3: Stability-Based Sparse Paradigm Free Mapping\\n\\nThis chapter was published as @Urunuela2020StabilityBasedSparse. This chapter proposes the implementation of a subsampling approach based on\\nstability selection that avoids the choice of any regularization parameter for\\nhemodynamic deconvolution with sparsity-promoting regularized least squares\\nestimators. The proposed method is implemented to operate with the Sparse\\nParadigm Free Mapping (SPFM) algorithm and its performance is evaluated on real fMRI\\ndata and compared with both the original SPFM algorithm, which used model\\nselection criteria to select the parameters, and a conventional analysis with a\\ngeneral linear model (GLM) that is aware of the temporal model of the\\nneuronal-related activity. The results demonstrate that SPFM with stability\\nselection yields activation maps with higher resemblance to the maps obtained\\nwith GLM analyses and offers improved detection of neuronal-related events over\\nSPFM, particularly in scenarios with low contrast-to-noise ratio. (sec-stability-introduction)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b33c3f6e-45d9-4a50-b41e-7fd795073e0d":{"__data__":"{\"id_\":\"b33c3f6e-45d9-4a50-b41e-7fd795073e0d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"717d48c3-17dc-452e-92c4-ad9a4a5f4ca5\",\"metadata\":{},\"hash\":\"PPy+fvkgiec53v8PJ3RF4L78BWifQlB/lNaK3K38A50=\"}},\"hash\":\"3fGdeOeIHY0QdItY+bcwOV7vJyIM8nUR0VQt22QcwVs=\",\"text\":\"## Introduction\\n\\nIn the preceding chapter, deconvolution approaches were discussed in the context\\nof functional magnetic resonance imaging (fMRI) data analysis as they offer the\\nremarkable ability to estimate neuronal-related activity without the need for\\nprior information on the timings of the blood oxygenation level-dependent (BOLD)\\nevents via a linear time-invariant model (i.e., a forward model of the BOLD\\nresponse) that is then inverted by means of regularized least-squares estimators\\nto deconvolve the neuronal-related activity at each voxel\\n[@Gitelman2003Modelingregionalpsychophysiologic;@Khalidov2011ActiveletsWaveletssparse;@Karahanoglu2013TotalactivationfMRI;@HernandezGarcia2011Neuronaleventdetection;@Gaudes2010Detectioncharacterizationsingle;@Gaudes2013Paradigmfreemapping]. In particular, the sparse Paradigm Free Mapping (SPFM) method\\n[@Gaudes2013Paradigmfreemapping], which is the basis of this work, employs\\nsparsity-promoting regularization terms based on the L1-norm of the estimates\\n(e.g., using the LASSO or the Dantzig Selector). Importantly, inverse problem\\nsolving is linked to a dilemma that has yet to be solved: the selection of the\\nregularization parameters that yield accurate estimates. As described in the\\nprevious chapter,  methods based on model selection criteria after the\\ncomputation of the entire regularization path\\n[@Gaudes2013Paradigmfreemapping] or iterative procedures so that the\\nvariance of the residuals after deconvolution is equal to a prior estimate of\\nthe noise variance [@Karahanoglu2013TotalactivationfMRI] have been\\npreviously used in the literature for parameter tuning due to their reduced\\ncomputational cost. Yet, these methods offer no information about the\\nappropriateness of the selected parameters. This chapter proposes the use of the subsampling approach of stability selection\\n[@Meinshausen2010Stabilityselection] with the SPFM algorithm\\n[@Gaudes2013Paradigmfreemapping] to avoid the choice of any regularization\\nparameter and account for the likelihood of the different possible estimates in\\nthe regularization path. Although stability selection has been previously\\nproposed in fMRI data analysis, for example in the estimation of functional\\nconnectivity matrices from partial correlations with sparse estimators\\n[@Ryali2012Estimationfunctionalconnectivity] and to detect change points in\\ntime-varying functional connectivity with the graphical lasso\\n[@Cribben2013Detectingfunctionalconnectivity], its application for the\\ndeconvolution of the fMRI signal is innovative. Further, this chapter implements\\na novel procedure that enables to benefit from the computational speed of the\\nleast angle regression algorithm [@Efron2004Leastangleregression] in\\ncombination with the robustness of stability selection. This chapter uses a modification of the original SPFM formulation called *block model* --and\\nintroduced in -- that computes estimates of the innovation signal of the\\nneuronal-related signal (i.e., defining its changes)\\n[@Karahanoglu2013TotalactivationfMRI;@Cherkaoui2019Sparsitybasedblind;@Urunuela2023HemodynamicDeconvolutionDemystified],\\nrather than the signal itself. The block model formulation fits the data used in this study better\\nas it improves the estimation of neuronal-related events with long, sustained activity\\n[@Karahanoglu2013TotalactivationfMRI;@Cherkaoui2019Sparsitybasedblind;@Urunuela2023HemodynamicDeconvolutionDemystified]\\nthat cannot be adequately described by conventional spike-like models\\n[@Khalidov2011ActiveletsWaveletssparse;@Gaudes2010Detectioncharacterizationsingle;@Gaudes2013Paradigmfreemapping]. Nevertheless, the proposed stability selection procedure can be readily implemented for the spike\\nmodel. The chapter is organized as follows: in  the signal model and the\\nstability-based SFPM algorithm are introduced; in , the results of\\napplying this new algorithm on experimental fMRI data are presented and compare them to the\\nprevious SPFM algorithm. (sec-stability-model)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"0207982b-2fad-477b-a1c0-486b3d42303b":{"__data__":"{\"id_\":\"0207982b-2fad-477b-a1c0-486b3d42303b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"2bd3581e-f791-4d91-a713-f494cb2481b3\",\"metadata\":{},\"hash\":\"D+GvrN1K9yn8kULoCQZm/Yz1DXCZRPl+gZMta4xiGbo=\"}},\"hash\":\"tVb7H2jIKT57sBZW7DMmLluMuRnm+Ubiv6mcnoM2uH0=\",\"text\":\"## Signal Model and Deconvolution with Stability-Based Paradigm Free Mapping\\n\\nFor the sake of completeness, this section revises the signal model for hemodynamic deconvolution,\\nwhich was already described in . In fMRI data analysis, the signal of a\\nvoxel $y(t)$ is commonly modelled as the convolution of an underlying neuronal-related signal\\n$s(t)$ with the hemodynamic response function (HRF) $h(t)$, plus a white noise component: $y(t)=\\nh(t)*s(t)+n(t)$, or $\\\\mathbf{y}=\\\\mathbf{Hs}+\\\\mathbf{n}$ in a discrete-time matrix notation. Typically, the neuronal-related signal $s(t)$ is represented as a train of Dirac impulses at the\\nfMRI timescale associated with the experimental design. This model of the neuronal-related signal\\nhas been adopted by previous deconvolution algorithms\\n[@HernandezGarcia2011Neuronaleventdetection;@Gaudes2010Detectioncharacterizationsingle;@Gaudes2013Paradigmfreemapping]\\nrelying on regularized least-squares estimators as follows:\\n\\n```{math}\\n:label: eq-stability-inverse-problem-spike\\n\\\\mathbf{\\\\hat{s}} = \\\\arg \\\\min_{\\\\mathbf{s}} \\\\frac{1}{2} \\\\|\\\\mathbf{y} - \\\\mathbf{Hs}\\\\|_2^2 + \\\\lambda \\\\|\\\\mathbf{s}\\\\|_p,\\n\\\\label{eq-stability-inverse-problem-spike}\\n```\\n\\nwhere the $L_p$-norm $\\\\| \\\\mathbf{s} \\\\|_p$ penalizes the amplitude of the coefficients of the\\nneuronal-related signal, e.g., $p = 2$ (i.e., ridge regression) and $p = 1$ (i.e., LASSO) were\\nemployed in [@Gaudes2010Detectioncharacterizationsingle] and [@Gaudes2013Paradigmfreemapping],\\nrespectively. Instead of the on/off pattern described by Dirac impulses, the neuronal-related\\nsignal $\\\\mathbf{s}$ can also be represented as a piecewise constant signal in terms of its\\ninnovation signal $\\\\mathbf{u}$ (i.e., its first derivative in time). Defining\\n$\\\\mathbf{s}=\\\\mathbf{Lu}$ where $\\\\mathbf{L}$ corresponds to the discrete integration operator\\n[@Cherkaoui2019Sparsitybasedblind], the signal model can be written as:\\n\\n```{math}\\n:label: eq-stability-signal-model\\n\\\\mathbf{y} = \\\\mathbf{HLu} + \\\\mathbf{n},\\n```\\n\\nwhere $\\\\mathbf{y}, \\\\mathbf{u}, \\\\mathbf{s}, \\\\mathbf{n} \\\\in \\\\mathbb{R}^N$, $L \\\\in \\\\mathbb{R}^{NxN}$,\\nand $\\\\mathbf{H} \\\\in \\\\mathbb{R}^{NxN}$ is the Toeplitz convolution matrix with shifted HRFs, where\\n$N$ is the number of observations of the fMRI signal. The signal $\\\\mathbf{u}$ will represent those\\ninstances when significant changes in the neuronal-related activity occur. Since the innovation\\nsignal $\\\\mathbf{u}$ is sparser than the neuronal-related signal $\\\\mathbf{s}$, it is also a more\\nadequate representation if the temporal deconvolution of the fMRI time series of each voxel is\\nperformed with L1-norm regularized estimators as follows:\\n\\n```{math}\\n:label: eq-stability-inverse-problem-innovation\\n\\\\mathbf{\\\\hat{u}} = \\\\arg \\\\min_{\\\\mathbf{u}} \\\\frac{1}{2} \\\\|\\\\mathbf{y} - \\\\mathbf{HLu}\\\\|_2^2 + \\\\lambda \\\\|\\\\mathbf{u}\\\\|_1. ```\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"72b16eca-6207-479c-80aa-c8f4ff91166a":{"__data__":"{\"id_\":\"72b16eca-6207-479c-80aa-c8f4ff91166a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"4508de05-dfb5-4242-8801-0b8069d8fb89\",\"metadata\":{},\"hash\":\"zPfAPO3KwyRyamCait5QeXtFdoOIvEDaF8c0GKmsBbg=\"}},\"hash\":\"/8VLc24OpBSeTK2buxZHEa8pYBgDQF407rhrNFTwoAw=\",\"text\":\"### Combining Stability Selection with Least Angle Regression\\n\\nAn appropriate choice of the regularization parameter $\\\\lambda$ in\\nEq. %s or\\nEq. %s is crucial for appropriate hemodynamic deconvolution. Several techniques to select it have already been proposed, such as based on the\\nBayesian Information Criterion [@Gaudes2013Paradigmfreemapping]. However,\\nthese techniques do not provide a solution that is robust regardless\\nof the different characteristics the data may show (e.g., signal-to-noise ratio,\\noccurrence and duration of neuronal events). This problem can be overcome by implementing a novel procedure based on the stability selection\\napproach [@Meinshausen2010Stabilityselection]. This procedure generates $T = 100$ surrogate\\ndatasets $y_i  (i=1,\\\\dots,T)$ where the original voxel time series is randomly subsampled to retain\\n60\\\\% of its time points. Then, the optimization problem in\\nEq. %s is solved for each surrogate dataset, where the\\nmodel matrix $\\\\mathbf{H}$ is subsampled accordingly. Then, the stability paths of the signal\\n$\\\\mathbf{u}$ for each surrogate $i$ and each time point $t$ (i.e., $u_t^i$) are computed, which\\nrepresent the probability of the coefficient being non-zero for a given $\\\\lambda$. Originally, the\\nstability selection approach operates by solving Eq. %s for\\na predefined set of $\\\\lambda$ values, for example by means of the fast iterative shrinkage\\nthresholding algorithm (FISTA) [@Beck2009FastIterativeShrinkage]. Instead, this chapter\\nproposes to use the least angle regression (LARS) algorithm [@Efron2004Leastangleregression],\\nwhich computes the entire regularization path for an optimal decreasing set of $\\\\lambda$ values and\\nis faster than FISTA [@Beck2009FastIterativeShrinkage] for our purposes. Then, for each\\nsurrogate, the estimate $u_{(\\\\lambda_l,t)^i}$ at the regularization parameter $\\\\lambda_l$ and time\\npoint $t$ is binarized as $c_{(\\\\lambda_l,t)^i}=0$ if $u_{(\\\\lambda_l,t)^i}=0$ or $c_{(\\\\lambda_l,t)^i}=1$\\notherwise. To overcome the fact that solving Eq. %s with\\nthe LARS algorithm will generate a different set of $\\\\lambda$ values in each subsampled surrogate,\\na new set of $\\\\lambda$ values is created. This new set contains all of the regularization\\nparameters from all of the surrogate-specific regularization paths in decreasing order. The\\ncoefficients $c_{(\\\\lambda_l,t)^i}$ remain 0 or 1 according to the preceding value of $\\\\lambda_l^i$\\ncorresponding to the surrogate-specific regularization path computed by LARS. This step allows us\\nto calculate the probabilities that construct the stability paths as the ratio of surrogates where\\neach coefficient $u_{(\\\\lambda,t)}$ is different from 0 at each $\\\\lambda$. Furthermore, unlike in the original stability selection procedure that sets a given\\nprobability threshold to select the final set of non-zero coefficients, this implementation\\ncalculates the area under the curve (AUC) of the stability paths of each coefficient $u_t$ as follows:\\n\\n```{math}\\n:label: eq-stability-auc\\n\\\\text{AUC}_t = \\\\frac{\\\\sum_{l=1}^L \\\\lambda_l P\\\\left( u_{\\\\lambda_l,t} \\\\neq 0 \\\\right)}{\\\\sum_{l=1}^L \\\\lambda_l},\\n```\\n\\nwhere\\n\\n```{math}\\n:label: eq-stability_auc_2\\nP\\\\left( u_{\\\\lambda_l,t} \\\\neq 0 \\\\right) = T^{-1} \\\\sum_{i=1}^T c_{\\\\lambda_l,t}^i,\\n```\\n\\nrepresents the selection probability of coefficient $u_{(\\\\lambda,t)}$ for a particular choice of the\\nregularization parameter $\\\\lambda_l$, and $L$ is the total number of regularization parameters from\\nall of the LARS regularization paths. Hence, the voxelwise time series $\\\\text{AUC}(t)$ reveals the\\nmost prominent coefficients indicating the probability of activation at each time point.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"f817d16e-eb2e-4767-be63-850963e81eea":{"__data__":"{\"id_\":\"f817d16e-eb2e-4767-be63-850963e81eea\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"7dc135f1-4be1-447f-89d0-6c0ec9a6da79\",\"metadata\":{},\"hash\":\"q8BsnVcRpESDw1PTz4Gqm4Su1me72Nn2oAdftkZVEHU=\"}},\"hash\":\"k30o+XkbDjiGvw5W3VX3NSN5W/CWy1bNL5JAOWrQW0Y=\",\"text\":\"### Thresholding and Debiasing\\n\\nAfterwards, the AUC time series for each voxel are thresholded to identify those instances with\\nhigh probability of a significant change in neuronal-related activity occurring. This threshold is\\nbased on a given percentile (or maximum) of the AUC values in a region of interest where no BOLD\\nsignal changes related to neuronal activity are assumed to occur (or can be detected). For example,\\nthe threshold can be set to the 99th percentile of the AUC values of deep white matter (DWM) voxels\\n(see ). Finally, it is recommended to remove the bias in the estimates of the neuronal-related signal\\nowing to the L1-norm regularization term. For the signal model in\\nEq. %s used in the original SPFM approach\\n[@Gaudes2013Paradigmfreemapping], a debiased estimate of $\\\\mathbf{s}$ can\\nbe obtained by solving a least squares problem with a selection of\\nnon-zero AUC coefficients. Rather, in the signal model with the innovation signal, the selected non-zero\\ncoefficients of $\\\\mathbf{u}$ are used to define a matrix $\\\\mathbf{A}$ whose\\ncolumns are activation segments with piecewise constant unit between two\\nnon-zero coefficients of $\\\\mathbf{u}$ [@Zoller2019RobustRecoveryTemporal]. A final debiased estimate of $\\\\mathbf{s}$ is obtained by solving the following\\nleast squares problem:\\n\\n```{math}\\n:label: eq-stability-debiasing-innovation\\n\\\\mathbf{\\\\hat{u}} = \\\\arg \\\\min_{\\\\mathbf{u}} \\\\|\\\\mathbf{y} - \\\\mathbf{HAu}\\\\|_2^2\\n```\\n\\n```{figure} figures/stability/pipeline.jpg\\n:align: center\\n:label: fig-stability-flowchart\\n\\nFlowchart of the stability-based SPFM algorithm. ```\\n\\n illustrates the flowchart of the proposed stability-based SPFM algorithm. (sec-stability-methods)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"48374e1f-e5b8-4591-85c2-11b85ce3689b":{"__data__":"{\"id_\":\"48374e1f-e5b8-4591-85c2-11b85ce3689b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"44f80043-3701-4f1e-90c6-48972ba77ab3\",\"metadata\":{},\"hash\":\"SIPETwEvKCwNpBF8ie4X+ZXdiZHRQn3LdpkkJcbqS5c=\"}},\"hash\":\"ydk9SVm2qh637AkX8y7PGu72xFJ/9xd01Ti2CVMHy/U=\",\"text\":\"## Methods\\n\\nThe operation of the proposed stability-selection SPFM algorithm is illustrated\\nin a dataset collected on a healthy subject in a 7T MR scanner (Siemens) using a\\n32-channel receive transmit coil. The subject was scanned under a Cleveland\\nClinic Institutional Review Board approved protocol (QED, Cleveland, OH). A\\nvolumetric MP2RAGE image was acquired for anatomical visualization. Two fMRI\\ndatasets were acquired with a simultaneous multislice EPI sequence (MB factor =\\n3, TE = 21 ms, field of view = $192 \\\\times 192 \\\\; \\\\text{mm}^2$) at TR = 2800 ms\\n($1.2 \\\\times 1.2 \\\\times 1.5 \\\\; \\\\text{mm}^3$, flip angle = 55º) and 500 ms ($3\\n\\\\times 3 \\\\times 3 \\\\; \\\\text{mm}^3$, flip angle = 70º). For both TRs, the subject\\nperformed finger tapping events with the right index and thumb fingers every 45\\ns, where a single tap was performed in the first 6 minutes, or 10 taps quickly\\nfor the remaining 4 minutes. The onsets and durations of the paradigm are shown\\nas gray vertical lines in  (a) and\\n (a). Data preprocessing comprised an initial correction for motion using SLOMOCO2\\n[@Beall2014SimPACEGeneratingsimulated], detrending of 6th order Legendre\\npolynomials and normalization to signal percentage change (SPC) with AFNI. Furthermore, a mask of white matter voxels was computed from the anatomical\\nimage with 3dSeg, which was then eroded 2 voxels to delimit voxels in deep white\\nmatter in the functional space. The preprocessed fMRI data were analyzed with\\nthree different methods: 1) a traditional general linear model (GLM) analysis\\nusing the onsets and durations of the tapping events; 2) the original SPFM\\napproach (3dPFM) using the LASSO for deconvolution and selection of the\\nregularization parameter based on the Bayesian Information Criterion (BIC)\\n[@Gaudes2013Paradigmfreemapping]; and 3) the novel stability-based SPFM\\nwith and without the integration operator in its formulation. Both SPFM\\napproaches used the double-gamma canonical HRF as a model for deconvolution\\n(SPMG1 shape in *3dDeconvolve* in AFNI). Previous to the final debiasing step,\\nspatio-temporal clustering of a minimum of 5 contiguous voxels with activation\\n(i.e., non-zero coefficient after thresholding) in a temporal window of $\\\\pm 1$\\nTR was also performed to remove spurious, scattered activations. (sec-stability-results)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"0b2e3d13-9f45-46a8-9e11-d3d1643ffb97":{"__data__":"{\"id_\":\"0b2e3d13-9f45-46a8-9e11-d3d1643ffb97\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"afa821b1-1afe-4d78-b934-1a997d0c5f0d\",\"metadata\":{},\"hash\":\"/yQsp2IeDl8DCyaFGpdBv6kkKuZw3zA7TIpravXqKJw=\"},\"NEXT\":{\"nodeId\":\"d4646e08-c99c-4036-8c33-ce327b52104a\",\"metadata\":{},\"hash\":\"6QnrEhPsvCsX82iDl56WNJr32OIbvSTECi6cjSt5tow=\"}},\"hash\":\"aMr632dDiiYFC9dMTp1v2i36UKbg5kXzrkVnveSpWnY=\",\"text\":\"## Results and Discussion\\n\\n```{figure} figures/stability/stability_results_a.jpg\\n:align: center\\n:label: fig-stability-results-a\\n\\nComparison of the novel stability-based SPFM approach with the SPFM\\nand the GLM methods for data with TR = 0.5 s and a voxel size of $3 {mm}^3$\\niso. (a) plots the time series of the voxels marked with a cross in (c)\\ncontaining the raw data and the estimates of the different methods as shown\\nin the legend. Onsets and duration of the finger-tapping are depicted as\\ngray vertical lines. (b) shows the estimates of the different methods fitted\\nwith the canonical HRF. (c) shows the estimated maps of each of the methods\\nfor different finger-tapping events. ```\\n\\n```{figure} figures/stability/stability_results_b.jpg\\n:align: center\\n:label: fig-stability-results-b\\n\\nComparison of the novel stability-based SPFM approach with the SPFM\\nand the GLM methods for data with TR = 2.8 s and a voxel size of\\n$1.2\\\\times1.2\\\\times1.5 {mm}^3$. (a) plots the time series of the voxels\\nmarked with a cross in (c) containing the raw data and the estimates of the\\ndifferent methods as shown in the legend. Onsets and duration of the\\nfinger-tapping are depicted as gray vertical lines. (b) shows the estimates\\nof the different methods fitted with the canonical HRF. (c) shows the\\nestimated maps of each of the methods for different finger-tapping events. ```\\n\\n and  depict the\\nactivity maps estimated with all of the methods for different representative\\nfinger-tapping instants and the time courses of a voxel in the left primary\\nmotor cortex (marked with a white cross in the maps) for the high temporal and\\nlow spatial resolution dataset  (a, b and c) and\\nthe low temporal and high spatial resolution dataset\\n (a, b and c). In the high temporal and low spatial resolution scenario (i.e., a high\\ncontrast-to-noise ratio regime), the activity maps in\\n (c) illustrate that the original SPFM is able to\\ndetect finger tapping events with a high specificity. Implementing stability\\nselection on the original SPFM algorithm increases the sensitivity while\\nmaintaining the specificity. However, as it can be seen in\\n (a), the lack of an integration operator yields\\nvery variable estimates of the neuronal-related signal after debiasing with\\nleast squares (here scaled by 0.05 for visualization purposes) due to the large\\ncorrelation of the debiasing model with contiguous non-zero coefficients at this\\nfast temporal resolution. Conversely, the novel stability-based SPFM with the\\nintegration operator shows activity maps that are comparable to the ground truth\\ndespite the lower amplitude of the estimates. Yet, it can be observed that the\\nsignal model with the integrator overestimates the duration of the piecewise\\nconstant estimates for the short finger tapping events. Thus, in this scenario,\\nthe use of the stability selection and the innovation signal exhibits a similar\\nperformance to the original SPFM algorithm using LASSO and BIC since the high\\nSNR and high temporal resolution (TR = 0.5 s) enables a precise and clear\\ncharacterization of the dynamics of the BOLD signal, which facilitates the\\ndifferentiation between noise and neuronal-related signal. In an acquisition with a high spatial resolution and a low temporal resolution\\n(i.e., a low contrast-to-noise ratio regime), \\n(a), (b) and (c) demonstrate that the novel stability-based SPFM approach is\\nable to detect more finger-tapping events and their associated brain activity\\nthan the original SPFM method. This advantage is clearly seen in the case of the\\nsingle-tapping events, which exhibit a lower amplitude in the response than the\\nlong events with ten consecutive finger taps. The stability selection proves to\\nbe essential in correctly estimating finger tapping events, regardless of the\\nuse of the integration operator. The addition of the integration operator to the\\nSPFM model produces activity maps that are closer to the ground truth of the GLM\\nanalysis (see  c), even though the duration of\\nthe piecewise constant estimates is overestimated (see\\n a). In this regime, the BIC criterion in the\\noriginal SPFM is not able to discern between neuronal-related events and noise,\\nfailing to detect the finger tapping events, probably as the shape of the BOLD\\nresponse, which takes 4-6 s to reach its maximum amplitude, cannot be properly\\ncharacterized by the model owing to the low temporal resolution (TR = 2.8 s).\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"d4646e08-c99c-4036-8c33-ce327b52104a":{"__data__":"{\"id_\":\"d4646e08-c99c-4036-8c33-ce327b52104a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"afa821b1-1afe-4d78-b934-1a997d0c5f0d\",\"metadata\":{},\"hash\":\"/yQsp2IeDl8DCyaFGpdBv6kkKuZw3zA7TIpravXqKJw=\"},\"PREVIOUS\":{\"nodeId\":\"0b2e3d13-9f45-46a8-9e11-d3d1643ffb97\",\"metadata\":{},\"hash\":\"aMr632dDiiYFC9dMTp1v2i36UKbg5kXzrkVnveSpWnY=\"}},\"hash\":\"6QnrEhPsvCsX82iDl56WNJr32OIbvSTECi6cjSt5tow=\",\"text\":\"Hence, the stability selection procedure exhibits a robust performance at\\ncorrectly estimating the neuronal-related events resulting from the finger\\ntapping tasks, which showcases that the additions to the SPFM technique are\\npromising, especially in low temporal resolution settings.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8a4ec560-1915-40a4-b1bf-3e7eea743739":{"__data__":"{\"id_\":\"8a4ec560-1915-40a4-b1bf-3e7eea743739\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"4a72806f-ba1b-4781-8061-63099840abac\",\"metadata\":{},\"hash\":\"NiEIFTHt0nJHyg5YqiPnXKCQOfc4OJiiOHlW3xLJKBk=\"},\"NEXT\":{\"nodeId\":\"05f8a896-0111-4f97-b210-d932112bce46\",\"metadata\":{},\"hash\":\"+lb+YKthMreEAyi3+3V4pEGhjbBPPCB3G2XE2llNV94=\"}},\"hash\":\"wg6XZFPs8zsSPxn6pyHcCkCBI9z6sqAM0Puntp1/L9Q=\",\"text\":\"# Supplementary Material for Chapter 2\\n\\n```{figure} figures/synthesis_analysis/supp_hrf_differences.png\\n:align: center\\n:label: fig-hrf-differences\\n\\nActivity-inducing (A) and innovation (B) signals estimated with\\nPFM (red) and TA (blue) using their built-in HRF as opposed to using the\\nsame. The black line depicts the simulated signal, while the green lines\\nindicate the onsets of the simulated neuronal events. X axis shows time\\nin TRs. ```\\n\\n```{figure} figures/synthesis_analysis/regpath_spike.png\\n:align: center\\n:label: fig-path-spike\\n\\nSpike model simulations. (Left) Heatmap of the regularization\\npaths of the activity-inducing signal estimated with PFM and TA as a\\nfunction of $\\\\lambda$ (increasing number of iterations in x-axis),\\nwhereas each row in the y-axis shows one time-point. Vertical lines\\ndenote iterations corresponding to the Akaike and Bayesian Information\\nCriteria (AIC and BIC) optima. (Right) Estimated activity-inducing (blue)\\nand activity-related (green) signals when set based on BIC. All estimates\\nare identical, regardless of SNR. ```\\n\\n```{figure} figures/synthesis_analysis/regpath_block.png\\n:align: center\\n:label: fig-path-block\\n\\nBlock model simulations. (Left) Heatmap of the regularization\\npaths of the innovation signal estimated with PFM and TA as a function\\nof $\\\\lambda$ (increasing number of iterations in x-axis), whereas\\neach row in the y-axis illustrates one time-point. Vertical lines denote\\niterations corresponding to the Akaike and Bayesian Information Criteria\\n(AIC and BIC) optima. (Right) Estimated innovation (blue) and\\nactivity-related (green) signals when is set based on BIC. All the\\nestimates are identical when compared between the PFM and TA cases,\\nregardless of SNR. ```\\n\\n```{figure} figures/synthesis_analysis/supp_lambdas_map.png\\n:align: center\\n:label: fig-lambdas\\n\\nValues of $\\\\lambda$ across the different voxels in the brain\\nused to estimate (A) the activity-inducing signal (spike model) and (B)\\nthe innovation signal (block model) with the BIC selection, as well as\\n(C) the activity-inducing signal (block model) and (D) the innovation\\nsignal (block model) with a MAD-based selection. The $\\\\lambda$ maps are\\nshown for the three experimental fMRI datasets: the motor task (Motor),\\nthe monoband resting-state (Mono), and the multiband resting-state (Multi)\\ndatasets. ```\\n\\n```{figure} figures/synthesis_analysis/supp_mad_estimate.png\\n:align: center\\n:label: fig-mad-estimate\\n\\nValues of the MAD estimate of standard deviation of the noise\\nacross the different voxels in the brain for the three experimental fMRI\\ndatasets: the motor task (Motor), the monoband resting-state (Mono), and\\nthe multiband resting-state (Multi) datasets. ```\\n\\n```{figure} figures/synthesis_analysis/supp_rss_comparison.png\\n:align: center\\n:label: fig-rss-comparison\\n\\nRoot sum of squares (RSS) comparison between Paradigm Free Mapping\\nand Total Activation for the three experimental fMRI datasets: the motor\\ntask (Motor), the monoband resting-state (Mono), and the multiband\\nresting-state (Multi) datasets. RSS maps are shown for the spike (left) and\\nblock (right) models solved with a selection of $\\\\lambda$ based on the BIC\\n(top) and MAD (bottom) criteria. ```\\n\\n```{figure} figures/synthesis_analysis/supp_motor_regpaths.png\\n:align: center\\n:label: fig-motor-regpaths\\n\\nRegularization paths of the innovation signal estimated with\\nPFM and TA as a function of $\\\\lambda$ (increasing number of iterations in\\nx-axis, whereas each row in the y-axis shows one time-point) for the\\nrepresentative voxels of the motor task shown in Figure \\\\cref{fig:task_maps}. Vertical lines denote selections of $\\\\lambda$ corresponding to the BIC\\n(black), MAD based on LARS residuals (blue) and MAD based on FISTA residuals\\n(green) optima.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"05f8a896-0111-4f97-b210-d932112bce46":{"__data__":"{\"id_\":\"05f8a896-0111-4f97-b210-d932112bce46\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"4a72806f-ba1b-4781-8061-63099840abac\",\"metadata\":{},\"hash\":\"NiEIFTHt0nJHyg5YqiPnXKCQOfc4OJiiOHlW3xLJKBk=\"},\"PREVIOUS\":{\"nodeId\":\"8a4ec560-1915-40a4-b1bf-3e7eea743739\",\"metadata\":{},\"hash\":\"wg6XZFPs8zsSPxn6pyHcCkCBI9z6sqAM0Puntp1/L9Q=\"}},\"hash\":\"+lb+YKthMreEAyi3+3V4pEGhjbBPPCB3G2XE2llNV94=\",\"text\":\"```\\n\\n```{figure} figures/synthesis_analysis/supp_mad_inno_ts.png\\n:align: center\\n:label: fig-mad-inno-ts\\n\\nEstimated innovation signal (blue) and activity-related signal\\n(green) for the representative voxels of the motor task shown in\\nFigure~\\\\cref{fig:task_maps} with the MAD selection of $\\\\lambda$ made by TA,\\ni.e., employing the same $\\\\lambda$ with both PFM and TA. ```\\n\\n```{figure} figures/synthesis_analysis/supp_task_maps_mad.png\\n:align: center\\n:label: fig-task-mad\\n\\nActivity maps of the motor task using a seletion of $\\\\lambda$ based\\non the MAD estimate. Row 1: Activation time-series of the innovation signals\\nestimated by PFM (in blue) or TA (in red) calculated as the sum of squares\\nof all voxels at every timepoint. Positive-valued and negative-valued\\ncontributions were separated into two distinct time-courses. Color-bands\\nindicate the onset and duration of each condition in the task (green:\\ntongue, purple: left-hand finger-tapping, blue: right-hand finger-tapping,\\nred: left-foot toes, orange: right-foot toes). Rows 2-6: time-series of a\\nrepresentative voxel for each task with the PFM-estimated innovation (blue),\\nPFM-estimated activity-inducing (green), and activity-related (i.e., fitted,\\norange) signals, with their corresponding GLM, PFM, and TA maps on the\\nright. The maps shown on the right are sampled at the time-point labeled\\nwith the red arrows and display the innovation signals at that moment across\\nthe whole brain. ```\\n\\n```{figure} figures/synthesis_analysis/supp_caps_mad.png\\n:align: center\\n:label: fig-caps-mad\\n\\nActivity-inducing CAPs (left) and innovation CAPs (right) obtained\\nwith the PFM-estimated activity-inducing and innovation signals\\nrespectively, using a MAD-based selection of $\\\\lambda$. Time-points selected\\nwith a 95th percentile threshold are shown over the average time-series\\n(blue) in the seed region (white-cross) and the deconvolved signal (orange). CAPs and seed correlation maps are illustrated in the center. ```\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"7a4e5ebf-ebc8-41f5-ba25-d45becc4e6ee":{"__data__":"{\"id_\":\"7a4e5ebf-ebc8-41f5-ba25-d45becc4e6ee\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"52a5268f-f97e-47f2-9dfe-e066e5e968de\",\"metadata\":{},\"hash\":\"2pJNpt7jJ0fHrxdz0Y7kDoipcfwYBHmxGGmXDLIiSJU=\"}},\"hash\":\"X+7oZAnUOvAx6ctol8XaX1zMNOw+SSypitgHOieXIjk=\",\"text\":\"# Chapter 2: Synthesis-Based and Analysis-Based Hemodynamic Deconvolution for fMRI\\n\\nThis chapter was published as @Urunuela2023HemodynamicDeconvolutionDemystified. Deconvolution of the hemodynamic response is an important step to access short timescales of brain\\nactivity recorded by functional magnetic resonance imaging (fMRI). Albeit conventional\\ndeconvolution algorithms have been around for a long time (e.g., Wiener deconvolution), recent\\nstate-of-the-art methods based on sparsity-pursuing regularization are attracting increasing\\ninterest to investigate brain dynamics and connectivity with fMRI. This chapter describes the\\nprinciples of hemodynamic deconvolution in fMRI, and revisits the main concepts underlying two main\\nsparsity-promoting deconvolution algorithms, Paradigm Free Mapping and Total Activation, in an\\naccessible manner. Despite their apparent differences in the formulation, these methods are shown\\ntheoretically equivalent as they represent the synthesis and analysis sides of the same problem,\\nrespectively. This chapter demonstrates this equivalence in practice with their best-available\\nimplementations using both simulations, with different signal-to-noise ratios, and experimental\\nfMRI data acquired during a motor task and resting-state. The chapter also evaluates the parameter\\nsettings that lead to equivalent results, and showcases the operation of these algorithms in\\ncomparison with Coactivation Pattern analysis. This note is useful for practitioners interested in\\ngaining a better understanding of state-of-the-art hemodynamic deconvolution, and aims to answer\\nquestions regarding the differences between the two methods. % Introduction (sec-synthesis-introduction)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"04c7287a-0ead-4f59-918d-190064482777":{"__data__":"{\"id_\":\"04c7287a-0ead-4f59-918d-190064482777\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371\",\"metadata\":{},\"hash\":\"G2H9k6YzEATFD8jw6B7koYgb8g1Y9izHmyH+LL54S8E=\"},\"NEXT\":{\"nodeId\":\"b846ee94-2c29-4416-921c-d603e7c79c8c\",\"metadata\":{},\"hash\":\"RQ8Mm1pkO6B6tl1H+JpxNrFdP4dREpyJn95nh9xrJw4=\"}},\"hash\":\"aZjfhhVSzYlSDN/vhQXpgTYraCjQ7/WUr4gGGdiyoyg=\",\"text\":\"## Introduction\\n\\nFunctional magnetic resonance imaging (fMRI) data analysis is often directed to identify and\\ndisentangle the neural processes that occur in different brain regions during task or at rest. As\\nthe blood oxygenation level-dependent (BOLD) signal of fMRI [@Ogawa1990Brainmagneticresonance] is\\nonly a proxy for neuronal activity mediated through neurovascular coupling\\n[@Logothetis2001Neurophysiologicalinvestigationbasis], an intermediate step that estimates the\\nactivity-inducing signal, at the timescale of fMRI, from the BOLD timeseries can be useful. Conventional analysis of task fMRI data relies on the general linear models (GLM) to establish\\nstatistical parametric maps of brain activity by regression of the empirical timecourses against\\nhypothetical ones built from the knowledge of the experimental paradigm\\n[@Boynton1996LinearSystemsAnalysis;@Cohen1997ParametricAnalysisfMRI;@Friston1998EventRelatedfMRI;@Friston2008DEMvariationaltreatment]. However, timing information of the paradigm can be unknown, inaccurate, or insufficient in some\\nscenarios such as naturalistic stimuli, resting-state, or clinically-relevant assessments. Deconvolution and methods alike are aiming to estimate neuronal activity by undoing the blurring\\neffect of the hemodynamic response, characterized as a hemodynamic response function\\n(HRF)[^hemodynamic]. Given the inherently ill-posed nature of hemodynamic deconvolution, due to the\\nsluggish characteristics of the HRF, the key is to introduce additional constraints in the\\nestimation problem that are typically expressed as regularization terms. For instance, the\\nso-called Wiener deconvolution is expressing a \\\"minimal energy\\\" constraint on the deconvolved\\nsignal, and has been used in the framework of psychophysiological interaction analysis to compute\\nthe interaction between a seed's activity-inducing timecourse and an experimental modulation\\n[@Glover1999DeconvolutionImpulseResponse;@Gitelman2003Modelingregionalpsychophysiologic;@Gerchen2014Analyzingtaskdependent;@Di2018TaskConnectomicsExamining;@Freitas2020Timeresolvedeffective]. Complementarily, the interest in deconvolution has increased to explore time-varying activity in\\nresting-state fMRI data\\n[@Preti2017dynamicfunctionalconnectome;@Keilholz2017TimeResolvedResting;@Lurie2020Questionscontroversiesstudy;@Bolton2020TappingMultiFaceted]. In that case, the aim is to gain better insights of the neural signals that drive functional\\nconnectivity at short time scales, as well as learning about the spatio-temporal structure of\\nfunctional components that dynamically construct resting-state networks and their interactions\\n[@Karahanoglu2017Dynamicslargescale]. Deconvolution of the resting-state fMRI signal has illustrated the significance of transient,\\nsparse spontaneous events [@Petridou2013PeriodsrestfMRI;@Allan2015FunctionalConnectivityMRI] that\\nrefine the hierarchical clusterization of functional networks [@Karahanoglu2013TotalactivationfMRI]\\nand reveal their temporal overlap based on their signal innovations not only in the human brain\\n[@Karahanoglu2015Transientbrainactivity], but also in the spinal cord\\n[@Kinany2020DynamicFunctionalConnectivity]. Similar to task-related studies, deconvolution allows\\nto investigate modulatory interactions within and between resting-state functional networks\\n[@Di2013ModulatoryInteractionsResting;@Di2015Characterizationsrestingstate]. In addition, decoding\\nof the deconvolved spontaneous events allows to decipher the flow of spontaneous thoughts and\\nactions across different cognitive and sensory domains while at rest\\n[@Karahanoglu2015Transientbrainactivity;@GonzalezCastillo2019Imagingspontaneousflow;@Tan2017DecodingfMRIevents]. Beyond findings on healthy subjects, deconvolution techniques have also proven its utility in\\nclinical conditions to characterize functional alterations of patients with a progressive stage of\\nmultiple sclerosis at rest [@Bommarito2021Alteredanteriordefault], to find functional signatures of\\nprodromal psychotic symptoms and anxiety at rest on patients suffering from schizophrenia\\n[@Zoeller2019LargeScaleBrain], to detect the foci of interictal events in epilepsy patients without\\nan EEG recording [@Lopes2012Detectionepilepticactivity;@Karahanoglu2013Spatialmappinginterictal],\\nor to study functional dissociations observed during non-rapid eye movement sleep that are\\nassociated with reduced consolidation of information and impaired consciousness\\n[@Tarun2021NREMsleepstages].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b846ee94-2c29-4416-921c-d603e7c79c8c":{"__data__":"{\"id_\":\"b846ee94-2c29-4416-921c-d603e7c79c8c\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371\",\"metadata\":{},\"hash\":\"G2H9k6YzEATFD8jw6B7koYgb8g1Y9izHmyH+LL54S8E=\"},\"PREVIOUS\":{\"nodeId\":\"04c7287a-0ead-4f59-918d-190064482777\",\"metadata\":{},\"hash\":\"aZjfhhVSzYlSDN/vhQXpgTYraCjQ7/WUr4gGGdiyoyg=\"}},\"hash\":\"RQ8Mm1pkO6B6tl1H+JpxNrFdP4dREpyJn95nh9xrJw4=\",\"text\":\"The algorithms for hemodynamic deconvolution can be classified based on the assumed hemodynamic\\nmodel and the optimization problem used to estimate the neuronal-related signal. Most approaches\\nassume a linear time-invariant model for the hemodynamic response that is inverted by means of\\nvariational (regularized) least squares estimators\\n[@Glover1999DeconvolutionImpulseResponse;@Gitelman2003Modelingregionalpsychophysiologic;@Gaudes2010Detectioncharacterizationsingle;@Gaudes2012Structuredsparsedeconvolution;@Gaudes2013Paradigmfreemapping;@CaballeroGaudes2019deconvolutionalgorithmmulti;@HernandezGarcia2011Neuronaleventdetection;@Karahanoglu2013TotalactivationfMRI;@Cherkaoui2019Sparsitybasedblind;@Huetel2021Hemodynamicmatrixfactorization;@Costantini2022Anisotropic4DFiltering],\\nlogistic functions\\n[@Bush2013Decodingneuralevents;@Bush2015deconvolutionbasedapproach;@Loula2018DecodingfMRIactivity],\\nprobabilistic mixture models [@Pidnebesna2019EstimatingSparseNeuronal], convolutional autoencoders\\n[@Huetel2018NeuralActivationEstimation] or nonparametric homomorphic filtering\\n[@Sreenivasan2015NonparametricHemodynamicDeconvolution]. Alternatively, several methods have also\\nbeen proposed to invert non-linear models of the neuronal and hemodynamic coupling\\n[@Riera2004statespacemodel;@Penny2005Bilineardynamicalsystems;@Friston2008DEMvariationaltreatment;@Havlicek2011Dynamicmodelingneuronal;@Aslan2016Jointstateparameter;@Madi2017HybridCubatureKalman;@RuizEuler2018NonlinearDeconvolutionSampling]. Among the variety of approaches, those based on regularized least squares estimators have been\\nemployed more often due to their appropriate performance at small spatial scales (e.g., voxelwise). Relevant for this work, two different formulations can be established for the regularized\\nleast-squares deconvolution problem, either based on a synthesis- or analysis-based model\\n[@Elad2007Analysisversussynthesis;@Ortelli2019Synthesisanalysistotal]. On the one hand, Paradigm\\nFree Mapping is based on a synthesis formulation that is solved by means of regularized\\nleast-squares estimators such as ridge-regression [@Gaudes2010Detectioncharacterizationsingle] or\\nLASSO [@Gaudes2013Paradigmfreemapping]. The rationale of the synthesis-based model is that we know\\nor suspect that the true signal (here, the neuronally-driven BOLD component of the fMRI signal) can\\nbe represented as a linear combination of predefined patterns or dictionary atoms (for instance,\\nthe hemodynamic response function). On the other hand, Total Activation is based on a analysis\\nformulation that is solved with a regularized least-squares estimator using generalized total\\nvariation [@Karahanoglu2011SignalProcessingApproach;@Karahanoglu2013TotalactivationfMRI]. The\\nrationale of the analysis-based approach considers that the true signal is analyzed by some\\nrelevant hemodynamic operator [@Khalidov2011ActiveletsWaveletssparse] and the resulting signal is\\nsparse in time. The users of these algorithms have often questioned about the similarities and differences between\\nthe two methods and which one is better. To clarify this point, this chapter initially presents the\\ntheory behind these two deconvolution approaches: Paradigm Free Mapping (PFM)\\n[@Gaudes2013Paradigmfreemapping] -- available in AFNI as *3dPFM*[^3dPFM] and *3dMEPFM*[^3dMEPFM]\\nfor single-echo and multi-echo data, respectively -- and Total Activation (TA)\\n[@Karahanoglu2013TotalactivationfMRI] -- available as part of the *iCAPs toolbox*[^iCAPs]. The\\nchapter describes the similarities and differences in their analytical formulations, and how they\\ncan be related to each other. Next, their performance is assessed controlling for a fair comparison\\non simulated and experimental data. Finally, the chapter discusses their benefits and shortcomings\\nand conclude with our vision on potential extensions and developments. % Theory (sec-synthesis-theory)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"47ba07f4-659f-4441-8479-4452e0b7d259":{"__data__":"{\"id_\":\"47ba07f4-659f-4441-8479-4452e0b7d259\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"dcd87579-1e63-4eed-9010-7e505f44ec5d\",\"metadata\":{},\"hash\":\"a3uNR4IxiJhsOBHDXYzYdYr5ulaLJQP3pIcuIGwCGaY=\"}},\"hash\":\"GPqctFcVZk33yASfhVQo1PnkE1p1Hh/dSCaUw7BxYX0=\",\"text\":\"## Theory\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"c0b3134f-46f0-472c-b56a-a15559132b15":{"__data__":"{\"id_\":\"c0b3134f-46f0-472c-b56a-a15559132b15\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"3b303dfd-82db-4de5-8baa-5144a18ae7b7\",\"metadata\":{},\"hash\":\"ykEjL/G6W+qJ4K0vfrN0smC3WQCyzC4VHkI4ZWUIiYc=\"}},\"hash\":\"0txM6/p0hB0qGqn4HB9o0Ph1HVgCiFRpx0mtByeGVFg=\",\"text\":\"### Notations and Definitions\\n\\nMatrices of size $N$ rows and $M$ columns are denoted by boldface capital letters, e.g.,\\n$\\\\mathbf{X} \\\\in \\\\mathbb{R}^{N\\\\times M}$, whereas column vectors of length $N$ are denoted as\\nboldface lowercase letters, e.g., $\\\\mathbf{x} \\\\in \\\\mathbb{R}^{N}$. Scalars are denoted by lowercase\\nletters, e.g., $k$. Continuous functions are denoted by brackets, e.g., $h(t)$, while discrete\\nfunctions are denoted by square brackets, e.g., $x[k]$. The Euclidean norm of a matrix $\\\\mathbf{X}$\\nis denoted as $\\\\|\\\\mathbf{X}\\\\|_2$, the $\\\\ell_1$-norm is denoted by $\\\\| \\\\mathbf{X} \\\\|_1$ and the\\nFrobenius norm is denoted by $\\\\| \\\\mathbf{X} \\\\|_F$. The discrete integration ($\\\\mathbf{L}$) and\\ndifference ($\\\\mathbf{D}$) operators are defined as:\\n\\n```{math}\\n\\\\mathbf{L} = \\\\left[\\\\begin{array}{ccccc}\\n1 & 0 & \\\\ldots & & \\\\\\\\\\n1 & 1 & 0 & \\\\ldots & \\\\\\\\\\n1 & 1 & 1 & 0 & \\\\ldots \\\\\\\\\\n\\\\vdots & \\\\ddots & \\\\ddots & \\\\ddots & \\\\ddots\\n\\\\end{array}\\\\right], \\\\quad \\\\mathbf{D} = \\\\left[\\\\begin{array}{ccccc}\\n1 & 0 & \\\\ldots & & \\\\\\\\\\n1 & -1 & 0 & \\\\ldots & \\\\\\\\\\n0 & \\\\ddots & \\\\ddots & \\\\ddots & \\\\ldots \\\\\\\\\\n\\\\vdots & \\\\ddots & 0 & 1 & -1\\n\\\\end{array}\\\\right]. ```\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"587e581a-3f38-4640-9f06-493a8d8bc2e9":{"__data__":"{\"id_\":\"587e581a-3f38-4640-9f06-493a8d8bc2e9\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"de01d306-f9af-40a1-b099-d58106c559a6\",\"metadata\":{},\"hash\":\"qsRcpLsysnJNOrI2llhmFUYZXq+Jy93uDAis9Rfe04c=\"},\"NEXT\":{\"nodeId\":\"a04a9c68-9c4a-44aa-b469-c6214883f7ec\",\"metadata\":{},\"hash\":\"TOcv9TiEDNZV8jKjive9JnUk2TFRReNVOARwBnHfDjI=\"}},\"hash\":\"9JnAYRzxiuuHNHC9WZ95mOgHWrGL3pYk5Hai9xJ4THA=\",\"text\":\"### General Linear Model Analysis\\n\\nA conventional general linear model (GLM) analysis puts forward a number of regressors\\nincorporating the knowledge about the paradigm or behavior. For instance, the timing of epochs for\\na certain condition can be modeled as an indicator function $p(t)$ (e.g., Dirac functions for\\nevent-related designs or box-car functions for block-designs) convolved with the hemodynamic\\nresponse function (HRF) $h(t)$, and sampled at the repetition time (TR) resolution\\n[@Friston1994AnalysisfunctionalMRI;@Friston1998EventRelatedfMRI;@Boynton1996LinearSystemsAnalysis;@Cohen1997ParametricAnalysisfMRI]:\\n\\n```{math}\\nx(t) = p*h(t) \\\\rightarrow x[k] = p*h(k\\\\cdot\\\\text{TR}). ```\\n\\nThe vector $\\\\mathbf{x}=[x[k]]_{k=1,\\\\ldots,N} \\\\in \\\\mathbb{R}^{N}$ then constitutes the regressor\\nmodelling the hypothetical response, and several of them can be stacked as columns of the design\\nmatrix $\\\\mathbf{X}=[\\\\mathbf{x}_1 \\\\ldots \\\\mathbf{x}_L] \\\\in \\\\mathbb{R}^{N \\\\times L}$, leading to the\\nwell-known GLM formulation:\\n\\n```{math}\\n:label: eq-glm\\n\\\\mathbf{y} = \\\\mathbf{X} \\\\boldsymbol\\\\beta + \\\\mathbf{e},\\n```\\n\\nwhere the empirical timecourse $\\\\mathbf{y} \\\\in \\\\mathbb{R}^{N}$ is explained by a linear combination\\nof the regressors in $\\\\mathbf{X}$ weighted by the parameters in $\\\\boldsymbol\\\\beta \\\\in\\n\\\\mathbb{R}^{L}$ and corrupted by additive noise $\\\\mathbf{e}\\\\in \\\\mathbb{R}^{N}$. Under independent\\nand identically distributed Gaussian assumptions of the latter, the maximum likelihood estimate of\\nthe parameter weights reverts to the ordinary least-squares estimator; i.e., minimizing the\\nresidual sum of squares between the fitted model and measurements. The number of regressors $L$ is\\ntypically much less than the number of measurements $N$, and thus the regression problem is\\nover-determined and does not require additional constraints or assumptions\\n[@Henson2007CHAPTER14Convolution]. In the deconvolution approach, no prior knowledge of the hypothetical response is taken into\\naccount, and the purpose is to estimate the deconvolved activity-inducing signal $\\\\mathbf{s}$ from\\nthe measurements $\\\\mathbf{y}$, which can be formulated as the following signal model\\n\\n```{math}\\n:label: eq-synthesis_model\\n\\\\mathbf{y} = \\\\mathbf{Hs} + \\\\mathbf{e},\\n```\\n\\nwhere $\\\\mathbf{H} \\\\in \\\\mathbb{R}^{N \\\\times N}$ is a Toeplitz matrix that represents the discrete\\nconvolution with the HRF, and $\\\\mathbf{s} \\\\in \\\\mathbb{R}^{N}$ is a length-$N$ vector with the\\nunknown activity-inducing signal. Note that the temporal resolution of the activity-inducing signal\\nand the corresponding Toeplitz matrix is generally assumed to be equal to the TR of the\\nacquisition, but it could also be higher if an upsampled estimate is desired. Despite the apparent\\nsimilarity with the GLM equation, there are two important differences. First, the multiplication\\nwith the design matrix of the GLM is an expansion as a weighted linear combination of its columns,\\nwhile the multiplication with the HRF matrix represents a convolution operator. Second, determining\\n$\\\\mathbf{s}$ is an ill-posed problem given the nature of the HRF. As it can be seen intuitively,\\nthe convolution matrix $\\\\mathbf{H}$ is highly collinear (i.e., its columns are highly correlated)\\ndue to large overlap between shifted HRFs (see C), thus introducing uncertainty\\nin the estimates of $\\\\mathbf{s}$ when noise is present. Consequently, additional assumptions under\\nthe form of regularization terms (or priors) in the estimate are needed to reduce their variance. In the least squares sense, the optimization problem to solve is given by\\n\\n```{math}\\n:label: eq-regularized-least-squares\\n\\\\hat{\\\\mathbf{s}} = \\\\arg \\\\min_{\\\\mathbf{s}} \\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{Hs} \\\\|_2^2 + \\\\Omega(\\\\mathbf{s}).\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"a04a9c68-9c4a-44aa-b469-c6214883f7ec":{"__data__":"{\"id_\":\"a04a9c68-9c4a-44aa-b469-c6214883f7ec\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"de01d306-f9af-40a1-b099-d58106c559a6\",\"metadata\":{},\"hash\":\"qsRcpLsysnJNOrI2llhmFUYZXq+Jy93uDAis9Rfe04c=\"},\"PREVIOUS\":{\"nodeId\":\"587e581a-3f38-4640-9f06-493a8d8bc2e9\",\"metadata\":{},\"hash\":\"9JnAYRzxiuuHNHC9WZ95mOgHWrGL3pYk5Hai9xJ4THA=\"}},\"hash\":\"TOcv9TiEDNZV8jKjive9JnUk2TFRReNVOARwBnHfDjI=\",\"text\":\"```\\n\\nThe first term quantifies data fitness, which can be justified as the log-likelihood term derived\\nfrom Gaussian noise assumptions, while the second term $\\\\Omega(\\\\mathbf{s})$ brings in\\nregularization and can be interpreted as a prior on the activity-inducing signal. For example, the\\n$\\\\ell_2$-norm of $\\\\mathbf{s}$ (i.e., $\\\\Omega(\\\\mathbf{s})=\\\\lambda \\\\left\\\\| \\\\mathbf{s}\\\\right\\\\|_2^2$)\\nis imposed for ridge regression or Wiener deconvolution, which introduces a trade-off between the\\ndata fit term and \\\"energy\\\" of the estimates that is controlled by the regularization parameter\\n$\\\\lambda$. Other well-known regularized terms are related to the elastic net (i.e.,\\n$\\\\Omega(\\\\mathbf{x})=\\\\lambda_1\\\\|\\\\mathbf{x}\\\\|_2^2 + \\\\lambda_2\\\\|\\\\mathbf{x}\\\\|_1$)\\n[@Zou2005Regularizationvariableselection]. %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% % Paradigm Free Mapping\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8ccaaee2-9402-4125-bce6-12b7c8abcf6d":{"__data__":"{\"id_\":\"8ccaaee2-9402-4125-bce6-12b7c8abcf6d\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"21ae3777-92ef-4f21-9baf-233040386b72\",\"metadata\":{},\"hash\":\"m7yPN70ObblK9UDVcz0mqRRUHGd9V+RJ9BprXNBdYv0=\"}},\"hash\":\"rT/Sstm6TFI+vx7SMmr2LpgahFkvYDupgCyhEu8CaPo=\",\"text\":\"### Paradigm Free Mapping\\n\\nIn Paradigm Free Mapping (PFM), the formulation of Eq. %s was\\nconsidered equivalently as fitting the measurements using the atoms of the HRF dictionary (i.e.,\\ncolumns of $\\\\mathbf{H}$) with corresponding weights (entries of $\\\\mathbf{s}$). This model\\ncorresponds to a synthesis formulation. In @Gaudes2013Paradigmfreemapping a sparsity-pursuing\\nregularization term was introduced on $\\\\mathbf{s}$, which in a strict way reverts to choosing\\n$\\\\Omega(\\\\mathbf{s})=\\\\lambda \\\\| \\\\mathbf{s} \\\\|_0$ as the regularization term and solving the\\noptimization problem [@Bruckstein2009SparseSolutionsSystems]. However, finding the optimal solution\\nto the problem demands an exhaustive search across all possible combinations of the columns of\\n$\\\\mathbf{H}$. Hence, a  pragmatic solution is to solve the convex-relaxed optimization problem for\\nthe $l_1$-norm, commonly known as Basis Pursuit Denoising [@Chen2001Atomicdecompositionbasis] or\\nequivalently as the least absolute shrinkage and selection operator (LASSO)\\n[@Tibshirani1996RegressionShrinkageSelection]:\\n\\n```{math}\\n:label: eq-pfm-spike\\n\\\\hat{\\\\mathbf{s}} = \\\\arg \\\\min_{\\\\mathbf{s}} \\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{Hs} \\\\|_2^2 + \\\\lambda \\\\| \\\\mathbf{s} \\\\|_1,\\n```\\n\\nwhich provides fast convergence to a global solution. Imposing sparsity on the activity-inducing\\nsignal implies that it is assumed to be well represented by a reduced subset of few non-zero\\ncoefficients at the fMRI timescale, which in turn trigger event-related BOLD responses. Hereinafter, this assumption is referred to as the *spike model*. However, even if PFM was\\ndeveloped as a spike model, its formulation in Eq. %s can be extended to estimate\\nthe innovation signal, i.e., the derivative of the activity-inducing signal, as shown in\\n. %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% % Total Activation\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"b8b1ed7c-72b1-4d98-8021-740f80668bb4":{"__data__":"{\"id_\":\"b8b1ed7c-72b1-4d98-8021-740f80668bb4\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"ccdf9472-a393-49b2-b512-47b9e9150147\",\"metadata\":{},\"hash\":\"T257+1SV09ZyfOdhgNNpi3g7NXs6jb48pPAPN5kSakU=\"}},\"hash\":\"wqCleOsTX/DCE6emV/6A5u+Wmai//+ldJOyWeunZ3pc=\",\"text\":\"### Total Activation\\n\\nAlternatively, deconvolution can be formulated as if the signal to be recovered directly fits the\\nmeasurements and at the same time satisfies some suitable regularization, which leads to\\n\\n```{math}\\n:label: eq-analysis-model\\n\\\\hat{\\\\mathbf{x}} = \\\\arg \\\\min_{\\\\mathbf{x}} \\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{x} \\\\|_2^2 + \\\\Omega(\\\\mathbf{x}). ```\\n\\nUnder this analysis formulation, total variation (TV), i.e., the $\\\\ell_1$-norm of the derivative\\n$\\\\Omega(\\\\mathbf{x})=\\\\lambda \\\\|\\\\mathbf{Dx}\\\\|_1$, is a powerful regularizer since it favors recovery\\nof piecewise-constant signals [@Chambolle2004algorithmtotalvariation]. Going beyond, the approach\\nof generalized TV introduces an additional differential operator $\\\\mathbf{D_H}$ in the regularizer\\nthat can be tailored as the inverse operator of a linear system\\n[@Karahanoglu2011SignalProcessingApproach], that is, $\\\\Omega(\\\\mathbf{x})=\\\\lambda \\\\|\\\\mathbf{D D_H\\nx}\\\\|_1$. In the context of hemodynamic deconvolution, Total Activation is proposed for which the\\ndiscrete operator $\\\\mathbf{D_H}$ is derived from the inverse of the continuous-domain linearized\\nBalloon-Windkessel model [@Buxton1998Dynamicsbloodflow;@Friston2000NonlinearresponsesfMRI]. The\\ninterested reader is referred to\\n[@Khalidov2011ActiveletsWaveletssparse;@Karahanoglu2011SignalProcessingApproach;@Karahanoglu2013TotalactivationfMRI]\\nfor a detailed description of this derivation. Therefore, the solution of the Total Activation (TA) problem\\n\\n```{math}\\n:label: eq-TA\\n\\\\hat{\\\\mathbf{x}} = \\\\arg \\\\min_{\\\\mathbf{x}} \\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{x} \\\\|_2^2 + \\\\lambda \\\\|\\\\mathbf{D D_H x} \\\\|_1\\n```\\n\\nwill yield the activity-related signal $\\\\mathbf{x}$ for which the activity-inducing signal\\n$\\\\mathbf{s}=\\\\mathbf{D_H x}$ and the so-called innovation signal $\\\\mathbf{u}=\\\\mathbf{Ds}$, i.e., the\\nderivate of the activity-inducing signal, will also be available, as they are required for the\\nregularization. Modeling the activity-inducing signal based on the innovation signal is referred to\\nas the *block model*. Nevertheless, even if TA was originally developed as a block model, its\\nformulation in Eq. %s can be made equivalent to the spike model as shown in\\n. (sec-unifying-both-perspectives)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"37a6034a-3024-4810-b3b8-37bd9a7e75e9":{"__data__":"{\"id_\":\"37a6034a-3024-4810-b3b8-37bd9a7e75e9\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"642f306a-ef53-4442-8cc1-568b44d8fb5c\",\"metadata\":{},\"hash\":\"GUIcpyrCI6lAdGFqz2cOJg4PuQbdC2tsVojxvOu34ag=\"}},\"hash\":\"UNRStXjBGd/WVhyygwWt/lAthUSp7QMwnapO32ryBvw=\",\"text\":\"### Unifying Both Perspectives\\n\\nPFM and TA are based on the synthesis- and analysis-based formulation of the deconvolution problem,\\nrespectively. They are also tailored for the spike and block model, respectively. In the first\\ncase, the recovered deconvolved signal is synthesized to be matched to the measurements, while in\\nthe second case, the recovered signal is directly matched to the measurements but needs to satisfy\\nits analysis in terms of deconvolution. This also corresponds to using the forward or backward\\nmodel of the hemodynamic system, respectively. Hence, it is possible to make both approaches\\nequivalent [@Elad2007Analysisversussynthesis][^total_variation]. To start with, TA can be made equivalent to PFM by adapting it for the spike model; i.e., when\\nremoving the derivative operator $\\\\mathbf{D}$ of the regularizer in Eq. %s, it can be\\nreadily verified that replacing in that case $\\\\mathbf{x}=\\\\mathbf{Hs}$ leads to identical equations\\nand thus both assume a spike model, since $\\\\mathbf{H}$ and $\\\\mathbf{D_H}$ will cancel out each\\nother [@Karahanoglu2011SignalProcessingApproach][^null_space]. Conversely, the PFM spike model can also accommodate the TA block model by modifying [Eq. %s](eq-pfm-spike) with the forward model $\\\\mathbf{y} = \\\\mathbf{H L u} + \\\\mathbf{e}$. Here, the\\nactivity-inducing signal $\\\\mathbf{s}$ is rewritten in terms of the innovation signal $\\\\mathbf{u}$\\nas $\\\\mathbf{s}=\\\\mathbf{Lu}$ where the matrix $\\\\mathbf{L}$ is the first-order integration operator\\n[@Cherkaoui2019Sparsitybasedblind;@Urunuela2020StabilityBasedSparse]. This way, PFM can estimate\\nthe innovation signal $\\\\mathbf{u}$ as follows:\\n\\n```{math}\\n:label: eq-pfm-block\\n\\\\hat{\\\\mathbf{u}} = \\\\arg \\\\min_{\\\\mathbf{u}} \\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{HLu} \\\\|_2^2 + \\\\lambda \\\\| \\\\mathbf{u} \\\\|_1,\\n```\\n\\nand becomes equivalent to TA by replacing $\\\\mathbf{u}=\\\\mathbf{D D_H x}$, and thus adopting the\\nblock model. Based on the previous equations (Eq. %s), (Eq. %s) and ([Eq. %s](eq-pfm-block)), it is clear that both PFM and TA can operate under the spike and block models,\\nproviding a convenient signal model according to the different assumptions of the underlying\\nneuronal-related signal. This work evaluates the core of the two techniques; i.e., the regularized\\nleast-squares problem with temporal regularization without considering the spatial regularization\\nterm originally incorporated in TA. For the remainder of this paper, the PFM and TA formalisms with\\nboth spike and block models are used. ```{figure} figures/synthesis_analysis/flowchart.png\\n:align: center\\n:label: fig-flowchart\\n\\nFlowchart detailing the different steps of the fMRI signal and the\\ndeconvolution methods described. The orange arrows indicate the flow to\\nestimate the innovation signals, i.e., the derivative of the\\nactivity-inducing signal. The blue box depicts the iterative \\\\textit{modus\\noperandi} of the two algorithms used in this paper to solve the paradigm\\nfree mapping (PFM) and Total Activation (TA) deconvolution problems. The plot on the\\nleft shows the regularization path obtained with the least angle regression\\n(LARS) algorithm, where the x-axis illustrates the different iterations of\\nthe algorithm, the y-axis represents points in time, and the color describes\\nthe amplitude of the estimated signal. The middle plot depicts the\\ndecreasing values of $\\\\lambda$ for each iteration of LARS as the\\nregularization path is computed. The green and red dashed lines in both\\nplots illustrate the Bayesian information criterion (BIC) and median\\nabsolute deviation (MAD) solutions, respectively. Comparatively, the changes\\nin $\\\\lambda$ when the fast iterative shrinkage-thresholding algorithm\\n(FISTA) method is made to converge to the MAD estimate of the noise are\\nshown on the right. Likewise, the $\\\\lambda$ corresponding to the BIC and MAD\\nsolutions are shown with dashed lines. ```\\n\\n(sec-regparam)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"738fd1b1-630c-4615-91fd-a92cee423c49":{"__data__":"{\"id_\":\"738fd1b1-630c-4615-91fd-a92cee423c49\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"524017f9-34f9-49f7-acd9-f3d12c662ab7\",\"metadata\":{},\"hash\":\"IGVBvL3VFj/W6LN0VXOvxM2dCmLHCCXQxpxMrI9Xz6U=\"}},\"hash\":\"L8FXREX6mYTOi/9oHieycs/E50u6/enoei5N/lU2GJI=\",\"text\":\"### Algorithms and Parameter Selection\\n\\nDespite their apparent resemblance, the practical implementations of the PFM and TA methods\\nproposed different algorithms to solve the corresponding optimization problem and select an\\nadequate regularization parameter $\\\\lambda$\\n[@Gaudes2013Paradigmfreemapping;@Karahanoglu2013TotalactivationfMRI]. The PFM implementation\\navailable in AFNI employs the least angle regression (LARS) [@Efron2004Leastangleregression],\\nwhereas the TA implementation uses the fast iterative shrinkage-thresholding algorithm (FISTA)\\n@Beck2009FastIterativeShrinkage]. The blue box in [ provides a descriptive view\\nof the iterative \\\\textit{modus operandi} of the two algorithms. On the one hand, LARS is a homotopy approach that computes all the possible solutions to the\\noptimization problem and their corresponding value of $\\\\lambda$; i.e., the regularization path, and\\nthe solution according to the Bayesian Information Criterion (BIC)\\n[@Schwarz1978EstimatingDimensionModel], was recommended as the most appropriate in the case of PFM\\napproaches since Akaike Information Criterion (AIC) often tends to overfit the signal\\n[@Gaudes2013Paradigmfreemapping;@CaballeroGaudes2019deconvolutionalgorithmmulti]. On the other hand, FISTA is an extension of the classical gradient algorithm that provides fast\\nconvergence for large-scale problems. In the case of FISTA though, the regularization parameter\\n$\\\\lambda$ must be selected prior to solving the problem, but can be updated in every iteration so\\nthat the residuals of the data fit converge to an estimated noise level of the data $\\\\hat{\\\\sigma}$:\\n\\n```{math}\\n:label: eq-std\\n\\\\lambda^{n+1} = \\\\frac{N \\\\hat{\\\\sigma}}{\\\\frac{1}{2} \\\\| \\\\mathbf{y} - \\\\mathbf{x}^n \\\\|_F^2} \\\\lambda^n,\\n```\\n\\nwhere $x^n$ is the $n^{th}$ iteration estimate, $\\\\lambda^n$ and $\\\\lambda^{n+1}$ are the $n^{th}$\\nand $n+1^{th}$ iteration values for the regularization parameter $\\\\lambda$, and $N$ is the number\\nof points in the time-course. The pre-estimated noise level can be obtained as the median absolute\\ndeviation (MAD) of the fine-scale wavelet coefficients (Daubechies, order 3) of the fMRI\\ntimecourse. The MAD criterion has been adopted in TA [@Karahanoglu2013TotalactivationfMRI]. Of\\nnote, similar formulations based on the MAD estimate have also been applied in PFM formulations\\n[@Gaudes2012Structuredsparsedeconvolution;@Gaudes2011Paradigmfreemapping]. % Methods (sec-synthesis-methods)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"cb87f621-d13d-414c-bafc-db4f6e74139b":{"__data__":"{\"id_\":\"cb87f621-d13d-414c-bafc-db4f6e74139b\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"bb3d8e14-26c4-4a6e-bd39-5b33f2e48550\",\"metadata\":{},\"hash\":\"Do2QgLIX5yZaQbB93a5zeE/1wfS6OfzsO9KbS0axJSc=\"}},\"hash\":\"iOKdIxCHGAcT5StJpE5fnClS7SHAHjuAWDqoS+u96v8=\",\"text\":\"## Methods\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"13b7c01f-cd7e-4604-917f-3b6b774a33c5":{"__data__":"{\"id_\":\"13b7c01f-cd7e-4604-917f-3b6b774a33c5\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"f03bce9e-eb76-4fb6-b489-6abc03f4e25f\",\"metadata\":{},\"hash\":\"sc2C4EgVcppv+ZBHoqbyeHLF8yvq0Hr/KU864bMrZU4=\"}},\"hash\":\"bIdrtI2bP7vXEcXbZf04wUe8+lJUoEz017KZJpxhd+w=\",\"text\":\"### Simulated data\\n\\n```{figure} figures/synthesis_analysis/sim_and_hrf.png\\n:align: center\\n:label: fig-sim-and-hrf\\n\\nA) Simulated signal with different SNRs (20 dB, 10 dB and 3 dB) and ground truth given in signal percentage change (SPC). B) Canonical HRF models typically used by PFM (solid line) and TA (dashed line) at TR = 0.5 s (blue), TR = 1 s (green) and TR = 2 s (black). Without loss of generality, the waveforms are scaled to unit amplitude for visualization. C) Representation of shifted HRFs at TR = 2 s that build the design matrix for PFM when the HRF model has been matched to that in TA. The red line corresponds to one of the columns of the HRF matrix. ```\\n\\nIn order to compare the two methods while controlling for their correct performance, a simulation\\nscenario was created, which can be found in the GitHub repository shared in\\n. For the sake of illustration, here the simulations correspond to a\\ntimecourse with a duration of 400 seconds (TR = 2 s) where the activity-inducing signal includes 5\\nevents, which are convolved with the canonical HRF. Different noise sources (physiological,\\nthermal, and motion-related) were also added and three different scenarios with varying\\nsignal-to-noise ratios (SNR = 20, 10, 3 dB) were simulated, which represent high, medium and low\\ncontrast-to-noise ratios as shown in A. Noise was created following the\\nprocedure in [@Gaudes2013Paradigmfreemapping] as the sum of uncorrelated Gaussian noise and\\nsinusoidal signals to simulate a realistic noise model with thermal noise, cardiac and respiratory\\nphysiological fluctuations, respectively. The physiological signals were generated as\\n\\n```{math}\\n\\\\sum_{i=1}^{2} \\\\frac{1}{2^{i-1}}\\\\left(\\\\sin \\\\left(2 \\\\pi f_{r, i} t+\\\\phi_{\\\\mathrm{r}, i}\\\\right)+\\\\sin \\\\left(2 \\\\pi f_{c, i} t+\\\\phi_{c, i}\\\\right)\\\\right),\\n```\\n\\nwith up to second-order harmonics per cardiac (\\\\(f_{c,i}\\\\)) and respiratory (\\\\(f_{r,i}\\\\)) component\\nthat were randomly generated following normal distributions with variance 0.04 and mean \\\\(if_r\\\\)\\nand \\\\(if_c\\\\), for \\\\(i = [1, 2]\\\\). The fundamental frequencies were set to \\\\(f_r = 0.3\\\\) Hz for the\\nrespiratory component [@Birn2006Separatingrespiratoryvariation] and \\\\(f_c = 1.1\\\\) Hz for the\\ncardiac component [@Shmueli2007Lowfrequencyfluctuations]. The phases of each harmonic \\\\(\\\\phi\\\\) were\\nrandomly selected from a uniform distribution between 0 and 2$\\\\pi$ radians. To simulate\\nphysiological noise that is proportional to the change in BOLD signal, a variable ratio between the\\nphysiological (\\\\(\\\\sigma_P\\\\)) and the thermal (\\\\(\\\\sigma_0\\\\)) noise was modeled as\\n\\\\(\\\\sigma_P/\\\\sigma_0 = a(tSNR)^b + c\\\\), where \\\\(a = 5.01 \\\\times 10^{-6}\\\\), \\\\(b = 2.81\\\\), and \\\\(c =\\n0.397\\\\), following the experimental measures available in Table 3 from\\n[@Triantafyllou2005Comparisonphysiologicalnoise]). %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"46a39dea-e41d-4b19-ae03-c17be57a918a":{"__data__":"{\"id_\":\"46a39dea-e41d-4b19-ae03-c17be57a918a\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"bb8ac55f-7f0e-4b81-9902-49365a2cae2b\",\"metadata\":{},\"hash\":\"aCeLLJFJTU8nMv2EVUo7COabFEoS3GKDqTBgGPiq3qo=\"},\"NEXT\":{\"nodeId\":\"7e531466-1f3a-4d35-98f8-18f7ff6a4bf0\",\"metadata\":{},\"hash\":\"Lh9t15NqizyKU+iFEyEd6YKYb+rIKqf2/mI9UFKMYr0=\"}},\"hash\":\"jfh3Tn94Q+9afe3SjlnUi5YWSbNWzEV2PTINaFrlGPE=\",\"text\":\"### Experimental Data\\nTo compare the performance of the two approaches as well as illustrate their operation, two\\nrepresentative experimental datasets were employed. **Motor task dataset:** One healthy subject was scanned in a 3T MR scanner (Siemens) under a Basque\\nCenter on Cognition, Brain and Language Review Board-approved protocol. T2*-weighted multi-echo\\nfMRI data was acquired with a simultaneous-multislice multi-echo gradient echo-planar imaging\\nsequence, kindly provided by the Center of Magnetic Resonance Research (University of Minnesota,\\nUSA)\\n[@Feinberg2010MultiplexedEchoPlanar;@Moeller2010MultibandmultisliceGE;@Setsompop2011Blippedcontrolledaliasing],\\nwith the following parameters: 340 time frames, 52 slices, Partial-Fourier = 6/8, voxel size =\\n$2.4\\\\times2.4\\\\times3$ mm\\\\textsuperscript{3}, TR = 1.5 s, TEs = 10.6/28.69/46.78/64.87/82.96 ms,\\nflip angle = 70$^o$, multiband factor = 4, GRAPPA = 2. During the fMRI acquisition, the subject performed a motor task consisting of five different\\nmovements (left-hand finger tapping, right-hand finger tapping, moving the left toes, moving the\\nright toes and moving the tongue) that were visually cued through a mirror located on the head\\ncoil. These conditions were randomly intermixed every 16 seconds, and were only repeated once the\\nentire set of stimuli were presented. Data preprocessing consisted of first, discarding the first\\n10 volumes of the functional data to achieve a steady state of magnetization. Then, image\\nrealignment to the skull-stripped single-band reference image (SBRef) was computed on the first\\necho, and the estimated rigid-body spatial transformation was applied to all other echoes\\n[@Jenkinson2012FSL;@Jenkinson2001globaloptimisationmethod]. A brain mask obtained from the SBRef\\nvolume was applied to all the echoes and the different echo timeseries were optimally combined (OC)\\nvoxelwise by weighting each timeseries contribution by its T2* value\\n[@Posse1999EnhancementBOLDcontrast]. AFNI [@Cox1996AFNISoftwareAnalysis] was employed for a\\ndetrending of up to 4\\\\textsuperscript{th}-order Legendre polynomials, within-brain spatial\\nsmoothing (3 mm FWHM) and voxelwise signal normalization to percentage change. Finally, distortion\\nfield correction was performed on the OC volume with Topup\\n[@Andersson2003Howcorrectsusceptibility], using the pair of spin-echo EPI images with reversed\\nphase encoding acquired before the ME-EPI acquisition [@Glasser2016HumanConnectomeProjects]. **Resting-state datasets:** One healthy subject was scanned in a 3T MR scanner (Siemens) under a\\nBasque Center on Cognition, Brain and Language Review Board-approved protocol. Two runs of\\nT2*-weighted fMRI data were acquired during resting-state, each with 10 min duration, with 1) a\\nstandard gradient-echo echo-planar imaging sequence (monoband) (TR = 2000 ms, TE = 29 ms,\\nflip-angle = 78\\\\(^o\\\\), matrix size = $64\\\\times64$, voxel size = $3\\\\times3\\\\times3$ mm<sup>3</sup>,\\n33 axial slices with interleaved acquisition, slice gap = 0.6 mm) and 2) a  simultaneous-multislice\\ngradient-echo echo-planar imaging sequence (multiband factor = 3, TR = 800 ms, TE = 29 ms,\\nflip-angle = 60$^o$, matrix size = $64\\\\times64$, voxel size = $3\\\\times3\\\\times3$ mm<sup>3</sup>, 42\\naxial slices with interleaved acquisition, no slice gap). Single-band reference images were also\\ncollected in both resting-state acquisitions for head motion realignment. Field maps were also\\nobtained to correct for field distortions. During both acquisitions, participants were instructed to keep their eyes open, fixating a white\\ncross that they saw through a mirror located on the head coil, and not to think about anything\\nspecific. The data was pre-processed using AFNI [@Cox1996AFNISoftwareAnalysis]. First, volumes\\ncorresponding to the initial 10 seconds were removed to allow for a steady-state magnetization. Then, the voxel time-series were despiked to reduce large-amplitude deviations and slice-time\\ncorrected.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"7e531466-1f3a-4d35-98f8-18f7ff6a4bf0":{"__data__":"{\"id_\":\"7e531466-1f3a-4d35-98f8-18f7ff6a4bf0\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"bb8ac55f-7f0e-4b81-9902-49365a2cae2b\",\"metadata\":{},\"hash\":\"aCeLLJFJTU8nMv2EVUo7COabFEoS3GKDqTBgGPiq3qo=\"},\"PREVIOUS\":{\"nodeId\":\"46a39dea-e41d-4b19-ae03-c17be57a918a\",\"metadata\":{},\"hash\":\"jfh3Tn94Q+9afe3SjlnUi5YWSbNWzEV2PTINaFrlGPE=\"}},\"hash\":\"Lh9t15NqizyKU+iFEyEd6YKYb+rIKqf2/mI9UFKMYr0=\",\"text\":\"Inhomogeneities caused by magnetic susceptibility were corrected with FUGUE (FSL) using\\nthe field map images [@Jenkinson2012FSL]. Next, functional images were realigned to a base volume\\n(monoband: volume with the lowest head motion; multiband: single-band reference image). Finally, a\\nsimultaneous nuisance regression step was performed comprising up to 6<sup>th</sup>-order Legendre\\npolynomials, low-pass filtering with a cutoff frequency of 0.25 Hz (only on multiband data to match\\nthe frequency content of the monoband), 6 realignment parameters plus temporal derivatives, 5\\nprincipal components of white matter (WM), 5 principal components of lateral ventricle voxels\\n(anatomical CompCor) [@Behzadi2007componentbasednoise] and 5 principal components of the brain's\\nedge voxels [@Patriat2015UsingEdgeVoxel]. WM, cerebrospinal fluid (CSF) and brain's edge-voxel\\nmasks were obtained from Freesurfer tissue and brain segmentations. In addition, scans with\\npotential artifacts were identified and censored when the euclidean norm of the temporal derivative\\nof the realignment parameters (ENORM) was larger than 0.4, and the proportion of voxels adjusted in\\nthe despiking step exceeded 10%. %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"8f2895c7-92e8-46a3-ba09-402f6c038bc6":{"__data__":"{\"id_\":\"8f2895c7-92e8-46a3-ba09-402f6c038bc6\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"704ef6a6-07b6-47a5-9eef-4d6858d809ec\",\"metadata\":{},\"hash\":\"qpkea4hLM82V7wr+/jhfEzwHcpz7MQOcLDmjQ/+OKSI=\"}},\"hash\":\"rboqJ90H0JxAH5hoO/1HG6Ry6jkiusVJR6O+mcifINI=\",\"text\":\"### Selection of the Hemodynamic Response Function\\n\\nIn their original formulations, PFM and TA specify the discrete-time HRF in different ways. For\\nPFM, the continuous-domain specification of the canonical double-gamma HRF\\n[@Henson2007CHAPTER14Convolution] is sampled at the TR and then put as shifted impulse responses to\\nbuild the matrix $\\\\mathbf{H}$. In the case of TA, however, the continuous-domain linearized\\nversion of the balloon-windkessel model is discretized to build the linear differential operator in\\n$\\\\mathbf{D_H}$. While the TR only changes the resolution of the HRF shape for PFM, the impact of an\\nequivalent impulse response of the discretized differential operator at different TR is more\\npronounced. As shown in B, longer TR leads to equivalent impulse responses of\\nTA that are shifted in time, provoking a lack of the initial baseline and rise of the response. The\\nreader is referred to Figure S%s to see the differences in the estimation of the\\nactivity-inducing and innovation signals when both methods use the HRF in their original\\nformulation. To avoid differences between PFM and TA based on their built-in HRF, the synthesis\\noperator $\\\\mathbf{H}$ was built with shifted versions of the HRF given by the TA analysis operator\\n(e.g., see C for the TR=2s case). %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"5d63c4cc-b635-4955-b871-5e7d01c54b52":{"__data__":"{\"id_\":\"5d63c4cc-b635-4955-b871-5e7d01c54b52\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"0e40f47b-4360-479d-83a4-bedf0541ff93\",\"metadata\":{},\"hash\":\"UU8P5P/hcDum1R7i77m2Qd+zJMr3GphBiCZnMXLOyuA=\"}},\"hash\":\"ltLsOqoXUxbM9EL1go3CiExB+cQHGgcRY8LSFsPIMjE=\",\"text\":\"### Selection of the Regularization Parameter\\n\\nThe simulated data was used to compare the performance of the two deconvolution algorithms with\\nboth BIC and MAD criteria to set the regularization parameter $\\\\lambda$ (see ). Here, the evaluation also included investigating if the algorithms behave differently in terms of\\nthe estimation of the activity-inducing signal $\\\\mathbf{\\\\hat{s}}$ using the spike model described\\nin Eq. %s and the block model based on the innovation signal $\\\\mathbf{\\\\hat{u}}$ in\\nEq. %s. For selection based on the BIC, LARS was initally performed with the PFM deconvolution model to\\nobtain the solution for every possible $\\\\lambda$ in the regularization path. Then, the values of\\n$\\\\lambda$ corresponding to the BIC optimum were adopted to solve the TA deconvolution model by\\nmeans of FISTA. For a selection based on the MAD estimate of the noise, the temporal regularization in its original\\nform for TA was applied, whereas for PFM the selected $\\\\lambda$ corresponds to the solution whose\\nresiduals have the closest standard deviation to the estimated noise level of the data\\n$\\\\hat{\\\\sigma}$. %We do not introduce additional spatial regularization in any of the cases. %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"cd953628-34a1-4cc3-a5ac-ae0e04b94ac6":{"__data__":"{\"id_\":\"cd953628-34a1-4cc3-a5ac-ae0e04b94ac6\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"d52c5fcb-9a81-4883-9db2-45012509393f\",\"metadata\":{},\"hash\":\"CJmRvdeW6jIoRVlr8RLGcmwqwHWCSgBRCgz2Jpo8Tm0=\"}},\"hash\":\"6xEWOGlZlqF7kACKiD+HmzxEBrjMefO/py7FHyrxdis=\",\"text\":\"### Analyses in Experimental fMRI Data\\n\\n**Difference between approaches:** To assess the discrepancies between both approaches when applied\\non experimental fMRI data, the square root of the sum of squares of the differences (RSSD) between\\nthe activity-inducing signals estimated with PFM and TA were calculated on the three experimental\\ndatasets as\\n\\n```{math}\\n\\\\text{RSSD} = \\\\sqrt{\\\\frac{1}{N} \\\\sum_{k=1}^N (\\\\hat{s}_\\\\text{PFM}[k] - \\\\hat{s}_\\\\text{TA}[k])^2},\\n```\\n\\nwhere $N$ is the number of timepoints of the acquisition. The RSSD of the innovation signals\\n$\\\\mathbf{\\\\hat{u}}$ was computed equally. **Task fMRI data:** In the analysis of the motor task data, the performance of PFM and TA was\\nevaluated in comparison with a conventional General Linear Model analysis (*3dDeconvolve* in AFNI)\\nthat takes advantage of the information about the duration and onsets of the motor trials. Given\\nthe block design of the motor task, this comparison is only made with the block model. **Resting-state fMRI data:** The usefulness of deconvolution approaches in the analysis of\\nresting-state data where information about the timings of neuronal-related BOLD activity cannot be\\npredicted is also illustrated. Apart from being able to explore individual maps of deconvolved\\nactivity (i.e., innovation signals, activity-inducing signals, or hemodynamic signals) at the\\ntemporal resolution of the acquisition (or deconvolution), here the average extreme points of the\\nactivity-inducing and innovation maps (given that these examples do not have a sufficient number of\\nscans to perform a clustering step) is calculated to illustrate how popular approaches like\\nco-activation patterns (CAPs) [@Tagliazucchi2012Criticalitylargescale;@Liu2018Coactivationpatterns]\\nand innovation-driven co-activation patterns (iCAPs) [@Karahanoglu2015Transientbrainactivity] can\\nbe applied on the deconvolved signals to reveal patterns of coordinated brain activity. To achieve\\nthis, the average time-series was calculated in a seed of 9 voxels located in the precuneus,\\nsupramarginal gyrus, and occipital gyri independently, and solve the deconvolution problem to find\\nthe activity-inducing and innovation signals in the seeds. Then, a 95<sup>th</sup> percentile\\nthreshold was applied and the maps of the time-frames that survive the threshold were averaged. Finally, the same procedure was applied to the original--- i.e., non-deconvolved--- signal in the\\nseed and compare the results with the widely-used seed correlation approach. % Results (synthesis_results)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"54656135-4f51-40be-9bd4-d11b52e62454":{"__data__":"{\"id_\":\"54656135-4f51-40be-9bd4-d11b52e62454\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"9190086e-6658-4701-a671-1c824a661f31\",\"metadata\":{},\"hash\":\"20KySb9sxatKaNXkTRDFaaiD2JB5jYMGSgHc+C3Oo/o=\"}},\"hash\":\"pqRhk/VgKHZ08AQux+xz6Ue4xxb5DwcPr/gbouGFtuo=\",\"text\":\"## Results\\n\\n(sec:regpath)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"181b7a70-9fd7-48eb-af8f-b367d66d1de7":{"__data__":"{\"id_\":\"181b7a70-9fd7-48eb-af8f-b367d66d1de7\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"21f28f95-f326-4f5d-92cc-a48f7bd0dfeb\",\"metadata\":{},\"hash\":\"508T/dj87dbMfWDHZtCN0InJzqiaq8KF0TX98n+tUQU=\"}},\"hash\":\"seDFIZJFy43dDFVCGcsmQVYn/7ra++OZvLxoQ7T18qk=\",\"text\":\"### Performance Based on the Regularization Parameter\\n\\nA shows the regularization paths of PFM and TA side by side obtained for the spike model\\nof Eq. %s for SNR=3 dB. The solutions for all three SNR conditions are shown in\\nFigure S%s and Figure S%s. Starting from the maximum $\\\\lambda$ corresponding to a\\nnull estimate and for decreasing values of $\\\\lambda$, LARS computes a new estimate at the value of\\n$\\\\lambda$ that reduces the sparsity promoted by the $l_1$-norm and causes a change in the active\\nset of non-zero coefficients of the estimate (i.e., a zero coefficient becomes non-zero or vice\\nversa) as shown in the horizontal axis of the heatmaps. Vertical dashed lines depict the selection\\nof the regularization parameter based on the BIC, and thus, the colored coefficients indicated by\\nthese depict the estimated activity-inducing signal $\\\\mathbf{\\\\hat{{s}}}$. B illustrates\\nthe resulting estimates of the activity-inducing and activity-related hemodynamic signals when\\nbasing the selection of $\\\\lambda$ on the BIC for SNR=3 dB. Given that the regularization paths of\\nboth approaches are identical, it can be clearly observed that the BIC-based estimates are\\nidentical too for the corresponding $\\\\lambda$. Thus, A, B,\\nFigure S%s and Figure S%s demonstrate that, regardless of the simulated SNR\\ncondition, the spike model of both deconvolution algorithms produces identical regularization paths\\nwhen the same HRF and regularization parameters are applied, and hence, identical estimates of the\\nactivity-inducing signal $\\\\mathbf{\\\\hat{{s}}}$ and neuronal-related hemodynamic signal\\n$\\\\mathbf{\\\\hat{{x}}}$. Likewise, C demonstrates that the regularization paths for the block model defined in\\nEq. %s and Eq. %s also yield virtually identical estimates of the\\ninnovation signals for both PFM and TA methods. Again, the BIC-based selection of $\\\\lambda$ is\\nidentical for both PFM and TA. As illustrated in D, the estimates of the innovation\\nsignal $\\\\mathbf{u}$ also show no distinguishable differences between the algorithms. % Hence,\\nA-D demonstrate that both PFM and TA yield equivalent regularization paths and\\nestimates of the innovation signal and activity-inducing signal regardless of the simulated SNR\\ncondition when applying the same HRF and regularization parameters with the block and spike models. As for selecting $\\\\lambda$ with the MAD criterion defined in Eq. %s, E\\ndepicts the estimated activity-inducing and activity-related signals for the simulated low-SNR\\nsetting using the spike model, while F shows the estimated signals corresponding to the\\nblock model. Both plots in E and F depict nearly identical results between PFM and TA\\nwith both models. Given that the regularization paths of both techniques are identical, minor\\ndissimilarities are owing to the slight differences in the selection of $\\\\lambda$ due to the\\nquantization of the values returned by LARS. ```{figure} figures/synthesis_analysis/figure_sim.png\\n:align: center\\n:label: fig-sim\\n\\n(A) Heatmap of the regularization paths of the activity-inducing\\nsignals (spike model) estimated with PFM and TA as a function of $\\\\lambda$\\nfor the simulated data with SNR = 3 dB (x-axis: increasing number of\\niterations or $\\\\lambda$ as given by LARS; y-axis: time; color: amplitude). Vertical lines denote iterations corresponding to the BIC (dashed line) and\\nMAD (dotted line) selection of $\\\\lambda$. (B) Estimated activity-inducing\\n(blue) and activity-related (green) signals with a selection of $\\\\lambda$\\nbased on the BIC. Orange and red lines depict the ground truth. (C) Heatmap\\nof the regularization paths of the innovation signals (block model)\\nestimated with PFM and TA as a function of $\\\\lambda$ for the simulated data\\nwith SNR = 3 dB. (D) Estimated innovation (blue), activity-inducing (darker\\nblue), and activity-related (green) signals with a selection of $\\\\lambda$\\nbased on the BIC. (E) Activity-inducing and activity-related (fit,\\n$\\\\mathbf{x}$) signals estimated with PFM (top) and TA (bottom) when\\n$\\\\lambda$ is selected based on the MAD method with the spike model, and (F)\\nwith the block model for the simulated data with SNR = 3 dB. ```\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"452ed6ac-55b7-4dd5-97bd-9082ac2ff97f":{"__data__":"{\"id_\":\"452ed6ac-55b7-4dd5-97bd-9082ac2ff97f\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"5fa4039f-fd43-4ee3-a413-d53475b24a1f\",\"metadata\":{},\"hash\":\"WmwzGFrhM9BKvFfQwQPU4k5zlMqVqv9f7RK4P6NvZ7c=\"},\"NEXT\":{\"nodeId\":\"e3f223d9-d4bf-409d-aee5-67e5c5200449\",\"metadata\":{},\"hash\":\"ionkUsyN4pFQU75stvd0vrvl2B0aXz2dileXW02fuYw=\"}},\"hash\":\"YLFbUq72qUjcVoVDZ5mQNXfgcepFMgS9niTyZrLKAws=\",\"text\":\"### Performance on Experimental Data\\n\\n depicts the RSSD maps revealing differences between PFM and TA estimates for the spike\\n(A and C) and block (B and D) models when applied to the three experimental\\nfMRI datasets. The RSSD values are virtually negligible (i.e., depicted in yellow) in most of the\\nwithin-brain voxels and lower than the amplitude of the estimates of the activity-inducing and\\ninnovation signals. Based on the maximum value of the range shown in each image, it can be observed\\nthat the similarity between both approaches is more evident for the spike model (with both\\nselection criteria) and the block model with the BIC selection. However, given the different\\napproaches used for the selection of the regularization parameter $\\\\lambda$ based on the MAD\\nestimate of the noise (i.e., converging so that the residuals of FISTA are equal to the MAD\\nestimate of the noise for TA vs. finding the LARS residual that is closest to the MAD estimate of\\nthe noise), higher RSSD values can be observed with the largest differences occurring in gray\\nmatter voxels. These areas also correspond to low values of $\\\\lambda$ (see Figure S%s) and\\nMAD estimates of the noise (see Figure S%s), while the highest values are visible in\\nregions with signal droupouts, ventricles, and white matter. These differences that arise from the\\ndifferent approaches to find the optimal regularization parameter based on the MAD estimate of the\\nnoise can be clearly seen in the root sum of squares (RSS) of the estimates\\n(Figure S%s). These differences are also observable in the ATS calculated from\\nestimates obtained with the MAD selection as shown in Figure S%s. However, the identical\\nregularization paths shown in Figure S%s demonstrate that both methods perform\\nequivalently on experimental data (see estimates of innovation signal obtained with an identical\\nselection of $\\\\lambda$ in Figure S%s). Hence, the higher RSSD values originate from the\\ndifferent methods to find the optimal regularization parameter based on the MAD estimate of the\\nnoise that yield different solutions as shown by the dashed vertical lines in\\nFigure S%s. ```{figure} figures/synthesis_analysis/rssd_maps.png\\n:align: center\\n:label: fig-rss\\n\\nSquare root of the sum of squared differences (RSSD) between the estimates obtained with PFM and TA for (A) spike model (activity-inducing signal) and BIC selection of $\\\\lambda$, (B) block model (innovation signal) and BIC selection, (C) spike model (activity-inducing signal) and MAD selection, (D) block model (innovation signal) and MAD selection. RSSD maps are shown for the three experimental fMRI datasets: the motor task (Motor), the monoband resting-state (Mono), and the multiband resting-state (Multi) datasets. ```\\n\\n depicts the results of the analysis of the Motor dataset with the PFM and TA\\nalgorithms using the BIC selection of $\\\\lambda$ (see Figure S%s for results with MAD\\nselection), as well as a conventional GLM approach. The Activation Time Series (top left),\\ncalculated as the sum of squares of all voxel amplitudes (positive vs. negative) for a given moment\\nin time, obtained with PFM and TA show nearly identical patterns. These ATS help to summarize the\\nfour dimensional information available in the results across the spatial domain and identify\\ninstances of significant BOLD activity. The second to sixth rows show the voxel timeseries and the\\ncorresponding activity-related, activity-inducing and innovation signals obtained with PFM using\\nthe BIC criterion of representative voxels in the regions activated in each of the motor tasks. The\\nTA-estimated time-series are not shown because they were virtually identical. The maps shown on the\\nright correspond to statistical parametric maps obtained with the GLM for each motor condition ($p\\n< 0.001$) as well as the maps of the PFM and TA estimates at the onsets of individual motor events\\n(indicated with arrows in the timecourses). The estimated activity-related, activity-inducing and\\ninnovation signals clearly reveal the activity patterns of each condition in the task, as they\\nexhibit a BOLD response locked to the onset and duration of the conditions. Overall, activity maps\\nof the innovation signal obtained with PFM and TA highly resemble those obtained with a GLM for\\nindividual events, with small differences arising from the distinct specificity of the GLM and\\ndeconvolution analyses. Notice that the differences observed with the different approaches to\\nselect $\\\\lambda$ based on the MAD estimate shown in  are reflected on the ATS shown in\\nFigure S%s as well.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e3f223d9-d4bf-409d-aee5-67e5c5200449":{"__data__":"{\"id_\":\"e3f223d9-d4bf-409d-aee5-67e5c5200449\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"5fa4039f-fd43-4ee3-a413-d53475b24a1f\",\"metadata\":{},\"hash\":\"WmwzGFrhM9BKvFfQwQPU4k5zlMqVqv9f7RK4P6NvZ7c=\"},\"PREVIOUS\":{\"nodeId\":\"452ed6ac-55b7-4dd5-97bd-9082ac2ff97f\",\"metadata\":{},\"hash\":\"YLFbUq72qUjcVoVDZ5mQNXfgcepFMgS9niTyZrLKAws=\"}},\"hash\":\"ionkUsyN4pFQU75stvd0vrvl2B0aXz2dileXW02fuYw=\",\"text\":\"```{figure} figures/synthesis_analysis/task_maps.png\\n:align: center\\n:label: fig-task-maps\\n\\nActivity maps of the motor task using a selection of $\\\\lambda$ based on the BIC estimate. Row 1: Activation time-series (ATS) of the innovation signals estimated by PFM (in blue) or TA (in red) calculated as the sum of squares of all voxels at every timepoint. Positive-valued and negative-valued contributions were separated into two distinct time-courses. Color-bands indicate the onset and duration of each condition in the task (green: tongue motion, purple: left-hand finger-tapping, blue: right-hand finger-tapping, red: left-foot toes motion, orange: right-foot toes motion). Rows 2-6: time-series of a representative voxel for each task with the PFM-estimated innovation (blue), PFM-estimated activity-inducing (green), and activity-related (i.e., fitted, orange) signals, with their corresponding GLM, PFM, and TA maps on the right (representative voxels indicated with green arrows). Amplitudes are given in signal percentage change (SPC). The maps shown on the right are sampled at the time-points labeled with the red arrows and display the innovation signals at these moments across the whole brain. ```\\n\\nAs an illustration of the insights that deconvolution methods can provide in the analysis of\\nresting-state data,  depicts the average activity-inducing and innovation maps of\\ncommon resting-state networks obtained from thresholding and averaging the activity-inducing and\\ninnovation signals, respectively, estimated from the resting-state multiband data using PFM with a\\nselection of $\\\\lambda$ based on the BIC. The average activity-inducing maps obtained via\\ndeconvolution show spatial patterns of the default mode network (DMN), dorsal attention network\\n(DAN), and visual network (VIS) that highly resemble the maps obtained with conventional seed\\ncorrelation analysis using Pearson's correlation, and the average maps of extreme points of the\\nsignal (i.e., with no deconvolution). With deconvolution, the average activity-inducing maps seem\\nto depict more accurate spatial delineation (i.e., less smoothness) than those obtained from the\\noriginal data, while maintaining the structure of the networks. The BIC-informed selection of\\n$\\\\lambda$ yields spatial patterns of average activity-inducing and innovation maps that are more\\nsparse than those obtained with a selection of $\\\\lambda$ based on the MAD estimate (see\\nFigure S%s). Furthermore, the spatial patterns of the average innovation maps based on the\\ninnovation signals using the block model yield complementary information to those obtained with the\\nactivity-inducing signal since iCAPs allow to reveal regions with synchronous innovations, i.e.,\\nwith the same upregulating and downregulating events. For instance, it is interesting to observe\\nthat the structure of the visual network nearly disappears in its corresponding average innovation\\nmaps, suggesting the existence of different temporal neuronal patterns across voxels in the primary\\nand secondary visual cortices. ```{figure} figures/synthesis_analysis/caps.png\\n:align: center\\n:label: fig-caps\\n\\nAverage activity-inducing (left) and innovation (right) maps\\nobtained from PFM-estimated activity-inducing and innovation signals,\\nrespectively, using a BIC-based selection of $\\\\lambda$. Time-points selected\\nwith a 95\\\\textsuperscript{th} percentile threshold (horizontal lines) are\\nshown over the average time-series (blue) in the seed region (white cross)\\nand the deconvolved signals, i.e., activity inducing (left) and innovation\\n(right) signals (orange). Average maps of extreme points and seed\\ncorrelation maps are illustrated in the center. ```\\n\\n% Discussion (sec:synthesis_discussion)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"c0ae7a0e-4ef4-40f8-ab26-fa7da4f6ddb8":{"__data__":"{\"id_\":\"c0ae7a0e-4ef4-40f8-ab26-fa7da4f6ddb8\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"be581b29-c110-4831-9b5c-42dd0f234543\",\"metadata\":{},\"hash\":\"DOodO1OBb0A3hpABrYh1PnqEndAgElIC7ILgXpu93Ko=\"},\"NEXT\":{\"nodeId\":\"4b514e50-6417-4837-89b8-72e05f0869d0\",\"metadata\":{},\"hash\":\"U/S24XDX+qj8K5KE051htSCbqhSoyt2fyIvuoajLJfI=\"}},\"hash\":\"oRkZCPtEN/h3SZCz1j6JqDpPERuFcRf+crn3Z05V9cw=\",\"text\":\"## Discussion and Conclusion\\n\\nHemodynamic deconvolution can be formulated using a synthesis- and analysis-based approach as\\nproposed by PFM and TA, respectively. This work demonstrates that the theoretical equivalence of\\nboth approaches is confirmed in practice given virtually identical results when the same HRF model\\nand equivalent regularization parameters are employed. Hence, it can be argued that previously\\nobserved differences in performance can be explained by specific settings, such as the HRF model\\nand selection of the regularization parameter (as shown in , Figure S%s\\nand Figure S%s), convergence thresholds, as well as the addition of a spatial\\nregularization term in the spatiotemporal TA formulation [@Karahanoglu2013TotalactivationfMRI]. For\\ninstance, the use of PFM with the spike model in @Tan2017DecodingfMRIevents was seen not to be\\nadequate due to the prolonged trials in the paradigm, which better fit the block model as described\\nin Eq. %s. However, given the equivalence of the temporal deconvolution,\\nincorporating extra spatial or temporal regularization terms in the optimization problem should not\\nmodify this equivalence providing convex operators are employed. For a convex optimization problem,\\nwith a unique global solution, iterative shrinkage thresholding procedures alternating between the\\ndifferent regularization terms guarantee convergence, such as the generalized forward-backward\\nsplitting [@Raguet2013GeneralizedForwardBackward] algorithm originally employed for TA. Our findings are also in line with the equivalence of analysis and synthesis methods in\\nunder-determined cases ($N \\\\leq V$) demonstrated in [@Elad2007Analysisversussynthesis] and\\n[@Ortelli2019Synthesisanalysistotal]. Still, this chapter has shown that a slight difference in the\\nselection of the regularization parameter can lead to small differences in the estimated signals\\nwhen employing the block model with the BIC selection of $\\\\lambda$. However, since their\\nregularization paths are equivalent, the algorithms can easily be forced to converge to the same\\nselection of $\\\\lambda$, thus resulting in identical estimated signals. Nevertheless, the different formulations of analysis and synthesis deconvolution models bring along\\ndifferent kinds of flexibility. One notable advantage of PFM is that it can readily incorporate any\\nHRF as part of the synthesis operator [@Elad2007Analysisversussynthesis], only requiring the\\nsampled HRF at the desired temporal resolution, which is typically equal to the TR of the\\nacquisition. Conversely, TA relies upon the specification of the discrete differential operator\\nthat inverts the HRF, which needs to be derived either by the inverse solution of the sampled HRF\\nimpulse response, or by discretizing a continuous-domain differential operator motivated by a\\nbiophysical model. The more versatile structure of PFM allows for instance an elegant extension of\\nthe algorithm to multi-echo fMRI data [@CaballeroGaudes2019deconvolutionalgorithmmulti] where\\nmultiple measurements relate to a common underlying signal. Therefore, the one-to-many synthesis\\nscenario (i.e., from activity-inducing to several activity-related signals) is more cumbersome to\\nexpress using TA. In other words, a set of differential operators should be defined and the\\ndifferences between their outputs constrained. In contrast, the one-to-many analysis scenario\\n(i.e., from the measurements to several regularizing signals) is more convenient to be expressed by\\nTA, for example combining spike and block regularizers. While the specification of the differential\\noperator in TA only indirectly controls the HRF, the use of the derivative operator to enforce the\\nblock model, instead of the integrator in PFM, impacts positively the stability and rate of the\\nconvergence of the optimization algorithms. Moreover, analysis formulations can be more suitable\\nfor online applications that are still to be explored in fMRI data, but are employed for calcium\\nimaging deconvolution\\n[@Friedrich2017Fastonlinedeconvolution;@Jewell2019Fastnonconvexdeconvolution], and which have been\\napplied for offline calcium deconvolution [@Farouj2020DeconvolutionSustainedNeural]. Moreover, deconvolution techniques can be used before more downstream analysis of brain activity in\\nterms of functional network organization as they estimate interactions between voxels or brain\\nregions that occur at the activity-inducing level, and are thus less affected by the slowness of\\nthe hemodynamic response compared to when the BOLD signals are analyzed directly. In particular,\\nhemodynamic deconvolution approaches hold a close parallelism to recent methodologies aiming to\\nunderstand the dynamics of neuronal activations and interactions at short temporal resolution and\\nthat focus on extreme events of the fMRI signal.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"4b514e50-6417-4837-89b8-72e05f0869d0":{"__data__":"{\"id_\":\"4b514e50-6417-4837-89b8-72e05f0869d0\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"be581b29-c110-4831-9b5c-42dd0f234543\",\"metadata\":{},\"hash\":\"DOodO1OBb0A3hpABrYh1PnqEndAgElIC7ILgXpu93Ko=\"},\"PREVIOUS\":{\"nodeId\":\"c0ae7a0e-4ef4-40f8-ab26-fa7da4f6ddb8\",\"metadata\":{},\"hash\":\"oRkZCPtEN/h3SZCz1j6JqDpPERuFcRf+crn3Z05V9cw=\"},\"NEXT\":{\"nodeId\":\"22ff41d4-5f3d-4898-b508-45db38f07d10\",\"metadata\":{},\"hash\":\"dMKvIBF/uzjzoukkcszQb7OetH+2DzOM3imgjq7kUvw=\"}},\"hash\":\"U/S24XDX+qj8K5KE051htSCbqhSoyt2fyIvuoajLJfI=\",\"text\":\"As an illustration,  shows that the\\ninnovation- or activity-inducing CAPs computed from deconvolved events in a single resting-state\\nfMRI dataset closely resemble the conventional CAPs computed directly from extreme events of the\\nfMRI signal\\n[@Liu2013Timevaryingfunctional;@Liu2013Decompositionspontaneousbrain;@Liu2018Coactivationpatterns;@Cifre2020Revisitingnonlinear;@Cifre2020Furtherresultswhy;@Zhang2020relationshipBOLDneural;@Tagliazucchi2011SpontaneousBOLDevent;@Tagliazucchi2012Criticalitylargescale;@Tagliazucchi2016VoxelWiseFunctional;@Rolls2021BraindynamicsSynchronous]. Similarly, it can be hypothesized that these extreme events will also show a close resemblance to\\nintrinsic ignition events\\n[@Deco2017HierarchyInformationProcessing;@Deco2017NovelIntrinsicIgnition]. As shown in the maps,\\ndeconvolution approaches can offer a more straightforward interpretability of the activation events\\nand resulting functional connectivity patterns. Here, CAPs were computed as the average of spatial\\nmaps corresponding to the events of a single dataset. Beyond simple averaging, clustering\\nalgorithms (e.g., K-means and consensus clustering) can be employed to discern multiple CAPs or\\niCAPs at the whole-brain level for a large number of subjects. Previous findings based on iCAPs\\nhave for instance revealed organizational principles of brain function during rest\\n[@Karahanoglu2015Transientbrainactivity] and sleep [@Tarun2021NREMsleepstages] in healthy controls,\\nnext to alterations in 22q11ds [@Zoeller2019LargeScaleBrain] and multiple sclerosis\\n[@Bommarito2021Alteredanteriordefault]. Next to CAPs-inspired approaches, dynamic functional connectivity has recently been investigated\\nwith the use of co-fluctuations and edge-centric techniques\\n[@Faskowitz2020Edgecentricfunctional;@Esfahlani2020Highamplitudecofluctuations;@Jo2021Subjectidentificationusing;@Sporns2021Dynamicexpressionbrain;@Oort2018Functionalparcellationusing]. The activation time series shown in A aims to provide equivalent information to\\nthe root of sum of squares timecourses used in edge-centric approaches, where timecourses with\\npeaks delineate instances of significant brain activity. Future work could address which type of\\ninformation is redundant or distinct across these frameworks. These examples illustrate that\\ndeconvolution techniques can be employed prior to other computational approaches and could serve as\\nan effective way of denoising the fMRI data. Hence, an increase in the number of studies that take\\nadvantage of the potential benefits of using deconvolution methods prior to functional connectivity\\nanalyses can be expected. Even though the two approaches examined here provide alternative representations of the BOLD\\nsignals in terms of innovation and activity-inducing signals, their current implementations have\\ncertain limitations and call for further developments or more elaborate models, where some of them\\nhave been partially addressed in the literature. One relevant focus is to account for the\\nvariability in HRF that can be observed in different regions of the brain. First, variability in\\nthe temporal characteristics of the HRF can arise from differences in stimulus intensity and\\npatterns, as well as with short inter-event intervals like in fast cognitive processes or\\nexperimental designs\\n[@Yesilyurt2008DynamicsnonlinearitiesBOLD;@Sadaghiani2009Neuralactivityinduced;@Chen2021Investigatingmechanismsfast;@Polimeni2021Imagingfasterneural]. Similarly, the HRF shape at rest might differ from the canonical HRF commonly used for task-based\\nfMRI data analysis. A wide variety of HRF patterns could be elicited across the whole brain and\\npossible detected with sufficiently large signal-to-noise ratio. For instance,\\n@GonzalezCastillo2012Wholebraintime showed two gamma-shaped responses at the onset and the end of\\nthe evoked trial, respectively. This unique HRF shape would be deconvolved as two separate events\\nwith the conventional deconvolution techniques. The impact of HRF variability could be reduced\\nusing structured regularization terms along with multiple basis functions\\n[@Gaudes2012Structuredsparsedeconvolution] or procedures that estimate the HRF shape in an adaptive\\nfashion in both analysis [@Farouj2019BoldSignalDeconvolution] and synthesis formulations\\n[@Cherkaoui2021Multivariatesemiblind].\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"22ff41d4-5f3d-4898-b508-45db38f07d10":{"__data__":"{\"id_\":\"22ff41d4-5f3d-4898-b508-45db38f07d10\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"be581b29-c110-4831-9b5c-42dd0f234543\",\"metadata\":{},\"hash\":\"DOodO1OBb0A3hpABrYh1PnqEndAgElIC7ILgXpu93Ko=\"},\"PREVIOUS\":{\"nodeId\":\"4b514e50-6417-4837-89b8-72e05f0869d0\",\"metadata\":{},\"hash\":\"U/S24XDX+qj8K5KE051htSCbqhSoyt2fyIvuoajLJfI=\"}},\"hash\":\"dMKvIBF/uzjzoukkcszQb7OetH+2DzOM3imgjq7kUvw=\",\"text\":\"Another avenue of research consists in leveraging spatial information by adopting multivariate\\ndeconvolution approaches that operate at the whole-brain level, instead of working voxelwise and\\nbeyond regional regularization terms (e.g., as proposed in @Karahanoglu2013TotalactivationfMRI). Operating at the whole-brain level would open the way for methods that consider shared neuronal\\nactivity using mixed norm regularization terms [@UrunuelaTremino2019Deconvolutionmultiecho], as\\ndescribed in , or can capture long-range neuronal cofluctuations using low\\nrank decompositions [@Cherkaoui2021Multivariatesemiblind]. For example, multivariate deconvolution\\napproaches could yield better localized activity patterns while reducing the effect of global\\nfluctuations such as respiratory artifacts, which cannot be modelled at the voxel level with a\\nmultivariate sparse and low-rank model [@Urunuela2021LowRankSparse], as described in\\n. Similar to solving other inverse problems by means of regularized estimators, the selection of the\\nregularization parameter is critical to correctly estimate the neuronal-related signal. Hence,\\nmethods that take advantage of a more robust selection of the regularization parameter could\\nconsiderably yield more reliable estimates of the neuronal-related signal. For instance, the\\nstability selection procedure [@Meinshausen2010Stabilityselection;Urunuela2020StabilityBasedSparse]\\ncould be included to the deconvolution problem to ensure that the estimated coefficients are\\nobtained with high probability. This approach is described in \\n[@Urunuela2020StabilityBasedSparse]. Furthermore, an important issue of regularized estimation is\\nthat the estimates are biased with respect to the true value. In that sense, the use of non-convex\\n$\\\\ell_{p,q}$-norm regularization terms (e.g., $p < 1$) can reduce this bias while maintaining the\\nsparsity constraint, at the cost of potentially converging to a local minima of the regularized\\nestimation problem. In practice, these approaches could avoid the optional debiasing step that\\novercomes the shrinkage of the estimates and obtain a more accurate and less biased fit of the fMRI\\nsignal [@Gaudes2013Paradigmfreemapping;@CaballeroGaudes2019deconvolutionalgorithmmulti]. Finally,\\ncutting-edge developments on physics-informed deep learning techniques for inverse problems\\n[@Akcakaya2021UnsupervisedDeepLearning;@Monga2021AlgorithmUnrollingInterpretable;@Ongie2020DeepLearningTechniques;@Cherkaoui2020LearningsolveTV]\\ncould be transferred for deconvolution by considering the biophysical model of the hemodynamic\\nsystem and could potentially offer algorithms with reduced computational time and more flexibility. (sec-synthesis-github)=\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"},"e9be23f2-a214-4241-9bd5-4c74f29a0f5c":{"__data__":"{\"id_\":\"e9be23f2-a214-4241-9bd5-4c74f29a0f5c\",\"metadata\":{},\"excludedEmbedMetadataKeys\":[],\"excludedLlmMetadataKeys\":[],\"relationships\":{\"SOURCE\":{\"nodeId\":\"1e9286a9-7c2a-4055-bf4e-8e9ac541d688\",\"metadata\":{},\"hash\":\"c18PQu2OSvlKIKIR2BwMCa75e1ycNaZHE+lqfECwTbo=\"}},\"hash\":\"5V3m5CjRCsV8MCFVp6XzDk2ND/Jqwi29weeyG+WeK1U=\",\"text\":\"## Code and data availability\\n\\nThe code and materials used in this work can be found in the following GitHub repository:\\nhttps://github.com/eurunuela/pfm_vs_ta. The reader can\\nexplore different simulation parameters (e.g., SNR, varying HRF options and mismatch between\\nalgorithms, TR, number of events, onsets, and durations) in the provided Jupyter notebooks. Similarly, the experimental data can be found in https://osf.io/f3ryg. [^hemodynamic]: Note that the term deconvolution is also alternatively employed to refer to the\\nestimation of the hemodynamic response shape assuming a known activity-inducing signal or neuronal\\nactivity\\n[@Goutte2000Modelinghaemodynamicresponse;@Marrelec2002Bayesianestimationhemodynamic;@Ciuciu2003Unsupervisedrobustnonparametric;@Casanova2008impacttemporalregularization]. ^3dPFM]: [https://afni.nimh.nih.gov/pub/dist/doc/program_help/3dPFM.html\\n\\n^3dMEPFM]: [https://afni.nimh.nih.gov/pub/dist/doc/program_help/3dMEPFM.html\\n\\n^iCAPs]: [https://c4science.ch/source/iCAPs/\\n\\n[^total_variation]: Without dwelling into technicalities, for total variation, this equivalence is\\ncorrect up to the constant, which is in the null space of the derivative operator. [^null_space]: Again, this holds up to elements of the null space.\",\"textTemplate\":\"\",\"metadataSeparator\":\"\\n\",\"type\":\"TEXT\"}","__type__":"TEXT"}},"docstore/ref_doc_info":{"40ed0b67-25fe-4163-ab0c-05b41290e466":{"nodeIds":["10c7ed22-30f5-4bf8-b137-22d47f1bd522"],"extraInfo":{}},"48c11a2a-3cd6-4024-b2a4-253c85154968":{"nodeIds":["d2d7a1e7-0d9f-4626-b099-b9dfd88ffef0"],"extraInfo":{}},"4a091ebe-148b-498e-985f-24d2e6d73bc0":{"nodeIds":["bb744f3b-86cc-4db3-81b4-94c056888110"],"extraInfo":{}},"4d4e3213-6009-4095-9499-73a7f6facb89":{"nodeIds":["527dae8f-f49e-4687-bcf2-008c2109e23b"],"extraInfo":{}},"3ad4a0a9-3855-43ee-af96-f79391cde4fd":{"nodeIds":["26f5f0d2-d6fb-43f6-8161-77dfc0400603"],"extraInfo":{}},"80eb6b53-ab37-429f-9d85-1d8aacc97c93":{"nodeIds":["85876020-5a7a-4912-9d1b-53fefa86ab1f"],"extraInfo":{}},"fce81d81-f077-4305-a010-1ef0a84d98d7":{"nodeIds":["d25ab7d0-c88d-4add-bda9-089f883056bb"],"extraInfo":{}},"45457b95-6135-4f8e-8ba9-e617f4125488":{"nodeIds":["7fb5f9a8-c7f4-4e4d-8119-c5283dbabfec"],"extraInfo":{}},"8220089e-1607-443c-b6b0-269527161c38":{"nodeIds":["6a050ab1-9783-4fdb-b081-f3e2b28da60e"],"extraInfo":{}},"58163131-12e6-44ea-bc97-e67a6315c8b2":{"nodeIds":["259ca24d-c199-4e97-b721-3d535ed41052","848b085d-2053-4009-ba2f-bbf3fbfd68d1"],"extraInfo":{}},"8c95bfcb-1805-4a7b-96dc-a4cb018444af":{"nodeIds":["2c1b9875-321c-4bb5-b913-187ed16db6b5","8891b0ec-5e68-4c97-86e6-f3725ac14f46"],"extraInfo":{}},"eaaba3a1-137a-4b33-a1ed-1c41e982caaa":{"nodeIds":["d911f7c4-f10e-4215-991d-462f50e069b6"],"extraInfo":{}},"f9ef9a39-81ab-4227-9cc4-1c6c3020bfa8":{"nodeIds":["7b489c1d-f344-41ef-93f7-45d2b53d95c8"],"extraInfo":{}},"00546dc8-1249-499f-b566-89d8623c2656":{"nodeIds":["79a7dec8-106d-4638-ab18-d1e28015b5c2"],"extraInfo":{}},"78b834e4-5028-442d-ad2d-cf943ea5b03e":{"nodeIds":["c6d0dbc2-4289-4102-a470-f4dc1a3cf62d"],"extraInfo":{}},"fc6da928-c2ee-4804-877e-7d2318aabe6e":{"nodeIds":["a557883d-2dcc-4057-b718-70d251aed68e","a404d862-2a81-4900-bef8-49e8b0119d9d"],"extraInfo":{}},"88878f1c-c20d-45ad-9616-fd477154020d":{"nodeIds":["10c07d2f-89d2-4bf5-b56b-e8d22130aafc"],"extraInfo":{}},"11517fea-0ea1-488a-930c-07cb26d2d9f3":{"nodeIds":["b1d18526-be1f-4ec2-9bea-29eb1b9c3f1f","b4a30af8-8668-40a6-9b86-6b3c8fc425a7","60a5fd28-aa6b-4402-81d2-a6edcd79ef82"],"extraInfo":{}},"6456cac7-d020-4530-8668-55199c1f3302":{"nodeIds":["e6b2391a-61e4-4635-9d23-7f10f088efcf","e516b64b-199c-48df-80f8-76cfb0171260"],"extraInfo":{}},"9150c11d-0d60-4b76-8984-34a4cc87c677":{"nodeIds":["76c2ed76-a445-40aa-a230-8128e0b8ff96"],"extraInfo":{}},"a0c3661f-9ce5-4b9f-a512-2b961bd865eb":{"nodeIds":["66e5e9bc-0bad-40a4-8fc6-08288a308178"],"extraInfo":{}},"ce912796-13ae-44a4-94de-699e3bea3feb":{"nodeIds":["9253dc89-38a7-493a-9461-10cb50a43451","297c9920-6931-47bd-aafa-bce3f494b7d3","339b20d8-240c-4cd4-94e9-1e08b1f4d682","9e3d0a52-d6d8-4e01-90ea-d9dc7e3b677e"],"extraInfo":{}},"172ff61a-d812-4186-9d3b-9dab07312847":{"nodeIds":["6259768d-82b4-4965-aa7c-0b4f4419ed8f"],"extraInfo":{}},"a1e58057-2f9d-4916-8ae1-a290d7d73ca1":{"nodeIds":["86f8346d-a1e3-4abb-beb0-107082bad295"],"extraInfo":{}},"609657b3-39a5-460c-909b-82477537a95a":{"nodeIds":["5e60d95f-077f-45bf-8e5f-491db98529ee"],"extraInfo":{}},"3acb696b-79bb-46ea-b79a-9da78911a0a7":{"nodeIds":["6d73770a-507d-477c-a697-519a25302981","fa5f0894-8749-48c9-8720-f31b084ac597"],"extraInfo":{}},"d74ca71f-f0ac-41b2-850b-20766e5c7e73":{"nodeIds":["d88fcd2e-4532-4bb7-a9d5-9e1da3f3f4a6"],"extraInfo":{}},"65241135-4f0e-4548-8196-eba27c46a6b2":{"nodeIds":["8fe76eea-6b37-4b5f-84b2-cc06479ef076"],"extraInfo":{}},"bedb7d68-e124-4d58-ba20-4ecb33ae802e":{"nodeIds":["fb01430d-83f7-4cdc-9540-5ef54d8e64d5"],"extraInfo":{}},"6b581184-1c16-406c-8fab-e57806bae0de":{"nodeIds":["55592220-4c75-4c08-98a9-4dae1d327ce9"],"extraInfo":{}},"a379b718-8880-4830-ac71-199281fa17fb":{"nodeIds":["0d28db77-596c-4f87-a5d3-d37b03e9151b"],"extraInfo":{}},"ce132559-9550-4216-b03f-07591d2eb311":{"nodeIds":["c5f9aefb-71c2-40a4-858c-6569f523ad35"],"extraInfo":{}},"1ac47aff-ad6b-4a9d-810d-12eebcb92784":{"nodeIds":["1763de92-30a2-4167-8c6a-54404f1eaedc"],"extraInfo":{}},"493e33a8-94ac-44fc-b6ed-1b318fdb1149":{"nodeIds":["978fe010-876e-4615-9610-aad5d7e8b9cb"],"extraInfo":{}},"761f67a7-f823-43fa-8c21-394b29c3adaf":{"nodeIds":["6f16c335-6eb6-42f5-bac1-bdf7dd0eda00","d40f9e41-973c-4641-89cc-e2125d2c4193"],"extraInfo":{}},"32d8be53-cb3a-4577-8d06-962088eabaec":{"nodeIds":["af18cf1b-643e-4692-a77b-07fee22cad09"],"extraInfo":{}},"854dee56-8823-4290-9045-07c606d50d60":{"nodeIds":["1489c0f2-358b-485f-ad71-e3909af6231b","c71b7335-ca64-4968-bc93-aea1b1364ad9"],"extraInfo":{}},"b9c588f3-4f07-4603-aad2-b90963ffd8f9":{"nodeIds":["cd52993c-2cb5-455f-b8ea-ca0547df580f"],"extraInfo":{}},"1c8353c4-295a-47bf-ad1b-edec66ae48e3":{"nodeIds":["2b51d23b-253a-46d3-9318-1abd813c30a5","f2b0fe1f-0ab2-4ef6-a853-9d2182bab392"],"extraInfo":{}},"af4b9470-0392-4d93-8b8d-3b7cc96f4a1a":{"nodeIds":["d0f7870f-90fa-4c8f-83fa-74ba2fb04333"],"extraInfo":{}},"cbd8f608-891e-4328-8965-55ab0ce50082":{"nodeIds":["a23f1bb6-aa0d-4101-8e35-985f6cd54af0"],"extraInfo":{}},"0a1ce044-7590-45d8-95d9-aa2229ef4348":{"nodeIds":["35c4eaad-e8fb-4242-a96f-2ec2b1faffb2"],"extraInfo":{}},"a5d127c1-a9ed-4030-9c9a-42639f5473e2":{"nodeIds":["33b56345-89b5-40ba-8099-8c8bbee87565"],"extraInfo":{}},"30aafcee-e279-4452-8e95-a194a034f230":{"nodeIds":["d2e6fc6d-3528-48ca-ae36-de4888be8c35","e3b1c099-ccfb-4e33-a3be-a8dc2f687fa4"],"extraInfo":{}},"80aa3952-d000-4091-b8f9-a75b716c9313":{"nodeIds":["b4346177-7e28-4258-bbf4-e5cf5cbcfc0e"],"extraInfo":{}},"aae33b37-e476-4ad4-accf-6093dc28f5a8":{"nodeIds":["1aa643f1-9534-4f0f-9d1e-c9b98d58759c"],"extraInfo":{}},"825f45c1-0a73-43a7-bc29-be2c02c265ff":{"nodeIds":["ef7b5041-4987-485b-b020-9fdd888135f6"],"extraInfo":{}},"9dbf95de-1c54-4eaa-92a3-09a295a26eef":{"nodeIds":["987a4b27-83b4-4081-8e7f-cee338338530"],"extraInfo":{}},"d53c6fc9-e958-4173-88f5-81034b658154":{"nodeIds":["0be053d7-647b-4647-851b-41911b4bd5eb"],"extraInfo":{}},"abfe51f8-0ba7-491c-afb7-931e54311ce9":{"nodeIds":["b7aae4bd-67bc-4126-8e52-b219f9713b9a"],"extraInfo":{}},"e734a186-9266-4ad4-95a4-fcf369aa7cd1":{"nodeIds":["5c866b32-24d8-49d1-8f0a-2b08cf7b46fc"],"extraInfo":{}},"67ac050e-3c1b-474a-ade2-3fd9b6d14beb":{"nodeIds":["b03c03aa-6bef-463a-895b-1de05fe938e5"],"extraInfo":{}},"9cdf290e-9390-4255-a0a4-c16b22b1544b":{"nodeIds":["d55d596e-d7ee-47f1-8ac9-d7ea07b441ab"],"extraInfo":{}},"68b21055-1e08-49cd-a3fe-d83908b8de55":{"nodeIds":["e4734498-b7d7-4d03-a3a5-886d448a7bdd","a16b0ab5-16bc-4a6a-8a4e-959dcb8f4c33"],"extraInfo":{}},"ed0c81f8-7407-4511-9e8c-816f3aa141a1":{"nodeIds":["f100b6c7-e228-4b94-87c7-75401fda1da3","595b862f-40cf-476e-8d4e-6685bbedc28a"],"extraInfo":{}},"d694b5b3-b872-47f3-8d98-ae0af440a12e":{"nodeIds":["0cee4698-d90d-4880-896f-2354846c34c2"],"extraInfo":{}},"ba4a2f7f-a52c-4add-923c-9ab1ad613223":{"nodeIds":["831c960a-f494-4d1b-8bb0-ce976a3e5707"],"extraInfo":{}},"c782893e-78de-4a88-837b-55dff5d9bb5d":{"nodeIds":["32e2bd1e-1101-4660-9bb8-44c04cd54c0d"],"extraInfo":{}},"79e4ce61-65d2-4972-84fc-dc3c7fc52098":{"nodeIds":["b7816421-55a9-41ec-83e6-542dd4267a8b"],"extraInfo":{}},"e9648ef8-bad2-4433-a267-81248878b5f0":{"nodeIds":["8f073552-7405-42af-8c55-ee15c6b7df3e","5eb85e29-31a3-413b-b473-0bb2b9c1f38b"],"extraInfo":{}},"f6d5fbe5-240a-4f86-a2eb-bcf3505b4141":{"nodeIds":["fd7d0c7d-0312-484e-ad99-2eb8a4a062b2","4698fcf2-0439-43a2-bedb-c6a16605f613"],"extraInfo":{}},"e7951e12-0ba0-45db-9bae-b1d24dd657d8":{"nodeIds":["a4d77385-a1e8-4eee-91f8-cbf5b52182ad"],"extraInfo":{}},"b0f10ec1-a0f9-446d-b37d-c23ca090023f":{"nodeIds":["990fc85c-c433-4d66-b836-9768a580afe5"],"extraInfo":{}},"d3314be8-9071-4d3d-9790-8056c9f6153b":{"nodeIds":["12b261eb-72fd-4a12-a7dc-569a8c4914e3","a7718991-2b84-48cc-ae13-53637b9e560e"],"extraInfo":{}},"c34b7369-b1a5-4522-b1e5-ec923a9a15d1":{"nodeIds":["67c3f24e-e9cb-4c27-bc0f-cb9196234308"],"extraInfo":{}},"ff6b3cbe-3a9c-4b8f-ad55-6b602d7f5ca5":{"nodeIds":["bbe3846e-9bdd-40c0-aed1-5b4099b5ca73"],"extraInfo":{}},"056fbeae-0b50-4e2c-963b-f1113c2162b4":{"nodeIds":["3cbcf0fc-2dd1-4f0e-b9a3-7e99a4ee774d"],"extraInfo":{}},"9c0127d3-de93-4837-9237-bcdd4df71912":{"nodeIds":["1f8e91ca-f934-4c30-8e4e-78b6db485f8a","84cdcbc8-23c0-4b20-891a-96060fe56b2c","69f390a1-0de1-4fe9-aabe-4290a2c86c6b","2a47a8cc-a22f-4bd9-8406-46f3b5d33c65","8f27a129-737e-4d77-8f08-086acde73e6b","8a64e5aa-7cdb-4833-96f8-c656e5386747"],"extraInfo":{}},"58e19fb5-c662-45f8-82c3-b5b8a1080fca":{"nodeIds":["4e7e5b26-21dd-4870-940d-03f46bfd7f1c","38f54452-39bb-471e-b62a-2e4e16dd1e1b"],"extraInfo":{}},"237e2c81-d9e3-4d82-a415-a925a3130cd5":{"nodeIds":["e2fffa70-813d-4951-a43a-8bb5540a0514"],"extraInfo":{}},"f75748c9-ed3a-415e-a2ea-c4776cafc6e1":{"nodeIds":["4d6f32c2-be80-4abf-861c-0b0249caa2f0"],"extraInfo":{}},"717d48c3-17dc-452e-92c4-ad9a4a5f4ca5":{"nodeIds":["b33c3f6e-45d9-4a50-b41e-7fd795073e0d"],"extraInfo":{}},"2bd3581e-f791-4d91-a713-f494cb2481b3":{"nodeIds":["0207982b-2fad-477b-a1c0-486b3d42303b"],"extraInfo":{}},"4508de05-dfb5-4242-8801-0b8069d8fb89":{"nodeIds":["72b16eca-6207-479c-80aa-c8f4ff91166a"],"extraInfo":{}},"7dc135f1-4be1-447f-89d0-6c0ec9a6da79":{"nodeIds":["f817d16e-eb2e-4767-be63-850963e81eea"],"extraInfo":{}},"44f80043-3701-4f1e-90c6-48972ba77ab3":{"nodeIds":["48374e1f-e5b8-4591-85c2-11b85ce3689b"],"extraInfo":{}},"afa821b1-1afe-4d78-b934-1a997d0c5f0d":{"nodeIds":["0b2e3d13-9f45-46a8-9e11-d3d1643ffb97","d4646e08-c99c-4036-8c33-ce327b52104a"],"extraInfo":{}},"4a72806f-ba1b-4781-8061-63099840abac":{"nodeIds":["8a4ec560-1915-40a4-b1bf-3e7eea743739","05f8a896-0111-4f97-b210-d932112bce46"],"extraInfo":{}},"52a5268f-f97e-47f2-9dfe-e066e5e968de":{"nodeIds":["7a4e5ebf-ebc8-41f5-ba25-d45becc4e6ee"],"extraInfo":{}},"fdaf7f9d-f8ac-4a88-9e68-e5a01581c371":{"nodeIds":["04c7287a-0ead-4f59-918d-190064482777","b846ee94-2c29-4416-921c-d603e7c79c8c"],"extraInfo":{}},"dcd87579-1e63-4eed-9010-7e505f44ec5d":{"nodeIds":["47ba07f4-659f-4441-8479-4452e0b7d259"],"extraInfo":{}},"3b303dfd-82db-4de5-8baa-5144a18ae7b7":{"nodeIds":["c0b3134f-46f0-472c-b56a-a15559132b15"],"extraInfo":{}},"de01d306-f9af-40a1-b099-d58106c559a6":{"nodeIds":["587e581a-3f38-4640-9f06-493a8d8bc2e9","a04a9c68-9c4a-44aa-b469-c6214883f7ec"],"extraInfo":{}},"21ae3777-92ef-4f21-9baf-233040386b72":{"nodeIds":["8ccaaee2-9402-4125-bce6-12b7c8abcf6d"],"extraInfo":{}},"ccdf9472-a393-49b2-b512-47b9e9150147":{"nodeIds":["b8b1ed7c-72b1-4d98-8021-740f80668bb4"],"extraInfo":{}},"642f306a-ef53-4442-8cc1-568b44d8fb5c":{"nodeIds":["37a6034a-3024-4810-b3b8-37bd9a7e75e9"],"extraInfo":{}},"524017f9-34f9-49f7-acd9-f3d12c662ab7":{"nodeIds":["738fd1b1-630c-4615-91fd-a92cee423c49"],"extraInfo":{}},"bb3d8e14-26c4-4a6e-bd39-5b33f2e48550":{"nodeIds":["cb87f621-d13d-414c-bafc-db4f6e74139b"],"extraInfo":{}},"f03bce9e-eb76-4fb6-b489-6abc03f4e25f":{"nodeIds":["13b7c01f-cd7e-4604-917f-3b6b774a33c5"],"extraInfo":{}},"bb8ac55f-7f0e-4b81-9902-49365a2cae2b":{"nodeIds":["46a39dea-e41d-4b19-ae03-c17be57a918a","7e531466-1f3a-4d35-98f8-18f7ff6a4bf0"],"extraInfo":{}},"704ef6a6-07b6-47a5-9eef-4d6858d809ec":{"nodeIds":["8f2895c7-92e8-46a3-ba09-402f6c038bc6"],"extraInfo":{}},"0e40f47b-4360-479d-83a4-bedf0541ff93":{"nodeIds":["5d63c4cc-b635-4955-b871-5e7d01c54b52"],"extraInfo":{}},"d52c5fcb-9a81-4883-9db2-45012509393f":{"nodeIds":["cd953628-34a1-4cc3-a5ac-ae0e04b94ac6"],"extraInfo":{}},"9190086e-6658-4701-a671-1c824a661f31":{"nodeIds":["54656135-4f51-40be-9bd4-d11b52e62454"],"extraInfo":{}},"21f28f95-f326-4f5d-92cc-a48f7bd0dfeb":{"nodeIds":["181b7a70-9fd7-48eb-af8f-b367d66d1de7"],"extraInfo":{}},"5fa4039f-fd43-4ee3-a413-d53475b24a1f":{"nodeIds":["452ed6ac-55b7-4dd5-97bd-9082ac2ff97f","e3f223d9-d4bf-409d-aee5-67e5c5200449"],"extraInfo":{}},"be581b29-c110-4831-9b5c-42dd0f234543":{"nodeIds":["c0ae7a0e-4ef4-40f8-ab26-fa7da4f6ddb8","4b514e50-6417-4837-89b8-72e05f0869d0","22ff41d4-5f3d-4898-b508-45db38f07d10"],"extraInfo":{}},"1e9286a9-7c2a-4055-bf4e-8e9ac541d688":{"nodeIds":["e9be23f2-a214-4241-9bd5-4c74f29a0f5c"],"extraInfo":{}}}}